nohup: ignoring input
╔════════════════════════════════════════════════════════════════════════╗
║          Pocket-Ligand Embedding Analysis Pipeline                    ║
╚════════════════════════════════════════════════════════════════════════╝

Configuration:
  Checkpoint:         models/checkpoints_mse_1536_6_dropout_0.1/best_model.pt
  Graph Directory:    data/processed/graphs
  Ligand Embeddings:  data/processed/ligand_embeddings_dedup.h5
  Output Directory:   results/embedding_analysis
  Reduction Methods:  pca tsne
  Splits:             Using all available data

Validating inputs...
✓ Found 1351 pocket graph files
✓ Found 291 unique ligands in embeddings
✓ All inputs validated

═══════════════════════════════════════════════════════════════════════
Step 1: Running Main Visualization Analysis
═══════════════════════════════════════════════════════════════════════


======================================================================
Pocket-Ligand Embedding Visualization Pipeline
======================================================================

Checkpoint: models/checkpoints_mse_1536_6_dropout_0.1/best_model.pt
Graph directory: data/processed/graphs
Ligand embeddings: data/processed/ligand_embeddings_dedup.h5
Output directory: results/embedding_analysis/visualizations
Methods: pca, tsne
Device: cuda

No split selection specified. Using all available data.


======================================================================
Step 1: Running Batch Inference on Pocket Graphs
======================================================================

Loading model from models/checkpoints_mse_1536_6_dropout_0.1/best_model.pt...
  Loading config from models/checkpoints_mse_1536_6_dropout_0.1/config.json...
Model loaded successfully (epoch 57, best val loss: unknown)
Found 1351 pocket graphs in data/processed/graphs
Processing pocket graphs:   0%|          | 0/1351 [00:00<?, ?it/s]Processing pocket graphs:   0%|          | 1/1351 [00:01<24:26,  1.09s/it]Processing pocket graphs:   0%|          | 2/1351 [00:02<31:40,  1.41s/it]Processing pocket graphs:   0%|          | 3/1351 [00:03<29:47,  1.33s/it]Processing pocket graphs:   0%|          | 4/1351 [00:05<30:49,  1.37s/it]Processing pocket graphs:   1%|          | 7/1351 [00:05<12:04,  1.86it/s]Processing pocket graphs:   1%|          | 10/1351 [00:05<06:46,  3.30it/s]Processing pocket graphs:   1%|          | 13/1351 [00:05<04:25,  5.03it/s]Processing pocket graphs:   1%|          | 16/1351 [00:05<03:10,  7.01it/s]Processing pocket graphs:   1%|▏         | 19/1351 [00:06<02:25,  9.18it/s]Processing pocket graphs:   2%|▏         | 22/1351 [00:06<01:59, 11.11it/s]Processing pocket graphs:   2%|▏         | 25/1351 [00:06<01:40, 13.22it/s]Processing pocket graphs:   2%|▏         | 28/1351 [00:06<01:27, 15.05it/s]Processing pocket graphs:   2%|▏         | 31/1351 [00:06<01:19, 16.65it/s]Processing pocket graphs:   3%|▎         | 34/1351 [00:06<01:17, 17.05it/s]Processing pocket graphs:   3%|▎         | 37/1351 [00:06<01:12, 18.12it/s]Processing pocket graphs:   3%|▎         | 40/1351 [00:07<01:08, 19.11it/s]Processing pocket graphs:   3%|▎         | 43/1351 [00:07<01:05, 19.88it/s]Processing pocket graphs:   3%|▎         | 46/1351 [00:07<01:04, 20.18it/s]Processing pocket graphs:   4%|▎         | 49/1351 [00:07<01:01, 21.14it/s]Processing pocket graphs:   4%|▍         | 52/1351 [00:07<00:58, 22.20it/s]Processing pocket graphs:   4%|▍         | 55/1351 [00:07<00:58, 22.20it/s]Processing pocket graphs:   4%|▍         | 58/1351 [00:07<00:57, 22.61it/s]Processing pocket graphs:   5%|▍         | 61/1351 [00:08<01:00, 21.15it/s]Processing pocket graphs:   5%|▍         | 64/1351 [00:08<00:58, 22.06it/s]Processing pocket graphs:   5%|▍         | 67/1351 [00:08<00:59, 21.45it/s]Processing pocket graphs:   5%|▌         | 70/1351 [00:08<00:57, 22.22it/s]Processing pocket graphs:   5%|▌         | 73/1351 [00:08<00:59, 21.39it/s]Processing pocket graphs:   6%|▌         | 76/1351 [00:08<01:03, 20.11it/s]Processing pocket graphs:   6%|▌         | 79/1351 [00:08<01:02, 20.46it/s]Processing pocket graphs:   6%|▌         | 82/1351 [00:08<00:58, 21.66it/s]Processing pocket graphs:   6%|▋         | 85/1351 [00:09<01:00, 21.06it/s]Processing pocket graphs:   7%|▋         | 88/1351 [00:09<00:59, 21.23it/s]Processing pocket graphs:   7%|▋         | 91/1351 [00:09<01:03, 19.89it/s]Processing pocket graphs:   7%|▋         | 94/1351 [00:09<01:05, 19.24it/s]Processing pocket graphs:   7%|▋         | 97/1351 [00:09<01:01, 20.41it/s]Processing pocket graphs:   7%|▋         | 100/1351 [00:09<01:02, 19.95it/s]Processing pocket graphs:   8%|▊         | 103/1351 [00:10<01:04, 19.44it/s]Processing pocket graphs:   8%|▊         | 106/1351 [00:10<01:03, 19.62it/s]Processing pocket graphs:   8%|▊         | 108/1351 [00:10<01:03, 19.59it/s]Processing pocket graphs:   8%|▊         | 110/1351 [00:10<01:03, 19.55it/s]Processing pocket graphs:   8%|▊         | 112/1351 [00:10<01:03, 19.40it/s]Processing pocket graphs:   8%|▊         | 114/1351 [00:10<01:05, 18.86it/s]Processing pocket graphs:   9%|▊         | 117/1351 [00:10<01:01, 20.05it/s]Processing pocket graphs:   9%|▉         | 119/1351 [00:10<01:12, 17.04it/s]Processing pocket graphs:   9%|▉         | 122/1351 [00:11<01:07, 18.16it/s]Processing pocket graphs:   9%|▉         | 124/1351 [00:11<01:08, 17.85it/s]Processing pocket graphs:   9%|▉         | 127/1351 [00:11<01:03, 19.31it/s]Processing pocket graphs:  10%|▉         | 130/1351 [00:11<00:58, 20.78it/s]Processing pocket graphs:  10%|▉         | 133/1351 [00:11<00:59, 20.32it/s]Processing pocket graphs:  10%|█         | 136/1351 [00:11<00:57, 21.30it/s]Processing pocket graphs:  10%|█         | 139/1351 [00:11<00:53, 22.55it/s]Processing pocket graphs:  11%|█         | 142/1351 [00:11<00:53, 22.42it/s]Processing pocket graphs:  11%|█         | 145/1351 [00:12<00:53, 22.75it/s]Processing pocket graphs:  11%|█         | 148/1351 [00:12<00:57, 20.95it/s]Processing pocket graphs:  11%|█         | 151/1351 [00:12<00:54, 22.08it/s]Processing pocket graphs:  11%|█▏        | 154/1351 [00:12<00:51, 23.02it/s]Processing pocket graphs:  12%|█▏        | 157/1351 [00:12<00:56, 21.07it/s]Processing pocket graphs:  12%|█▏        | 160/1351 [00:12<00:57, 20.85it/s]Processing pocket graphs:  12%|█▏        | 163/1351 [00:12<00:56, 20.88it/s]Processing pocket graphs:  12%|█▏        | 166/1351 [00:13<00:58, 20.34it/s]Processing pocket graphs:  13%|█▎        | 169/1351 [00:13<01:05, 18.11it/s]Processing pocket graphs:  13%|█▎        | 171/1351 [00:13<01:10, 16.72it/s]Processing pocket graphs:  13%|█▎        | 174/1351 [00:13<01:04, 18.31it/s]Processing pocket graphs:  13%|█▎        | 177/1351 [00:13<01:02, 18.90it/s]Processing pocket graphs:  13%|█▎        | 180/1351 [00:13<01:00, 19.36it/s]Processing pocket graphs:  14%|█▎        | 183/1351 [00:14<00:59, 19.48it/s]Processing pocket graphs:  14%|█▎        | 185/1351 [00:14<01:00, 19.15it/s]Processing pocket graphs:  14%|█▍        | 188/1351 [00:14<00:59, 19.67it/s]Processing pocket graphs:  14%|█▍        | 191/1351 [00:14<00:58, 19.90it/s]Processing pocket graphs:  14%|█▍        | 193/1351 [00:14<00:59, 19.60it/s]Processing pocket graphs:  15%|█▍        | 196/1351 [00:14<00:55, 20.96it/s]Processing pocket graphs:  15%|█▍        | 199/1351 [00:14<00:55, 20.62it/s]Processing pocket graphs:  15%|█▍        | 202/1351 [00:15<01:00, 18.88it/s]Processing pocket graphs:  15%|█▌        | 204/1351 [00:15<01:03, 17.92it/s]Processing pocket graphs:  15%|█▌        | 207/1351 [00:15<00:58, 19.50it/s]Processing pocket graphs:  16%|█▌        | 210/1351 [00:15<00:54, 20.85it/s]Processing pocket graphs:  16%|█▌        | 213/1351 [00:15<00:55, 20.48it/s]Processing pocket graphs:  16%|█▌        | 216/1351 [00:15<00:54, 20.69it/s]Processing pocket graphs:  16%|█▌        | 219/1351 [00:15<00:55, 20.52it/s]Processing pocket graphs:  16%|█▋        | 222/1351 [00:16<00:56, 20.16it/s]Processing pocket graphs:  17%|█▋        | 225/1351 [00:16<00:57, 19.51it/s]Processing pocket graphs:  17%|█▋        | 227/1351 [00:16<01:05, 17.27it/s]Processing pocket graphs:  17%|█▋        | 229/1351 [00:16<01:11, 15.62it/s]Processing pocket graphs:  17%|█▋        | 231/1351 [00:16<01:21, 13.78it/s]Processing pocket graphs:  17%|█▋        | 233/1351 [00:16<01:24, 13.22it/s]Processing pocket graphs:  17%|█▋        | 235/1351 [00:17<01:20, 13.86it/s]Processing pocket graphs:  18%|█▊        | 238/1351 [00:17<01:10, 15.71it/s]Processing pocket graphs:  18%|█▊        | 240/1351 [00:17<01:08, 16.11it/s]Processing pocket graphs:  18%|█▊        | 242/1351 [00:17<01:06, 16.60it/s]Processing pocket graphs:  18%|█▊        | 244/1351 [00:17<01:05, 16.94it/s]Processing pocket graphs:  18%|█▊        | 246/1351 [00:17<01:06, 16.72it/s]Processing pocket graphs:  18%|█▊        | 249/1351 [00:17<01:03, 17.25it/s]Processing pocket graphs:  19%|█▊        | 251/1351 [00:17<01:01, 17.87it/s]Processing pocket graphs:  19%|█▊        | 253/1351 [00:17<01:00, 18.18it/s]Processing pocket graphs:  19%|█▉        | 255/1351 [00:18<01:01, 17.91it/s]Processing pocket graphs:  19%|█▉        | 257/1351 [00:18<01:01, 17.75it/s]Processing pocket graphs:  19%|█▉        | 259/1351 [00:18<01:03, 17.17it/s]Processing pocket graphs:  19%|█▉        | 262/1351 [00:18<00:59, 18.29it/s]Processing pocket graphs:  20%|█▉        | 265/1351 [00:18<00:57, 18.89it/s]Processing pocket graphs:  20%|█▉        | 267/1351 [00:18<00:58, 18.45it/s]Processing pocket graphs:  20%|█▉        | 269/1351 [00:18<01:00, 17.87it/s]Processing pocket graphs:  20%|██        | 271/1351 [00:19<01:05, 16.38it/s]Processing pocket graphs:  20%|██        | 273/1351 [00:19<01:05, 16.40it/s]Processing pocket graphs:  20%|██        | 275/1351 [00:19<01:07, 15.85it/s]Processing pocket graphs:  21%|██        | 277/1351 [00:19<01:09, 15.54it/s]Processing pocket graphs:  21%|██        | 279/1351 [00:19<01:09, 15.50it/s]Processing pocket graphs:  21%|██        | 282/1351 [00:19<00:59, 17.92it/s]Processing pocket graphs:  21%|██        | 285/1351 [00:19<00:57, 18.39it/s]Processing pocket graphs:  21%|██        | 287/1351 [00:19<01:03, 16.85it/s]Processing pocket graphs:  21%|██▏       | 290/1351 [00:20<00:58, 18.16it/s]Processing pocket graphs:  22%|██▏       | 292/1351 [00:20<00:58, 18.21it/s]Processing pocket graphs:  22%|██▏       | 294/1351 [00:20<00:58, 18.00it/s]Processing pocket graphs:  22%|██▏       | 296/1351 [00:20<00:59, 17.65it/s]Processing pocket graphs:  22%|██▏       | 298/1351 [00:20<01:00, 17.32it/s]Processing pocket graphs:  22%|██▏       | 301/1351 [00:20<00:58, 18.00it/s]Processing pocket graphs:  22%|██▏       | 303/1351 [00:20<01:00, 17.46it/s]Processing pocket graphs:  23%|██▎       | 306/1351 [00:21<00:55, 18.90it/s]Processing pocket graphs:  23%|██▎       | 309/1351 [00:21<00:54, 19.26it/s]Processing pocket graphs:  23%|██▎       | 311/1351 [00:21<00:58, 17.67it/s]Processing pocket graphs:  23%|██▎       | 314/1351 [00:21<00:55, 18.66it/s]Processing pocket graphs:  23%|██▎       | 316/1351 [00:21<00:57, 17.88it/s]Processing pocket graphs:  24%|██▎       | 318/1351 [00:21<00:58, 17.60it/s]Processing pocket graphs:  24%|██▎       | 320/1351 [00:21<01:06, 15.61it/s]Processing pocket graphs:  24%|██▍       | 322/1351 [00:22<01:08, 14.92it/s]Processing pocket graphs:  24%|██▍       | 325/1351 [00:22<01:01, 16.75it/s]Processing pocket graphs:  24%|██▍       | 328/1351 [00:22<00:56, 18.00it/s]Processing pocket graphs:  24%|██▍       | 330/1351 [00:22<00:56, 18.21it/s]Processing pocket graphs:  25%|██▍       | 333/1351 [00:22<00:55, 18.47it/s]Processing pocket graphs:  25%|██▍       | 336/1351 [00:22<00:53, 18.84it/s]Processing pocket graphs:  25%|██▌       | 338/1351 [00:22<00:53, 18.95it/s]Processing pocket graphs:  25%|██▌       | 341/1351 [00:22<00:52, 19.07it/s]Processing pocket graphs:  25%|██▌       | 343/1351 [00:23<00:54, 18.39it/s]Processing pocket graphs:  26%|██▌       | 345/1351 [00:23<01:00, 16.55it/s]Processing pocket graphs:  26%|██▌       | 347/1351 [00:23<01:04, 15.61it/s]Processing pocket graphs:  26%|██▌       | 349/1351 [00:23<01:07, 14.78it/s]Processing pocket graphs:  26%|██▌       | 351/1351 [00:23<01:05, 15.35it/s]Processing pocket graphs:  26%|██▌       | 354/1351 [00:23<00:57, 17.42it/s]Processing pocket graphs:  26%|██▋       | 356/1351 [00:23<00:55, 18.02it/s]Processing pocket graphs:  27%|██▋       | 359/1351 [00:24<00:52, 18.92it/s]Processing pocket graphs:  27%|██▋       | 362/1351 [00:24<00:49, 19.82it/s]Processing pocket graphs:  27%|██▋       | 364/1351 [00:24<00:53, 18.37it/s]Processing pocket graphs:  27%|██▋       | 366/1351 [00:24<00:53, 18.43it/s]Processing pocket graphs:  27%|██▋       | 368/1351 [00:24<00:54, 18.16it/s]Processing pocket graphs:  27%|██▋       | 371/1351 [00:24<00:51, 18.96it/s]Processing pocket graphs:  28%|██▊       | 373/1351 [00:24<00:52, 18.60it/s]Processing pocket graphs:  28%|██▊       | 375/1351 [00:24<00:52, 18.62it/s]Processing pocket graphs:  28%|██▊       | 377/1351 [00:25<00:56, 17.32it/s]Processing pocket graphs:  28%|██▊       | 380/1351 [00:25<00:52, 18.46it/s]Processing pocket graphs:  28%|██▊       | 382/1351 [00:25<00:51, 18.74it/s]Processing pocket graphs:  28%|██▊       | 384/1351 [00:25<00:51, 18.92it/s]Processing pocket graphs:  29%|██▊       | 386/1351 [00:25<00:50, 19.01it/s]Processing pocket graphs:  29%|██▉       | 389/1351 [00:25<00:47, 20.39it/s]Processing pocket graphs:  29%|██▉       | 392/1351 [00:25<00:48, 19.64it/s]Processing pocket graphs:  29%|██▉       | 394/1351 [00:25<00:52, 18.07it/s]Processing pocket graphs:  29%|██▉       | 396/1351 [00:26<00:52, 18.29it/s]Processing pocket graphs:  30%|██▉       | 399/1351 [00:26<00:48, 19.66it/s]Processing pocket graphs:  30%|██▉       | 402/1351 [00:26<00:45, 20.82it/s]Processing pocket graphs:  30%|██▉       | 405/1351 [00:26<00:48, 19.71it/s]Processing pocket graphs:  30%|███       | 408/1351 [00:26<00:48, 19.58it/s]Processing pocket graphs:  30%|███       | 410/1351 [00:26<00:49, 18.83it/s]Processing pocket graphs:  30%|███       | 412/1351 [00:26<00:50, 18.56it/s]Processing pocket graphs:  31%|███       | 414/1351 [00:26<00:51, 18.15it/s]Processing pocket graphs:  31%|███       | 417/1351 [00:27<00:49, 18.90it/s]Processing pocket graphs:  31%|███       | 419/1351 [00:27<00:49, 18.74it/s]Processing pocket graphs:  31%|███       | 421/1351 [00:27<00:53, 17.23it/s]Processing pocket graphs:  31%|███▏      | 423/1351 [00:27<00:54, 16.90it/s]Processing pocket graphs:  31%|███▏      | 425/1351 [00:27<00:55, 16.63it/s]Processing pocket graphs:  32%|███▏      | 427/1351 [00:27<00:54, 17.04it/s]Processing pocket graphs:  32%|███▏      | 429/1351 [00:27<00:53, 17.08it/s]Processing pocket graphs:  32%|███▏      | 432/1351 [00:27<00:52, 17.54it/s]Processing pocket graphs:  32%|███▏      | 434/1351 [00:28<00:52, 17.63it/s]Processing pocket graphs:  32%|███▏      | 436/1351 [00:28<00:51, 17.60it/s]Processing pocket graphs:  32%|███▏      | 438/1351 [00:28<00:51, 17.57it/s]Processing pocket graphs:  33%|███▎      | 440/1351 [00:28<00:50, 18.19it/s]Processing pocket graphs:  33%|███▎      | 442/1351 [00:28<00:52, 17.39it/s]Processing pocket graphs:  33%|███▎      | 444/1351 [00:28<00:52, 17.29it/s]Processing pocket graphs:  33%|███▎      | 446/1351 [00:28<00:54, 16.58it/s]Processing pocket graphs:  33%|███▎      | 448/1351 [00:29<01:07, 13.38it/s]Processing pocket graphs:  33%|███▎      | 450/1351 [00:29<01:01, 14.56it/s]Processing pocket graphs:  33%|███▎      | 452/1351 [00:29<01:02, 14.49it/s]Processing pocket graphs:  34%|███▎      | 454/1351 [00:29<00:58, 15.22it/s]Processing pocket graphs:  34%|███▍      | 456/1351 [00:29<00:54, 16.36it/s]Processing pocket graphs:  34%|███▍      | 458/1351 [00:29<00:51, 17.18it/s]Processing pocket graphs:  34%|███▍      | 460/1351 [00:29<00:50, 17.61it/s]Processing pocket graphs:  34%|███▍      | 463/1351 [00:29<00:47, 18.86it/s]Processing pocket graphs:  34%|███▍      | 466/1351 [00:30<00:46, 19.15it/s]Processing pocket graphs:  35%|███▍      | 468/1351 [00:30<00:55, 15.96it/s]Processing pocket graphs:  35%|███▍      | 470/1351 [00:30<01:01, 14.22it/s]Processing pocket graphs:  35%|███▍      | 472/1351 [00:30<01:02, 14.11it/s]Processing pocket graphs:  35%|███▌      | 474/1351 [00:30<01:01, 14.36it/s]Processing pocket graphs:  35%|███▌      | 477/1351 [00:30<00:56, 15.41it/s]Processing pocket graphs:  35%|███▌      | 479/1351 [00:30<00:53, 16.37it/s]Processing pocket graphs:  36%|███▌      | 481/1351 [00:31<00:51, 16.87it/s]Processing pocket graphs:  36%|███▌      | 484/1351 [00:31<00:47, 18.09it/s]Processing pocket graphs:  36%|███▌      | 486/1351 [00:31<00:49, 17.43it/s]Processing pocket graphs:  36%|███▌      | 489/1351 [00:31<00:46, 18.57it/s]Processing pocket graphs:  36%|███▋      | 492/1351 [00:31<00:45, 18.88it/s]Processing pocket graphs:  37%|███▋      | 494/1351 [00:31<00:48, 17.79it/s]Processing pocket graphs:  37%|███▋      | 496/1351 [00:31<00:48, 17.49it/s]Processing pocket graphs:  37%|███▋      | 498/1351 [00:32<00:54, 15.79it/s]Processing pocket graphs:  37%|███▋      | 500/1351 [00:32<00:51, 16.42it/s]Processing pocket graphs:  37%|███▋      | 503/1351 [00:32<00:46, 18.37it/s]Processing pocket graphs:  37%|███▋      | 505/1351 [00:32<00:48, 17.41it/s]Processing pocket graphs:  38%|███▊      | 507/1351 [00:32<00:52, 16.06it/s]Processing pocket graphs:  38%|███▊      | 510/1351 [00:32<00:48, 17.26it/s]Processing pocket graphs:  38%|███▊      | 512/1351 [00:32<00:47, 17.78it/s]Processing pocket graphs:  38%|███▊      | 514/1351 [00:32<00:48, 17.26it/s]Processing pocket graphs:  38%|███▊      | 516/1351 [00:33<00:49, 17.01it/s]Processing pocket graphs:  38%|███▊      | 518/1351 [00:33<00:51, 16.10it/s]Processing pocket graphs:  38%|███▊      | 520/1351 [00:33<00:51, 16.23it/s]Processing pocket graphs:  39%|███▊      | 523/1351 [00:33<00:47, 17.51it/s]Processing pocket graphs:  39%|███▉      | 525/1351 [00:33<00:46, 17.80it/s]Processing pocket graphs:  39%|███▉      | 527/1351 [00:33<00:52, 15.82it/s]Processing pocket graphs:  39%|███▉      | 529/1351 [00:33<00:53, 15.46it/s]Processing pocket graphs:  39%|███▉      | 531/1351 [00:33<00:52, 15.65it/s]Processing pocket graphs:  39%|███▉      | 533/1351 [00:34<00:53, 15.36it/s]Processing pocket graphs:  40%|███▉      | 535/1351 [00:34<00:52, 15.55it/s]Processing pocket graphs:  40%|███▉      | 537/1351 [00:34<00:50, 16.01it/s]Processing pocket graphs:  40%|███▉      | 539/1351 [00:34<00:52, 15.61it/s]Processing pocket graphs:  40%|████      | 541/1351 [00:34<00:49, 16.28it/s]Processing pocket graphs:  40%|████      | 543/1351 [00:34<00:48, 16.58it/s]Processing pocket graphs:  40%|████      | 545/1351 [00:34<00:48, 16.65it/s]Processing pocket graphs:  40%|████      | 547/1351 [00:35<00:54, 14.86it/s]Processing pocket graphs:  41%|████      | 549/1351 [00:35<01:09, 11.56it/s]Processing pocket graphs:  41%|████      | 551/1351 [00:35<01:59,  6.70it/s]Processing pocket graphs:  41%|████      | 553/1351 [00:36<02:39,  5.01it/s]Processing pocket graphs:  41%|████      | 554/1351 [00:36<02:30,  5.30it/s]Processing pocket graphs:  41%|████      | 555/1351 [00:36<02:16,  5.85it/s]Processing pocket graphs:  41%|████      | 556/1351 [00:36<02:07,  6.21it/s]Processing pocket graphs:  41%|████      | 557/1351 [00:36<01:57,  6.74it/s]Processing pocket graphs:  41%|████▏     | 558/1351 [00:37<01:53,  6.98it/s]Processing pocket graphs:  41%|████▏     | 559/1351 [00:37<01:49,  7.26it/s]Processing pocket graphs:  41%|████▏     | 560/1351 [00:37<01:44,  7.57it/s]Processing pocket graphs:  42%|████▏     | 561/1351 [00:37<01:39,  7.97it/s]Processing pocket graphs:  42%|████▏     | 562/1351 [00:37<01:34,  8.38it/s]Processing pocket graphs:  42%|████▏     | 563/1351 [00:37<01:37,  8.09it/s]Processing pocket graphs:  42%|████▏     | 564/1351 [00:37<01:33,  8.45it/s]Processing pocket graphs:  42%|████▏     | 566/1351 [00:37<01:21,  9.69it/s]Processing pocket graphs:  42%|████▏     | 567/1351 [00:38<01:20,  9.76it/s]Processing pocket graphs:  42%|████▏     | 568/1351 [00:38<01:21,  9.66it/s]Processing pocket graphs:  42%|████▏     | 570/1351 [00:38<01:12, 10.83it/s]Processing pocket graphs:  42%|████▏     | 572/1351 [00:38<01:15, 10.26it/s]Processing pocket graphs:  42%|████▏     | 574/1351 [00:38<01:13, 10.51it/s]Processing pocket graphs:  43%|████▎     | 576/1351 [00:38<01:15, 10.25it/s]Processing pocket graphs:  43%|████▎     | 578/1351 [00:39<01:38,  7.82it/s]Processing pocket graphs:  43%|████▎     | 580/1351 [00:39<01:26,  8.96it/s]Processing pocket graphs:  43%|████▎     | 583/1351 [00:39<01:04, 11.86it/s]Processing pocket graphs:  43%|████▎     | 585/1351 [00:40<01:32,  8.27it/s]Processing pocket graphs:  43%|████▎     | 587/1351 [00:40<01:35,  7.99it/s]Processing pocket graphs:  44%|████▎     | 589/1351 [00:40<01:23,  9.10it/s]Processing pocket graphs:  44%|████▎     | 591/1351 [00:40<01:10, 10.76it/s]Processing pocket graphs:  44%|████▍     | 593/1351 [00:40<01:03, 11.99it/s]Processing pocket graphs:  44%|████▍     | 596/1351 [00:40<00:50, 14.92it/s]Processing pocket graphs:  44%|████▍     | 599/1351 [00:40<00:44, 16.75it/s]Processing pocket graphs:  44%|████▍     | 601/1351 [00:41<00:45, 16.39it/s]Processing pocket graphs:  45%|████▍     | 603/1351 [00:41<00:49, 15.21it/s]Processing pocket graphs:  45%|████▍     | 605/1351 [00:41<00:46, 16.14it/s]Processing pocket graphs:  45%|████▍     | 607/1351 [00:41<00:47, 15.78it/s]Processing pocket graphs:  45%|████▌     | 609/1351 [00:41<00:50, 14.72it/s]Processing pocket graphs:  45%|████▌     | 611/1351 [00:41<00:58, 12.62it/s]Processing pocket graphs:  45%|████▌     | 613/1351 [00:41<00:52, 13.97it/s]Processing pocket graphs:  46%|████▌     | 615/1351 [00:42<00:49, 14.80it/s]Processing pocket graphs:  46%|████▌     | 617/1351 [00:42<00:54, 13.47it/s]Processing pocket graphs:  46%|████▌     | 619/1351 [00:42<00:49, 14.85it/s]Processing pocket graphs:  46%|████▌     | 621/1351 [00:42<01:05, 11.18it/s]Processing pocket graphs:  46%|████▌     | 623/1351 [00:42<01:25,  8.55it/s]Processing pocket graphs:  46%|████▋     | 625/1351 [00:43<01:20,  8.98it/s]Processing pocket graphs:  46%|████▋     | 628/1351 [00:43<01:03, 11.45it/s]Processing pocket graphs:  47%|████▋     | 630/1351 [00:43<00:59, 12.16it/s]Processing pocket graphs:  47%|████▋     | 632/1351 [00:43<00:55, 12.94it/s]Processing pocket graphs:  47%|████▋     | 634/1351 [00:43<00:56, 12.69it/s]Processing pocket graphs:  47%|████▋     | 636/1351 [00:43<00:56, 12.64it/s]Processing pocket graphs:  47%|████▋     | 638/1351 [00:44<01:06, 10.78it/s]Processing pocket graphs:  47%|████▋     | 640/1351 [00:44<01:02, 11.32it/s]Processing pocket graphs:  48%|████▊     | 642/1351 [00:44<00:58, 12.04it/s]Processing pocket graphs:  48%|████▊     | 644/1351 [00:44<00:55, 12.72it/s]Processing pocket graphs:  48%|████▊     | 647/1351 [00:44<00:46, 15.14it/s]Processing pocket graphs:  48%|████▊     | 649/1351 [00:44<00:44, 15.82it/s]Processing pocket graphs:  48%|████▊     | 651/1351 [00:44<00:44, 15.91it/s]Processing pocket graphs:  48%|████▊     | 653/1351 [00:45<00:43, 16.04it/s]Processing pocket graphs:  48%|████▊     | 655/1351 [00:45<00:44, 15.74it/s]Processing pocket graphs:  49%|████▊     | 658/1351 [00:45<00:38, 18.08it/s]Processing pocket graphs:  49%|████▉     | 661/1351 [00:45<00:36, 19.03it/s]Processing pocket graphs:  49%|████▉     | 664/1351 [00:45<00:34, 19.64it/s]Processing pocket graphs:  49%|████▉     | 667/1351 [00:45<00:32, 21.14it/s]Processing pocket graphs:  50%|████▉     | 670/1351 [00:45<00:32, 20.68it/s]Processing pocket graphs:  50%|████▉     | 673/1351 [00:46<00:35, 19.29it/s]Processing pocket graphs:  50%|████▉     | 675/1351 [00:46<00:35, 18.81it/s]Processing pocket graphs:  50%|█████     | 678/1351 [00:46<00:34, 19.63it/s]Processing pocket graphs:  50%|█████     | 680/1351 [00:46<00:37, 17.94it/s]Processing pocket graphs:  50%|█████     | 682/1351 [00:46<00:39, 16.90it/s]Processing pocket graphs:  51%|█████     | 684/1351 [00:46<00:38, 17.15it/s]Processing pocket graphs:  51%|█████     | 686/1351 [00:46<00:49, 13.38it/s]Processing pocket graphs:  51%|█████     | 688/1351 [00:47<00:48, 13.57it/s]Processing pocket graphs:  51%|█████     | 690/1351 [00:47<00:57, 11.46it/s]Processing pocket graphs:  51%|█████     | 692/1351 [00:47<00:55, 11.96it/s]Processing pocket graphs:  51%|█████▏    | 694/1351 [00:47<00:56, 11.68it/s]Processing pocket graphs:  52%|█████▏    | 696/1351 [00:47<01:07,  9.70it/s]Processing pocket graphs:  52%|█████▏    | 698/1351 [00:48<01:01, 10.66it/s]Processing pocket graphs:  52%|█████▏    | 700/1351 [00:48<01:01, 10.51it/s]Processing pocket graphs:  52%|█████▏    | 702/1351 [00:48<00:59, 10.96it/s]Processing pocket graphs:  52%|█████▏    | 704/1351 [00:48<00:52, 12.23it/s]Processing pocket graphs:  52%|█████▏    | 706/1351 [00:48<00:49, 12.97it/s]Processing pocket graphs:  52%|█████▏    | 708/1351 [00:48<00:53, 12.05it/s]Processing pocket graphs:  53%|█████▎    | 710/1351 [00:49<00:47, 13.60it/s]Processing pocket graphs:  53%|█████▎    | 713/1351 [00:49<00:40, 15.72it/s]Processing pocket graphs:  53%|█████▎    | 715/1351 [00:49<00:39, 16.03it/s]Processing pocket graphs:  53%|█████▎    | 717/1351 [00:49<00:46, 13.57it/s]Processing pocket graphs:  53%|█████▎    | 719/1351 [00:49<00:43, 14.67it/s]Processing pocket graphs:  53%|█████▎    | 721/1351 [00:49<00:41, 15.34it/s]Processing pocket graphs:  54%|█████▎    | 723/1351 [00:49<00:41, 14.98it/s]Processing pocket graphs:  54%|█████▎    | 725/1351 [00:49<00:42, 14.82it/s]Processing pocket graphs:  54%|█████▍    | 727/1351 [00:50<00:45, 13.80it/s]Processing pocket graphs:  54%|█████▍    | 729/1351 [00:50<00:44, 13.98it/s]Processing pocket graphs:  54%|█████▍    | 731/1351 [00:50<00:41, 14.96it/s]Processing pocket graphs:  54%|█████▍    | 734/1351 [00:50<00:36, 17.04it/s]Processing pocket graphs:  54%|█████▍    | 736/1351 [00:50<00:35, 17.27it/s]Processing pocket graphs:  55%|█████▍    | 739/1351 [00:50<00:37, 16.49it/s]Processing pocket graphs:  55%|█████▍    | 741/1351 [00:50<00:36, 16.84it/s]Processing pocket graphs:  55%|█████▍    | 743/1351 [00:51<00:34, 17.59it/s]Processing pocket graphs:  55%|█████▌    | 746/1351 [00:51<00:31, 19.04it/s]Processing pocket graphs:  55%|█████▌    | 749/1351 [00:51<00:30, 19.66it/s]Processing pocket graphs:  56%|█████▌    | 751/1351 [00:51<00:30, 19.42it/s]Processing pocket graphs:  56%|█████▌    | 754/1351 [00:51<00:30, 19.90it/s]Processing pocket graphs:  56%|█████▌    | 757/1351 [00:51<00:28, 20.57it/s]Processing pocket graphs:  56%|█████▋    | 760/1351 [00:51<00:27, 21.82it/s]Processing pocket graphs:  56%|█████▋    | 763/1351 [00:52<00:27, 21.18it/s]Processing pocket graphs:  57%|█████▋    | 766/1351 [00:52<00:28, 20.21it/s]Processing pocket graphs:  57%|█████▋    | 769/1351 [00:52<00:31, 18.31it/s]Processing pocket graphs:  57%|█████▋    | 771/1351 [00:52<00:33, 17.44it/s]Processing pocket graphs:  57%|█████▋    | 773/1351 [00:52<00:33, 17.36it/s]Processing pocket graphs:  57%|█████▋    | 775/1351 [00:52<00:33, 16.99it/s]Processing pocket graphs:  58%|█████▊    | 777/1351 [00:52<00:34, 16.78it/s]Processing pocket graphs:  58%|█████▊    | 779/1351 [00:52<00:35, 16.24it/s]Processing pocket graphs:  58%|█████▊    | 781/1351 [00:53<00:34, 16.45it/s]Processing pocket graphs:  58%|█████▊    | 783/1351 [00:53<00:36, 15.49it/s]Processing pocket graphs:  58%|█████▊    | 786/1351 [00:53<00:32, 17.45it/s]Processing pocket graphs:  58%|█████▊    | 789/1351 [00:53<00:28, 19.71it/s]Processing pocket graphs:  59%|█████▊    | 792/1351 [00:53<00:25, 21.64it/s]Processing pocket graphs:  59%|█████▉    | 795/1351 [00:53<00:25, 21.94it/s]Processing pocket graphs:  59%|█████▉    | 798/1351 [00:53<00:26, 20.99it/s]Processing pocket graphs:  59%|█████▉    | 801/1351 [00:54<00:28, 19.40it/s]Processing pocket graphs:  59%|█████▉    | 803/1351 [00:54<00:31, 17.46it/s]Processing pocket graphs:  60%|█████▉    | 805/1351 [00:54<00:30, 17.71it/s]Processing pocket graphs:  60%|█████▉    | 807/1351 [00:54<00:33, 16.14it/s]Processing pocket graphs:  60%|█████▉    | 809/1351 [00:54<00:36, 15.04it/s]Processing pocket graphs:  60%|██████    | 811/1351 [00:54<00:39, 13.72it/s]Processing pocket graphs:  60%|██████    | 813/1351 [00:54<00:37, 14.30it/s]Processing pocket graphs:  60%|██████    | 815/1351 [00:55<00:36, 14.88it/s]Processing pocket graphs:  60%|██████    | 817/1351 [00:55<00:33, 15.77it/s]Processing pocket graphs:  61%|██████    | 819/1351 [00:55<00:32, 16.30it/s]Processing pocket graphs:  61%|██████    | 822/1351 [00:55<00:29, 18.01it/s]Processing pocket graphs:  61%|██████    | 824/1351 [00:55<00:30, 17.50it/s]Processing pocket graphs:  61%|██████    | 827/1351 [00:55<00:29, 17.59it/s]Processing pocket graphs:  61%|██████▏   | 829/1351 [00:55<00:29, 17.57it/s]Processing pocket graphs:  62%|██████▏   | 831/1351 [00:55<00:29, 17.70it/s]Processing pocket graphs:  62%|██████▏   | 833/1351 [00:56<00:28, 18.02it/s]Processing pocket graphs:  62%|██████▏   | 835/1351 [00:56<00:28, 18.38it/s]Processing pocket graphs:  62%|██████▏   | 837/1351 [00:56<00:29, 17.61it/s]Processing pocket graphs:  62%|██████▏   | 839/1351 [00:56<00:30, 16.69it/s]Processing pocket graphs:  62%|██████▏   | 841/1351 [00:56<00:30, 16.47it/s]Processing pocket graphs:  62%|██████▏   | 843/1351 [00:56<00:30, 16.46it/s]Processing pocket graphs:  63%|██████▎   | 845/1351 [00:56<00:29, 17.22it/s]Processing pocket graphs:  63%|██████▎   | 847/1351 [00:56<00:28, 17.61it/s]Processing pocket graphs:  63%|██████▎   | 849/1351 [00:57<00:28, 17.87it/s]Processing pocket graphs:  63%|██████▎   | 851/1351 [00:57<00:29, 16.96it/s]Processing pocket graphs:  63%|██████▎   | 853/1351 [00:57<00:30, 16.13it/s]Processing pocket graphs:  63%|██████▎   | 855/1351 [00:57<00:30, 16.50it/s]Processing pocket graphs:  64%|██████▎   | 858/1351 [00:57<00:27, 17.99it/s]Processing pocket graphs:  64%|██████▎   | 861/1351 [00:57<00:24, 20.19it/s]Processing pocket graphs:  64%|██████▍   | 864/1351 [00:57<00:24, 19.85it/s]Processing pocket graphs:  64%|██████▍   | 866/1351 [00:57<00:25, 18.81it/s]Processing pocket graphs:  64%|██████▍   | 868/1351 [00:58<00:25, 18.94it/s]Processing pocket graphs:  64%|██████▍   | 871/1351 [00:58<00:23, 20.17it/s]Processing pocket graphs:  65%|██████▍   | 874/1351 [00:58<00:22, 21.10it/s]Processing pocket graphs:  65%|██████▍   | 877/1351 [00:58<00:23, 20.60it/s]Processing pocket graphs:  65%|██████▌   | 880/1351 [00:58<00:22, 20.95it/s]Processing pocket graphs:  65%|██████▌   | 883/1351 [00:58<00:21, 21.85it/s]Processing pocket graphs:  66%|██████▌   | 886/1351 [00:58<00:21, 21.85it/s]Processing pocket graphs:  66%|██████▌   | 889/1351 [00:59<00:22, 20.66it/s]Processing pocket graphs:  66%|██████▌   | 892/1351 [00:59<00:21, 21.33it/s]Processing pocket graphs:  66%|██████▌   | 895/1351 [00:59<00:21, 21.33it/s]Processing pocket graphs:  66%|██████▋   | 898/1351 [00:59<00:22, 20.24it/s]Processing pocket graphs:  67%|██████▋   | 901/1351 [00:59<00:23, 18.90it/s]Processing pocket graphs:  67%|██████▋   | 903/1351 [00:59<00:24, 17.96it/s]Processing pocket graphs:  67%|██████▋   | 905/1351 [00:59<00:26, 17.01it/s]Processing pocket graphs:  67%|██████▋   | 907/1351 [01:00<00:26, 16.58it/s]Processing pocket graphs:  67%|██████▋   | 909/1351 [01:00<00:27, 16.14it/s]Processing pocket graphs:  68%|██████▊   | 912/1351 [01:00<00:24, 18.10it/s]Processing pocket graphs:  68%|██████▊   | 914/1351 [01:00<00:24, 17.93it/s]Processing pocket graphs:  68%|██████▊   | 917/1351 [01:00<00:22, 19.34it/s]Processing pocket graphs:  68%|██████▊   | 919/1351 [01:00<00:28, 15.32it/s]Processing pocket graphs:  68%|██████▊   | 921/1351 [01:00<00:27, 15.79it/s]Processing pocket graphs:  68%|██████▊   | 923/1351 [01:00<00:25, 16.71it/s]Processing pocket graphs:  68%|██████▊   | 925/1351 [01:01<00:25, 16.65it/s]Processing pocket graphs:  69%|██████▊   | 928/1351 [01:01<00:23, 18.22it/s]Processing pocket graphs:  69%|██████▉   | 931/1351 [01:01<00:22, 19.08it/s]Processing pocket graphs:  69%|██████▉   | 933/1351 [01:01<00:22, 18.54it/s]Processing pocket graphs:  69%|██████▉   | 935/1351 [01:01<00:27, 15.11it/s]Processing pocket graphs:  69%|██████▉   | 937/1351 [01:01<00:36, 11.29it/s]Processing pocket graphs:  70%|██████▉   | 939/1351 [01:02<00:45,  9.01it/s]Processing pocket graphs:  70%|██████▉   | 941/1351 [01:02<00:38, 10.56it/s]Processing pocket graphs:  70%|██████▉   | 944/1351 [01:02<00:31, 13.04it/s]Processing pocket graphs:  70%|███████   | 947/1351 [01:02<00:26, 15.04it/s]Processing pocket graphs:  70%|███████   | 950/1351 [01:02<00:23, 17.36it/s]Processing pocket graphs:  70%|███████   | 952/1351 [01:02<00:22, 17.42it/s]Processing pocket graphs:  71%|███████   | 954/1351 [01:03<00:22, 17.50it/s]Processing pocket graphs:  71%|███████   | 956/1351 [01:03<00:21, 17.97it/s]Processing pocket graphs:  71%|███████   | 959/1351 [01:03<00:19, 19.77it/s]Processing pocket graphs:  71%|███████   | 962/1351 [01:03<00:18, 21.21it/s]Processing pocket graphs:  71%|███████▏  | 965/1351 [01:03<00:18, 20.77it/s]Processing pocket graphs:  72%|███████▏  | 968/1351 [01:03<00:18, 20.21it/s]Processing pocket graphs:  72%|███████▏  | 971/1351 [01:03<00:19, 19.79it/s]Processing pocket graphs:  72%|███████▏  | 974/1351 [01:04<00:19, 19.55it/s]Processing pocket graphs:  72%|███████▏  | 976/1351 [01:04<00:19, 18.88it/s]Processing pocket graphs:  72%|███████▏  | 979/1351 [01:04<00:18, 19.72it/s]Processing pocket graphs:  73%|███████▎  | 982/1351 [01:04<00:17, 21.05it/s]Processing pocket graphs:  73%|███████▎  | 985/1351 [01:04<00:16, 21.74it/s]Processing pocket graphs:  73%|███████▎  | 988/1351 [01:04<00:17, 21.04it/s]Processing pocket graphs:  73%|███████▎  | 991/1351 [01:04<00:17, 20.82it/s]Processing pocket graphs:  74%|███████▎  | 994/1351 [01:04<00:16, 21.27it/s]Processing pocket graphs:  74%|███████▍  | 997/1351 [01:05<00:16, 21.09it/s]Processing pocket graphs:  74%|███████▍  | 1000/1351 [01:05<00:17, 19.79it/s]Processing pocket graphs:  74%|███████▍  | 1003/1351 [01:05<00:18, 19.17it/s]Processing pocket graphs:  74%|███████▍  | 1005/1351 [01:05<00:18, 18.39it/s]Processing pocket graphs:  75%|███████▍  | 1007/1351 [01:05<00:19, 17.55it/s]Processing pocket graphs:  75%|███████▍  | 1009/1351 [01:05<00:20, 17.09it/s]Processing pocket graphs:  75%|███████▍  | 1011/1351 [01:05<00:20, 16.49it/s]Processing pocket graphs:  75%|███████▍  | 1013/1351 [01:06<00:21, 15.89it/s]Processing pocket graphs:  75%|███████▌  | 1015/1351 [01:06<00:22, 15.10it/s]Processing pocket graphs:  75%|███████▌  | 1017/1351 [01:06<00:22, 15.16it/s]Processing pocket graphs:  75%|███████▌  | 1019/1351 [01:06<00:23, 14.24it/s]Processing pocket graphs:  76%|███████▌  | 1021/1351 [01:06<00:23, 14.26it/s]Processing pocket graphs:  76%|███████▌  | 1023/1351 [01:06<00:26, 12.54it/s]Processing pocket graphs:  76%|███████▌  | 1025/1351 [01:07<00:24, 13.07it/s]Processing pocket graphs:  76%|███████▌  | 1027/1351 [01:07<00:24, 13.36it/s]Processing pocket graphs:  76%|███████▌  | 1029/1351 [01:07<00:21, 14.82it/s]Processing pocket graphs:  76%|███████▋  | 1031/1351 [01:07<00:20, 15.92it/s]Processing pocket graphs:  77%|███████▋  | 1034/1351 [01:07<00:18, 17.39it/s]Processing pocket graphs:  77%|███████▋  | 1036/1351 [01:07<00:17, 17.66it/s]Processing pocket graphs:  77%|███████▋  | 1038/1351 [01:07<00:17, 17.51it/s]Processing pocket graphs:  77%|███████▋  | 1040/1351 [01:07<00:17, 18.07it/s]Processing pocket graphs:  77%|███████▋  | 1042/1351 [01:07<00:16, 18.48it/s]Processing pocket graphs:  77%|███████▋  | 1045/1351 [01:08<00:14, 20.58it/s]Processing pocket graphs:  78%|███████▊  | 1048/1351 [01:08<00:15, 19.78it/s]Processing pocket graphs:  78%|███████▊  | 1051/1351 [01:08<00:15, 19.20it/s]Processing pocket graphs:  78%|███████▊  | 1053/1351 [01:08<00:15, 18.73it/s]Processing pocket graphs:  78%|███████▊  | 1056/1351 [01:08<00:16, 18.06it/s]Processing pocket graphs:  78%|███████▊  | 1059/1351 [01:08<00:15, 18.61it/s]Processing pocket graphs:  79%|███████▊  | 1062/1351 [01:08<00:14, 19.67it/s]Processing pocket graphs:  79%|███████▉  | 1065/1351 [01:09<00:13, 20.92it/s]Processing pocket graphs:  79%|███████▉  | 1068/1351 [01:09<00:13, 21.02it/s]Processing pocket graphs:  79%|███████▉  | 1071/1351 [01:09<00:13, 20.76it/s]Processing pocket graphs:  79%|███████▉  | 1074/1351 [01:09<00:12, 21.77it/s]Processing pocket graphs:  80%|███████▉  | 1077/1351 [01:09<00:14, 18.87it/s]Processing pocket graphs:  80%|███████▉  | 1079/1351 [01:09<00:17, 15.61it/s]Processing pocket graphs:  80%|████████  | 1081/1351 [01:10<00:16, 16.37it/s]Processing pocket graphs:  80%|████████  | 1084/1351 [01:10<00:14, 17.92it/s]Processing pocket graphs:  80%|████████  | 1086/1351 [01:10<00:16, 16.54it/s]Processing pocket graphs:  81%|████████  | 1088/1351 [01:10<00:15, 16.79it/s]Processing pocket graphs:  81%|████████  | 1090/1351 [01:10<00:15, 16.92it/s]Processing pocket graphs:  81%|████████  | 1093/1351 [01:10<00:14, 17.27it/s]Processing pocket graphs:  81%|████████  | 1095/1351 [01:10<00:15, 16.37it/s]Processing pocket graphs:  81%|████████  | 1097/1351 [01:10<00:15, 16.41it/s]Processing pocket graphs:  81%|████████▏ | 1099/1351 [01:11<00:16, 14.95it/s]Processing pocket graphs:  81%|████████▏ | 1101/1351 [01:11<00:16, 14.78it/s]Processing pocket graphs:  82%|████████▏ | 1103/1351 [01:11<00:16, 14.96it/s]Processing pocket graphs:  82%|████████▏ | 1105/1351 [01:11<00:15, 15.89it/s]Processing pocket graphs:  82%|████████▏ | 1108/1351 [01:11<00:15, 15.43it/s]Processing pocket graphs:  82%|████████▏ | 1110/1351 [01:11<00:15, 16.06it/s]Processing pocket graphs:  82%|████████▏ | 1113/1351 [01:11<00:13, 17.61it/s]Processing pocket graphs:  83%|████████▎ | 1116/1351 [01:12<00:12, 18.96it/s]Processing pocket graphs:  83%|████████▎ | 1119/1351 [01:12<00:11, 19.81it/s]Processing pocket graphs:  83%|████████▎ | 1122/1351 [01:12<00:10, 21.36it/s]Processing pocket graphs:  83%|████████▎ | 1125/1351 [01:12<00:10, 20.55it/s]Processing pocket graphs:  83%|████████▎ | 1128/1351 [01:12<00:10, 21.23it/s]Processing pocket graphs:  84%|████████▎ | 1131/1351 [01:12<00:10, 21.25it/s]Processing pocket graphs:  84%|████████▍ | 1134/1351 [01:12<00:10, 20.91it/s]Processing pocket graphs:  84%|████████▍ | 1137/1351 [01:13<00:09, 21.49it/s]Processing pocket graphs:  84%|████████▍ | 1140/1351 [01:13<00:09, 21.80it/s]Processing pocket graphs:  85%|████████▍ | 1143/1351 [01:13<00:09, 21.30it/s]Processing pocket graphs:  85%|████████▍ | 1146/1351 [01:13<00:10, 19.88it/s]Processing pocket graphs:  85%|████████▌ | 1149/1351 [01:13<00:09, 20.59it/s]Processing pocket graphs:  85%|████████▌ | 1152/1351 [01:13<00:10, 18.55it/s]Processing pocket graphs:  85%|████████▌ | 1154/1351 [01:13<00:10, 18.84it/s]Processing pocket graphs:  86%|████████▌ | 1156/1351 [01:14<00:10, 18.34it/s]Processing pocket graphs:  86%|████████▌ | 1159/1351 [01:14<00:10, 17.81it/s]Processing pocket graphs:  86%|████████▌ | 1161/1351 [01:14<00:10, 17.83it/s]Processing pocket graphs:  86%|████████▌ | 1163/1351 [01:14<00:10, 17.50it/s]Processing pocket graphs:  86%|████████▌ | 1165/1351 [01:14<00:10, 17.62it/s]Processing pocket graphs:  86%|████████▋ | 1167/1351 [01:14<00:10, 17.89it/s]Processing pocket graphs:  87%|████████▋ | 1170/1351 [01:14<00:09, 19.53it/s]Processing pocket graphs:  87%|████████▋ | 1172/1351 [01:14<00:09, 19.35it/s]Processing pocket graphs:  87%|████████▋ | 1175/1351 [01:15<00:08, 19.70it/s]Processing pocket graphs:  87%|████████▋ | 1178/1351 [01:15<00:08, 20.30it/s]Processing pocket graphs:  87%|████████▋ | 1181/1351 [01:15<00:08, 20.95it/s]Processing pocket graphs:  88%|████████▊ | 1184/1351 [01:15<00:07, 21.04it/s]Processing pocket graphs:  88%|████████▊ | 1187/1351 [01:15<00:07, 20.85it/s]Processing pocket graphs:  88%|████████▊ | 1190/1351 [01:15<00:07, 20.97it/s]Processing pocket graphs:  88%|████████▊ | 1193/1351 [01:15<00:07, 21.42it/s]Processing pocket graphs:  89%|████████▊ | 1196/1351 [01:16<00:07, 21.97it/s]Processing pocket graphs:  89%|████████▊ | 1199/1351 [01:16<00:07, 21.56it/s]Processing pocket graphs:  89%|████████▉ | 1202/1351 [01:16<00:06, 22.13it/s]Processing pocket graphs:  89%|████████▉ | 1205/1351 [01:16<00:06, 21.00it/s]Processing pocket graphs:  89%|████████▉ | 1208/1351 [01:16<00:06, 21.27it/s]Processing pocket graphs:  90%|████████▉ | 1211/1351 [01:16<00:06, 20.82it/s]Processing pocket graphs:  90%|████████▉ | 1214/1351 [01:16<00:06, 21.82it/s]Processing pocket graphs:  90%|█████████ | 1217/1351 [01:17<00:06, 21.53it/s]Processing pocket graphs:  90%|█████████ | 1220/1351 [01:17<00:06, 19.70it/s]Processing pocket graphs:  91%|█████████ | 1223/1351 [01:17<00:06, 19.83it/s]Processing pocket graphs:  91%|█████████ | 1226/1351 [01:17<00:06, 20.37it/s]Processing pocket graphs:  91%|█████████ | 1229/1351 [01:17<00:07, 16.46it/s]Processing pocket graphs:  91%|█████████ | 1231/1351 [01:17<00:08, 14.95it/s]Processing pocket graphs:  91%|█████████▏| 1233/1351 [01:18<00:08, 13.61it/s]Processing pocket graphs:  91%|█████████▏| 1235/1351 [01:18<00:09, 12.88it/s]Processing pocket graphs:  92%|█████████▏| 1237/1351 [01:18<00:08, 13.17it/s]Processing pocket graphs:  92%|█████████▏| 1239/1351 [01:18<00:08, 13.26it/s]Processing pocket graphs:  92%|█████████▏| 1241/1351 [01:18<00:07, 14.29it/s]Processing pocket graphs:  92%|█████████▏| 1243/1351 [01:18<00:06, 15.49it/s]Processing pocket graphs:  92%|█████████▏| 1246/1351 [01:18<00:06, 17.16it/s]Processing pocket graphs:  92%|█████████▏| 1249/1351 [01:19<00:05, 18.71it/s]Processing pocket graphs:  93%|█████████▎| 1251/1351 [01:19<00:05, 18.46it/s]Processing pocket graphs:  93%|█████████▎| 1254/1351 [01:19<00:04, 20.04it/s]Processing pocket graphs:  93%|█████████▎| 1257/1351 [01:19<00:04, 19.44it/s]Processing pocket graphs:  93%|█████████▎| 1260/1351 [01:19<00:04, 20.35it/s]Processing pocket graphs:  93%|█████████▎| 1263/1351 [01:19<00:04, 19.08it/s]Processing pocket graphs:  94%|█████████▎| 1265/1351 [01:19<00:04, 19.17it/s]Processing pocket graphs:  94%|█████████▍| 1268/1351 [01:20<00:04, 19.93it/s]Processing pocket graphs:  94%|█████████▍| 1271/1351 [01:20<00:03, 20.26it/s]Processing pocket graphs:  94%|█████████▍| 1274/1351 [01:20<00:03, 21.22it/s]Processing pocket graphs:  95%|█████████▍| 1277/1351 [01:20<00:03, 21.40it/s]Processing pocket graphs:  95%|█████████▍| 1280/1351 [01:20<00:03, 21.20it/s]Processing pocket graphs:  95%|█████████▍| 1283/1351 [01:20<00:03, 21.80it/s]Processing pocket graphs:  95%|█████████▌| 1286/1351 [01:20<00:03, 21.38it/s]Processing pocket graphs:  95%|█████████▌| 1289/1351 [01:22<00:09,  6.35it/s]Processing pocket graphs:  96%|█████████▌| 1291/1351 [01:23<00:14,  4.07it/s]Processing pocket graphs:  96%|█████████▌| 1293/1351 [01:24<00:20,  2.90it/s]Processing pocket graphs:  96%|█████████▌| 1294/1351 [01:25<00:23,  2.48it/s]Processing pocket graphs:  96%|█████████▌| 1295/1351 [01:25<00:24,  2.32it/s]Processing pocket graphs:  96%|█████████▌| 1297/1351 [01:25<00:16,  3.29it/s]Processing pocket graphs:  96%|█████████▌| 1300/1351 [01:26<00:10,  5.08it/s]Processing pocket graphs:  96%|█████████▋| 1303/1351 [01:26<00:06,  7.02it/s]Processing pocket graphs:  97%|█████████▋| 1306/1351 [01:26<00:04,  9.16it/s]Processing pocket graphs:  97%|█████████▋| 1309/1351 [01:26<00:03, 11.41it/s]Processing pocket graphs:  97%|█████████▋| 1311/1351 [01:26<00:03, 12.57it/s]Processing pocket graphs:  97%|█████████▋| 1314/1351 [01:26<00:02, 14.63it/s]Processing pocket graphs:  97%|█████████▋| 1317/1351 [01:26<00:02, 15.71it/s]Processing pocket graphs:  98%|█████████▊| 1319/1351 [01:27<00:02, 15.82it/s]Processing pocket graphs:  98%|█████████▊| 1321/1351 [01:27<00:01, 15.69it/s]Processing pocket graphs:  98%|█████████▊| 1323/1351 [01:27<00:01, 15.44it/s]Processing pocket graphs:  98%|█████████▊| 1326/1351 [01:27<00:01, 17.97it/s]Processing pocket graphs:  98%|█████████▊| 1329/1351 [01:27<00:01, 19.59it/s]Processing pocket graphs:  99%|█████████▊| 1332/1351 [01:27<00:00, 20.43it/s]Processing pocket graphs:  99%|█████████▉| 1335/1351 [01:27<00:00, 20.30it/s]Processing pocket graphs:  99%|█████████▉| 1338/1351 [01:28<00:00, 19.06it/s]Processing pocket graphs:  99%|█████████▉| 1340/1351 [01:28<00:00, 17.94it/s]Processing pocket graphs:  99%|█████████▉| 1342/1351 [01:28<00:00, 17.58it/s]Processing pocket graphs:  99%|█████████▉| 1344/1351 [01:28<00:00, 17.10it/s]Processing pocket graphs: 100%|█████████▉| 1346/1351 [01:28<00:00, 17.64it/s]Processing pocket graphs: 100%|█████████▉| 1349/1351 [01:28<00:00, 20.23it/s]Processing pocket graphs: 100%|██████████| 1351/1351 [01:28<00:00, 15.23it/s]

Successfully processed 1351 pocket embeddings

======================================================================
Step 2: Loading Ligand Embeddings
======================================================================

Loading from data/processed/ligand_embeddings_dedup.h5...
Loaded 291 unique ligand embeddings
Sample ligands: ['0EC', '1PE', '1TU', '218', '29G', '29H', '2BA', '2QB', '2QC', '2ZY']

======================================================================
Step 3: Matching Pocket-Ligand Pairs
======================================================================

Matched pairs: 1268
Unmatched pockets: 83

Sample unmatched pockets: ['6tf3_3AT_model0', '6tfe_N6E_model0', '6tfg_PPS_model0', '6u7y_C5P_model0', '6u7z_C5P_model0']
Missing ligand names: ['CMG', 'Q44', 'YO3', 'TG', 'N6E', 'PPS', 'Q1V', '3AT', 'C5P']

======================================================================
Step 4: Joint Dimensionality Reduction & Visualization
======================================================================

  Applying PCA...
    Explained variance: 0.634
  ✓ Created PCA visualizations
  Applying TSNE...
  ✗ Error with TSNE: TSNE.__init__() got an unexpected keyword argument 'n_iter'

======================================================================
Step 5: Distance Analysis
======================================================================


Distance Statistics:
       cosine_distance  euclidean_distance  cosine_similarity
count      1268.000000         1268.000000        1268.000000
mean          0.481411           27.682420           0.518589
std           0.453718           14.810356           0.453718
min           0.026632            7.623290          -0.800577
25%           0.126526           17.072309           0.305176
50%           0.285748           22.559359           0.714252
75%           0.694824           33.854363           0.873474
max           1.800577           75.849220           0.973368

✓ Saved distance data to pocket_ligand_distances.csv

Top 10 Ligands by Average Cosine Distance (most similar):
             cosine_distance_mean  ...  cosine_similarity_std
ligand_name                        ...                       
773                        0.0434  ...                    NaN
R14                        0.0636  ...                    NaN
QIJ                        0.0643  ...                    NaN
G0B                        0.0647  ...                 0.0359
GDZ                        0.0713  ...                 0.0364
SLZ                        0.0844  ...                    NaN
IEL                        0.0861  ...                    NaN
DKM                        0.0869  ...                    NaN
PMZ                        0.0893  ...                 0.0250
TEP                        0.0930  ...                 0.0631

[10 rows x 5 columns]

======================================================================
Step 6: Embedding Correlation Analysis
======================================================================


Correlation Statistics:
         pearson_r   spearman_r
count  1268.000000  1268.000000
mean      0.519089     0.515451
std       0.454023     0.463463
min      -0.801522    -0.814783
25%       0.306748     0.281445
50%       0.714620     0.717304
75%       0.874058     0.874179
max       0.973565     0.973369

✓ Saved correlation data to pocket_ligand_correlations.csv

======================================================================
Step 7: Ligand Summary Statistics
======================================================================


Total unique ligands: 249

Top 20 ligands by pocket count:
ligand_name  n_pockets
        53D        121
        PAR         92
        PRF         53
        ARG         52
        MQC         40
        SPM         39
        SAM         36
        RIO         30
        GTP         28
        MGR         25
        EPE         25
        FMN         23
        NMY         22
        AMP         21
        FH8         21
        GDZ         20
        G0B         20
        AM2         17
        2BA         17
        P13         16

✓ Saved ligand summary to ligand_summary.csv

======================================================================
Step 8: Saving Embeddings
======================================================================

✓ Saved 1351 pocket embeddings to pocket_embeddings.npz
✓ Saved 1268 matched pairs to matched_pairs.json

======================================================================
Step 9: Generating Analysis Report
======================================================================

✓ Generated analysis_report.md

Report preview:
----------------------------------------------------------------------
# Pocket-Ligand Embedding Analysis Report
Generated: 2025-11-03 21:36:49.823191

## Summary Statistics

- **Total matched pocket-ligand pairs**: 1268
- **Unique ligands**: 249
- **Embedding dimension**: 1536

## Distance Metrics

### Cosine Distance
- Mean: 0.4814
- Median: 0.2857
- Std: 0.4537
- Min: 0.0266
- Max: 1.8006

### Cosine Similarity
- Mean: 0.5186
- Median: 0.7143
- Std: 0.4537

## Correlation Analysis

- **Mean Pearson r**: 0.5191
- **Mean Spearman r**: 0.5155

## Top 10 Most Common...
----------------------------------------------------------------------

======================================================================
✓ Pipeline completed successfully!
======================================================================

All results saved to: results/embedding_analysis/visualizations

Key outputs:
  - Visualizations: 2 methods × 3 plot types
  - Data files: 6 CSV/JSON/NPZ files
  - Report: analysis_report.md

✓ Step 1 completed successfully

═══════════════════════════════════════════════════════════════════════
Step 2: Running Advanced Analysis
═══════════════════════════════════════════════════════════════════════


======================================================================
Advanced Embedding Analysis Pipeline
======================================================================

Loading matched pairs from results/embedding_analysis/visualizations/matched_pairs.json...
Loaded 1268 matched pairs

======================================================================
Clustering Analysis
======================================================================

Finding optimal number of clusters...
Traceback (most recent call last):
  File "/personal/RNA-3E-FFI/scripts/advanced_embedding_analysis.py", line 582, in <module>
    main()
  File "/personal/RNA-3E-FFI/scripts/advanced_embedding_analysis.py", line 561, in main
    cluster_labels, optimal_k = perform_clustering_analysis(matched_data, output_dir)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/personal/RNA-3E-FFI/scripts/advanced_embedding_analysis.py", line 95, in perform_clustering_analysis
    axes[1].plot(list(K_range)[1:], silhouette_scores, 'ro-')
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/matplotlib/axes/_axes.py", line 1777, in plot
    lines = [*self._get_lines(self, *args, data=data, **kwargs)]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 297, in __call__
    yield from self._plot_args(
               ^^^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/matplotlib/axes/_base.py", line 494, in _plot_args
    raise ValueError(f"x and y must have same first dimension, but "
ValueError: x and y must have same first dimension, but have shapes (18,) and (19,)
