nohup: ignoring input
==========================================
Training with Memory Optimization
==========================================
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(

Starting distributed training with 4 GPUs...
Spawning processes...

/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
[rank3]:[W1110 20:50:40.623979606 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank1]:[W1110 20:50:40.768533711 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W1110 20:50:40.841117299 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank0]:[W1110 20:50:40.883594032 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Using device: cuda:0
Distributed training with 4 GPUs
Loading splits from data/splits/filtered_splits.json
Dataset splits: Train=954, Val=117, Test=122
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes

Initializing v3.0 model (with V3 improvements)...
Using RNAPocketEncoderV3 (geometric MP + enhanced invariants + multi-head attention)
  Geometric MP: True
  Enhanced invariants: True (206-dim vs 56-dim)
  Attention heads: 8
Model has 3,329,297 parameters

Model configuration:
  Multi-hop: True
  Non-bonded: True
  Pooling: attention
  Initial angle weight: 0.333
  Initial dihedral weight: 0.333
  Initial nonbonded weight: 0.333

Starting training from scratch...


============================================================
Training Configuration
============================================================
Batch Size per GPU: 8
Number of GPUs: 4
Effective Batch Size: 32

Mixed Precision Training (AMP): Disabled

Loss Function: mse

Gradient Clipping: 1.0 (manual)
Gradient Monitoring: ENABLED (will print every 50 batches)
============================================================

Starting training...

Epoch 1/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
Training:   3%|▎         | 1/30 [00:08<03:56,  8.14s/it]Training:   3%|▎         | 1/30 [00:08<03:55,  8.13s/it]Training:   3%|▎         | 1/30 [00:08<03:55,  8.13s/it]Training:   3%|▎         | 1/30 [00:08<03:56,  8.14s/it]Training:   7%|▋         | 2/30 [00:09<02:00,  4.29s/it]Training:   7%|▋         | 2/30 [00:09<01:59,  4.29s/it]Training:   7%|▋         | 2/30 [00:09<01:59,  4.29s/it]Training:   7%|▋         | 2/30 [00:09<02:00,  4.29s/it]Training:  10%|█         | 3/30 [00:16<02:20,  5.20s/it]Training:  10%|█         | 3/30 [00:16<02:20,  5.20s/it]Training:  10%|█         | 3/30 [00:16<02:20,  5.20s/it]Training:  10%|█         | 3/30 [00:16<02:20,  5.20s/it]Training:  13%|█▎        | 4/30 [00:22<02:25,  5.60s/it]Training:  13%|█▎        | 4/30 [00:22<02:25,  5.60s/it]Training:  13%|█▎        | 4/30 [00:22<02:25,  5.60s/it]Training:  13%|█▎        | 4/30 [00:22<02:25,  5.60s/it]Training:  17%|█▋        | 5/30 [00:28<02:29,  5.97s/it]Training:  17%|█▋        | 5/30 [00:28<02:29,  5.97s/it]Training:  17%|█▋        | 5/30 [00:28<02:29,  5.97s/it]Training:  17%|█▋        | 5/30 [00:28<02:29,  5.97s/it]Training:  20%|██        | 6/30 [00:29<01:40,  4.20s/it]Training:  20%|██        | 6/30 [00:29<01:40,  4.20s/it]Training:  20%|██        | 6/30 [00:29<01:40,  4.20s/it]Training:  20%|██        | 6/30 [00:29<01:40,  4.20s/it]Training:  23%|██▎       | 7/30 [00:30<01:11,  3.11s/it]Training:  23%|██▎       | 7/30 [00:30<01:11,  3.11s/it]Training:  23%|██▎       | 7/30 [00:30<01:11,  3.11s/it]Training:  23%|██▎       | 7/30 [00:30<01:11,  3.11s/it]Training:  27%|██▋       | 8/30 [00:31<00:52,  2.38s/it]Training:  27%|██▋       | 8/30 [00:31<00:52,  2.38s/it]Training:  27%|██▋       | 8/30 [00:31<00:52,  2.38s/it]Training:  27%|██▋       | 8/30 [00:31<00:52,  2.38s/it]Training:  30%|███       | 9/30 [00:31<00:38,  1.84s/it]Training:  30%|███       | 9/30 [00:31<00:38,  1.84s/it]Training:  30%|███       | 9/30 [00:31<00:38,  1.84s/it]Training:  30%|███       | 9/30 [00:31<00:38,  1.84s/it]Training:  33%|███▎      | 10/30 [00:32<00:30,  1.51s/it]Training:  33%|███▎      | 10/30 [00:32<00:30,  1.51s/it]Training:  33%|███▎      | 10/30 [00:32<00:30,  1.51s/it]Training:  33%|███▎      | 10/30 [00:32<00:30,  1.51s/it]Training:  37%|███▋      | 11/30 [00:33<00:26,  1.37s/it]Training:  37%|███▋      | 11/30 [00:33<00:26,  1.37s/it]Training:  37%|███▋      | 11/30 [00:33<00:26,  1.38s/it]Training:  37%|███▋      | 11/30 [00:33<00:26,  1.37s/it]Training:  40%|████      | 12/30 [00:34<00:21,  1.18s/it]Training:  40%|████      | 12/30 [00:34<00:21,  1.18s/it]Training:  40%|████      | 12/30 [00:34<00:21,  1.18s/it]Training:  40%|████      | 12/30 [00:34<00:21,  1.18s/it]Training:  43%|████▎     | 13/30 [00:35<00:18,  1.08s/it]Training:  43%|████▎     | 13/30 [00:35<00:18,  1.08s/it]Training:  43%|████▎     | 13/30 [00:35<00:18,  1.08s/it]Training:  43%|████▎     | 13/30 [00:35<00:18,  1.08s/it]Training:  47%|████▋     | 14/30 [00:36<00:15,  1.04it/s]Training:  47%|████▋     | 14/30 [00:36<00:15,  1.04it/s]Training:  47%|████▋     | 14/30 [00:36<00:15,  1.04it/s]Training:  47%|████▋     | 14/30 [00:36<00:15,  1.04it/s]Training:  50%|█████     | 15/30 [00:37<00:15,  1.02s/it]Training:  50%|█████     | 15/30 [00:37<00:15,  1.03s/it]Training:  50%|█████     | 15/30 [00:37<00:15,  1.03s/it]Training:  50%|█████     | 15/30 [00:37<00:15,  1.03s/it]Training:  53%|█████▎    | 16/30 [00:38<00:13,  1.05it/s]Training:  53%|█████▎    | 16/30 [00:38<00:13,  1.05it/s]Training:  53%|█████▎    | 16/30 [00:38<00:13,  1.05it/s]Training:  53%|█████▎    | 16/30 [00:38<00:13,  1.05it/s]Training:  57%|█████▋    | 17/30 [00:38<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:38<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:38<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:38<00:11,  1.15it/s]Training:  60%|██████    | 18/30 [00:39<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:39<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:39<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:39<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:40<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:40<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:40<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:40<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:40<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:40<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:40<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:40<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:41<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:41<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:41<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:41<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:42<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:42<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:42<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:42<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:43<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:43<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:43<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:43<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:43<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:43<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:43<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:43<00:04,  1.36it/s]Training:  83%|████████▎ | 25/30 [00:44<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:44<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:44<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:44<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:45<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:45<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:45<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:45<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:46<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:46<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:46<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:46<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:47<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:47<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:47<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:47<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:47<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:47<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:47<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:47<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:48<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:48<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:48<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:48<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:49<00:00,  1.65s/it]
Training: 100%|██████████| 30/30 [00:49<00:00,  1.65s/it]Training: 100%|██████████| 30/30 [00:49<00:00,  1.65s/it]
  Batch 0: Grad norm before clip = 0.847913
  Batch 10: Grad norm before clip = 0.526651
  Batch 20: Grad norm before clip = 0.357437
Train Loss: 1.689626, Cosine Sim: 0.0954

Training: 100%|██████████| 30/30 [00:49<00:00,  1.65s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 0.847913
  Batch 10: Grad norm before clip = 0.526651
  Batch 20: Grad norm before clip = 0.357437
  Batch 0: Grad norm before clip = 0.847913
  Batch 10: Grad norm before clip = 0.526651
  Batch 20: Grad norm before clip = 0.357437
  Batch 0: Grad norm before clip = 0.847913
  Batch 10: Grad norm before clip = 0.526651
  Batch 20: Grad norm before clip = 0.357437
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:472: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:472: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:472: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:472: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:10<00:10,  5.35s/it]Evaluating:  50%|█████     | 2/4 [00:10<00:10,  5.35s/it]Evaluating:  50%|█████     | 2/4 [00:10<00:10,  5.34s/it]Evaluating:  50%|█████     | 2/4 [00:10<00:10,  5.40s/it]Evaluating:  75%|███████▌  | 3/4 [00:16<00:05,  5.53s/it]Evaluating:  75%|███████▌  | 3/4 [00:16<00:05,  5.54s/it]Evaluating:  75%|███████▌  | 3/4 [00:16<00:05,  5.53s/it]Evaluating: 100%|██████████| 4/4 [00:16<00:00,  3.40s/it]Evaluating: 100%|██████████| 4/4 [00:16<00:00,  3.40s/it]Evaluating: 100%|██████████| 4/4 [00:16<00:00,  3.40s/it]Evaluating:  75%|███████▌  | 3/4 [00:16<00:05,  5.60s/it]Evaluating: 100%|██████████| 4/4 [00:16<00:00,  3.44s/it]Evaluating: 100%|██████████| 4/4 [00:17<00:00,  4.37s/it]
Evaluating: 100%|██████████| 4/4 [00:17<00:00,  4.37s/it]
Evaluating: 100%|██████████| 4/4 [00:17<00:00,  4.37s/it]
Evaluating: 100%|██████████| 4/4 [00:17<00:00,  4.41s/it]
Val Loss: 1.980446, Cosine Sim: 0.0559, MSE: 1.9804
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 2/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 0.234425
  Batch 10: Grad norm before clip = 0.375192
  Batch 20: Grad norm before clip = 0.343955
Train Loss: 1.637991, Cosine Sim: 0.1638

  Batch 0: Grad norm before clip = 0.234425
  Batch 10: Grad norm before clip = 0.375192
  Batch 20: Grad norm before clip = 0.343955
  Batch 0: Grad norm before clip = 0.234425
  Batch 10: Grad norm before clip = 0.375192
  Batch 20: Grad norm before clip = 0.343955
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 0.234425
  Batch 10: Grad norm before clip = 0.375192
  Batch 20: Grad norm before clip = 0.343955
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.32it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 1.942823, Cosine Sim: 0.0775, MSE: 1.9428
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 3/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.35it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.35it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.35it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.35it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 0.280103
  Batch 10: Grad norm before clip = 0.282088
  Batch 20: Grad norm before clip = 0.503587

  Batch 0: Grad norm before clip = 0.280103
  Batch 10: Grad norm before clip = 0.282088
  Batch 20: Grad norm before clip = 0.503587
  Batch 0: Grad norm before clip = 0.280103
  Batch 10: Grad norm before clip = 0.282088
  Batch 20: Grad norm before clip = 0.503587
Train Loss: 1.541953, Cosine Sim: 0.2203
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 0.280103
  Batch 10: Grad norm before clip = 0.282088
  Batch 20: Grad norm before clip = 0.503587
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 1.761963, Cosine Sim: 0.1482, MSE: 1.7620
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 4/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.450266
  Batch 10: Grad norm before clip = 1.425103
  Batch 20: Grad norm before clip = 2.270261
Train Loss: 1.471447, Cosine Sim: 0.2343

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.450266
  Batch 10: Grad norm before clip = 1.425103
  Batch 20: Grad norm before clip = 2.270261
  Batch 0: Grad norm before clip = 2.450266
  Batch 10: Grad norm before clip = 1.425103
  Batch 20: Grad norm before clip = 2.270261
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.450266
  Batch 10: Grad norm before clip = 1.425103
  Batch 20: Grad norm before clip = 2.270261
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 1.434508, Cosine Sim: 0.2833, MSE: 1.4345
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 5/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.20s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:20<00:07,  1.40it/s]Training:  63%|██████▎   | 19/30 [00:20<00:07,  1.40it/s]Training:  63%|██████▎   | 19/30 [00:20<00:07,  1.40it/s]Training:  63%|██████▎   | 19/30 [00:20<00:07,  1.40it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.38it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.38it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.38it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.38it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

  Batch 0: Grad norm before clip = 3.891901
  Batch 10: Grad norm before clip = 2.781390
  Batch 20: Grad norm before clip = 3.136888
  Batch 0: Grad norm before clip = 3.891901
  Batch 10: Grad norm before clip = 2.781390
  Batch 20: Grad norm before clip = 3.136888
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.891901
  Batch 10: Grad norm before clip = 2.781390
  Batch 20: Grad norm before clip = 3.136888
  Batch 0: Grad norm before clip = 3.891901
  Batch 10: Grad norm before clip = 2.781390
  Batch 20: Grad norm before clip = 3.136888
Train Loss: 1.359364, Cosine Sim: 0.2680
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.445817, Cosine Sim: 0.2896, MSE: 1.4458
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_5.pt

Epoch 6/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.574715
  Batch 10: Grad norm before clip = 3.661412
  Batch 20: Grad norm before clip = 6.614951

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.574715
  Batch 10: Grad norm before clip = 3.661412
  Batch 20: Grad norm before clip = 6.614951
Train Loss: 1.349713, Cosine Sim: 0.3002
  Batch 0: Grad norm before clip = 4.574715
  Batch 10: Grad norm before clip = 3.661412
  Batch 20: Grad norm before clip = 6.614951
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.574715
  Batch 10: Grad norm before clip = 3.661412
  Batch 20: Grad norm before clip = 6.614951
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.359405, Cosine Sim: 0.3103, MSE: 1.3594
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 7/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 6.725044
  Batch 10: Grad norm before clip = 3.165726
  Batch 20: Grad norm before clip = 7.618861

  Batch 0: Grad norm before clip = 6.725044
  Batch 10: Grad norm before clip = 3.165726
  Batch 20: Grad norm before clip = 7.618861
  Batch 0: Grad norm before clip = 6.725044
  Batch 10: Grad norm before clip = 3.165726
  Batch 20: Grad norm before clip = 7.618861
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.725044
  Batch 10: Grad norm before clip = 3.165726
  Batch 20: Grad norm before clip = 7.618861
Train Loss: 1.298351, Cosine Sim: 0.2876
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 1.348671, Cosine Sim: 0.3197, MSE: 1.3487
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 8/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 5.915808
  Batch 10: Grad norm before clip = 10.134308
  Batch 20: Grad norm before clip = 5.008289
Train Loss: 1.204354, Cosine Sim: 0.3499

  Batch 0: Grad norm before clip = 5.915808
  Batch 10: Grad norm before clip = 10.134308
  Batch 20: Grad norm before clip = 5.008289
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.915808
  Batch 10: Grad norm before clip = 10.134308
  Batch 20: Grad norm before clip = 5.008289
  Batch 0: Grad norm before clip = 5.915808
  Batch 10: Grad norm before clip = 10.134308
  Batch 20: Grad norm before clip = 5.008289
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 1.289158, Cosine Sim: 0.3668, MSE: 1.2892
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 9/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 8.020522
  Batch 10: Grad norm before clip = 5.704724
  Batch 20: Grad norm before clip = 5.137059

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 8.020522
  Batch 10: Grad norm before clip = 5.704724
  Batch 20: Grad norm before clip = 5.137059
  Batch 0: Grad norm before clip = 8.020522
  Batch 10: Grad norm before clip = 5.704724
  Batch 20: Grad norm before clip = 5.137059
Train Loss: 1.104948, Cosine Sim: 0.3875
  Batch 0: Grad norm before clip = 8.020522
  Batch 10: Grad norm before clip = 5.704724
  Batch 20: Grad norm before clip = 5.137059
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 1.191591, Cosine Sim: 0.4009, MSE: 1.1916
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 10/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 11.138070
  Batch 10: Grad norm before clip = 5.355701
  Batch 20: Grad norm before clip = 4.826721

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 11.138070
  Batch 10: Grad norm before clip = 5.355701
  Batch 20: Grad norm before clip = 4.826721
  Batch 0: Grad norm before clip = 11.138070
  Batch 10: Grad norm before clip = 5.355701
  Batch 20: Grad norm before clip = 4.826721
Train Loss: 1.035790, Cosine Sim: 0.4423
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 11.138070
  Batch 10: Grad norm before clip = 5.355701
  Batch 20: Grad norm before clip = 4.826721
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.143865, Cosine Sim: 0.4349, MSE: 1.1439
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_10.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 11/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.11it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.11it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.11it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.11it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:11,  1.08it/s]Training:  60%|██████    | 18/30 [00:19<00:11,  1.08it/s]Training:  60%|██████    | 18/30 [00:19<00:11,  1.08it/s]Training:  60%|██████    | 18/30 [00:19<00:11,  1.08it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.13it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.13it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.13it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.13it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.11it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.11it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.11it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.09it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 7.955472
  Batch 10: Grad norm before clip = 6.800122
  Batch 20: Grad norm before clip = 6.043317

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.955472
  Batch 10: Grad norm before clip = 6.800122
  Batch 20: Grad norm before clip = 6.043317
Train Loss: 0.938861, Cosine Sim: 0.4758
  Batch 0: Grad norm before clip = 7.955472
  Batch 10: Grad norm before clip = 6.800122
  Batch 20: Grad norm before clip = 6.043317
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.955472
  Batch 10: Grad norm before clip = 6.800122
  Batch 20: Grad norm before clip = 6.043317
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.222588, Cosine Sim: 0.4041, MSE: 1.2226
Learning Rate: 2.00e-04

Epoch 12/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.37it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.37it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.37it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.38it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 6.340174
  Batch 10: Grad norm before clip = 3.334606
  Batch 20: Grad norm before clip = 8.005390

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.340174
  Batch 10: Grad norm before clip = 3.334606
  Batch 20: Grad norm before clip = 8.005390
  Batch 0: Grad norm before clip = 6.340174
  Batch 10: Grad norm before clip = 3.334606
  Batch 20: Grad norm before clip = 8.005390
Train Loss: 0.997130, Cosine Sim: 0.4534
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.340174
  Batch 10: Grad norm before clip = 3.334606
  Batch 20: Grad norm before clip = 8.005390
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 1.185188, Cosine Sim: 0.4188, MSE: 1.1852
Learning Rate: 2.00e-04

Epoch 13/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]

  Batch 0: Grad norm before clip = 4.855674
  Batch 10: Grad norm before clip = 6.042817
  Batch 20: Grad norm before clip = 5.355989
Train Loss: 0.917253, Cosine Sim: 0.4969
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.855674
  Batch 10: Grad norm before clip = 6.042817
  Batch 20: Grad norm before clip = 5.355989
  Batch 0: Grad norm before clip = 4.855674
  Batch 10: Grad norm before clip = 6.042817
  Batch 20: Grad norm before clip = 5.355989
  Batch 0: Grad norm before clip = 4.855674
  Batch 10: Grad norm before clip = 6.042817
  Batch 20: Grad norm before clip = 5.355989
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.103682, Cosine Sim: 0.4582, MSE: 1.1037
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 14/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.12it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 4.865006
  Batch 10: Grad norm before clip = 9.972341
  Batch 20: Grad norm before clip = 8.351567

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 4.865006
  Batch 10: Grad norm before clip = 9.972341
  Batch 20: Grad norm before clip = 8.351567

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.865006
  Batch 10: Grad norm before clip = 9.972341
  Batch 20: Grad norm before clip = 8.351567
Train Loss: 0.882126, Cosine Sim: 0.5266
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.865006
  Batch 10: Grad norm before clip = 9.972341
  Batch 20: Grad norm before clip = 8.351567
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.32it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 1.051446, Cosine Sim: 0.4758, MSE: 1.0514
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 15/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.638204
  Batch 10: Grad norm before clip = 6.665843
  Batch 20: Grad norm before clip = 12.425571
Train Loss: 0.897887, Cosine Sim: 0.5100

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.638204
  Batch 10: Grad norm before clip = 6.665843
  Batch 20: Grad norm before clip = 12.425571
  Batch 0: Grad norm before clip = 2.638204
  Batch 10: Grad norm before clip = 6.665843
  Batch 20: Grad norm before clip = 12.425571
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.638204
  Batch 10: Grad norm before clip = 6.665843
  Batch 20: Grad norm before clip = 12.425571
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.190232, Cosine Sim: 0.4167, MSE: 1.1902
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_15.pt

Epoch 16/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:46,  5.75s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 10.374473
  Batch 10: Grad norm before clip = 9.999634
  Batch 20: Grad norm before clip = 5.213960
Train Loss: 0.846491, Cosine Sim: 0.5377

  Batch 0: Grad norm before clip = 10.374473
  Batch 10: Grad norm before clip = 9.999634
  Batch 20: Grad norm before clip = 5.213960
  Batch 0: Grad norm before clip = 10.374473
  Batch 10: Grad norm before clip = 9.999634
  Batch 20: Grad norm before clip = 5.213960
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.374473
  Batch 10: Grad norm before clip = 9.999634
  Batch 20: Grad norm before clip = 5.213960
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.057599, Cosine Sim: 0.4645, MSE: 1.0576
Learning Rate: 2.00e-04

Epoch 17/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.35s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 6.828996
  Batch 10: Grad norm before clip = 10.387657
  Batch 20: Grad norm before clip = 14.394428

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.828996
  Batch 10: Grad norm before clip = 10.387657
  Batch 20: Grad norm before clip = 14.394428
  Batch 0: Grad norm before clip = 6.828996
  Batch 10: Grad norm before clip = 10.387657
  Batch 20: Grad norm before clip = 14.394428
  Batch 0: Grad norm before clip = 6.828996
  Batch 10: Grad norm before clip = 10.387657
  Batch 20: Grad norm before clip = 14.394428
Train Loss: 0.775563, Cosine Sim: 0.5788
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 1.040393, Cosine Sim: 0.4830, MSE: 1.0404
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 18/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 8.645783
  Batch 10: Grad norm before clip = 10.292527
  Batch 20: Grad norm before clip = 6.850474

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 8.645783
  Batch 10: Grad norm before clip = 10.292527
  Batch 20: Grad norm before clip = 6.850474
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 8.645783
  Batch 10: Grad norm before clip = 10.292527
  Batch 20: Grad norm before clip = 6.850474
  Batch 0: Grad norm before clip = 8.645783
  Batch 10: Grad norm before clip = 10.292527
  Batch 20: Grad norm before clip = 6.850474
Train Loss: 0.897202, Cosine Sim: 0.5143
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 1.016356, Cosine Sim: 0.4944, MSE: 1.0164
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 19/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 17.065543
  Batch 10: Grad norm before clip = 6.064915
  Batch 20: Grad norm before clip = 7.677350

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 17.065543
  Batch 10: Grad norm before clip = 6.064915
  Batch 20: Grad norm before clip = 7.677350
Train Loss: 0.840850, Cosine Sim: 0.5581
  Batch 0: Grad norm before clip = 17.065543
  Batch 10: Grad norm before clip = 6.064915
  Batch 20: Grad norm before clip = 7.677350
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 17.065543
  Batch 10: Grad norm before clip = 6.064915
  Batch 20: Grad norm before clip = 7.677350
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.086665, Cosine Sim: 0.4473, MSE: 1.0867
Learning Rate: 2.00e-04

Epoch 20/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.18it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 7.710435
  Batch 10: Grad norm before clip = 5.725038
  Batch 20: Grad norm before clip = 9.445702
Train Loss: 0.770860, Cosine Sim: 0.5790

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.710435
  Batch 10: Grad norm before clip = 5.725038
  Batch 20: Grad norm before clip = 9.445702
  Batch 0: Grad norm before clip = 7.710435
  Batch 10: Grad norm before clip = 5.725038
  Batch 20: Grad norm before clip = 9.445702
  Batch 0: Grad norm before clip = 7.710435
  Batch 10: Grad norm before clip = 5.725038
  Batch 20: Grad norm before clip = 9.445702
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 1.070524, Cosine Sim: 0.4594, MSE: 1.0705
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_20.pt

Epoch 21/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 5.343552
  Batch 10: Grad norm before clip = 8.795217
  Batch 20: Grad norm before clip = 4.271028
Train Loss: 0.794819, Cosine Sim: 0.5559
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.343552
  Batch 10: Grad norm before clip = 8.795217
  Batch 20: Grad norm before clip = 4.271028
  Batch 0: Grad norm before clip = 5.343552
  Batch 10: Grad norm before clip = 8.795217
  Batch 20: Grad norm before clip = 4.271028
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.343552
  Batch 10: Grad norm before clip = 8.795217
  Batch 20: Grad norm before clip = 4.271028
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.022252, Cosine Sim: 0.4864, MSE: 1.0223
Learning Rate: 2.00e-04

Epoch 22/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 6.000761
  Batch 10: Grad norm before clip = 6.452241
  Batch 20: Grad norm before clip = 5.271180

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.000761
  Batch 10: Grad norm before clip = 6.452241
  Batch 20: Grad norm before clip = 5.271180
  Batch 0: Grad norm before clip = 6.000761
  Batch 10: Grad norm before clip = 6.452241
  Batch 20: Grad norm before clip = 5.271180
Train Loss: 0.784269, Cosine Sim: 0.5653
  Batch 0: Grad norm before clip = 6.000761
  Batch 10: Grad norm before clip = 6.452241
  Batch 20: Grad norm before clip = 5.271180
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.32it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.122926, Cosine Sim: 0.4452, MSE: 1.1229
Learning Rate: 2.00e-04

Epoch 23/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 9.561291
  Batch 10: Grad norm before clip = 5.359942
  Batch 20: Grad norm before clip = 12.035789


Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.561291
  Batch 10: Grad norm before clip = 5.359942
  Batch 20: Grad norm before clip = 12.035789
  Batch 0: Grad norm before clip = 9.561291
  Batch 10: Grad norm before clip = 5.359942
  Batch 20: Grad norm before clip = 12.035789
  Batch 0: Grad norm before clip = 9.561291
  Batch 10: Grad norm before clip = 5.359942
  Batch 20: Grad norm before clip = 12.035789
Train Loss: 0.679037, Cosine Sim: 0.6093
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Val Loss: 0.942039, Cosine Sim: 0.5336, MSE: 0.9420
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 24/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.66s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.09it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.09it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.09it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.09it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]

  Batch 0: Grad norm before clip = 4.638403
  Batch 10: Grad norm before clip = 3.617065
  Batch 20: Grad norm before clip = 12.785713
  Batch 0: Grad norm before clip = 4.638403
  Batch 10: Grad norm before clip = 3.617065
  Batch 20: Grad norm before clip = 12.785713
  Batch 0: Grad norm before clip = 4.638403
  Batch 10: Grad norm before clip = 3.617065
  Batch 20: Grad norm before clip = 12.785713
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.638403
  Batch 10: Grad norm before clip = 3.617065
  Batch 20: Grad norm before clip = 12.785713
Train Loss: 0.700061, Cosine Sim: 0.6112
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.900501, Cosine Sim: 0.5499, MSE: 0.9005
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 25/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 4.487520
  Batch 10: Grad norm before clip = 4.035663
  Batch 20: Grad norm before clip = 5.174079

  Batch 0: Grad norm before clip = 4.487520
  Batch 10: Grad norm before clip = 4.035663
  Batch 20: Grad norm before clip = 5.174079
Train Loss: 0.682488, Cosine Sim: 0.6087
  Batch 0: Grad norm before clip = 4.487520
  Batch 10: Grad norm before clip = 4.035663
  Batch 20: Grad norm before clip = 5.174079
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.487520
  Batch 10: Grad norm before clip = 4.035663
  Batch 20: Grad norm before clip = 5.174079
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.973731, Cosine Sim: 0.5094, MSE: 0.9737
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_25.pt

Epoch 26/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 3.569327
  Batch 10: Grad norm before clip = 2.257400
  Batch 20: Grad norm before clip = 2.647833
Train Loss: 0.712015, Cosine Sim: 0.6204
  Batch 0: Grad norm before clip = 3.569327
  Batch 10: Grad norm before clip = 2.257400
  Batch 20: Grad norm before clip = 2.647833
  Batch 0: Grad norm before clip = 3.569327
  Batch 10: Grad norm before clip = 2.257400
  Batch 20: Grad norm before clip = 2.647833
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.569327
  Batch 10: Grad norm before clip = 2.257400
  Batch 20: Grad norm before clip = 2.647833
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.983882, Cosine Sim: 0.4952, MSE: 0.9839
Learning Rate: 2.00e-04

Epoch 27/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.13it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 6.210336
  Batch 10: Grad norm before clip = 3.477435
  Batch 20: Grad norm before clip = 3.719405
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 6.210336
  Batch 10: Grad norm before clip = 3.477435
  Batch 20: Grad norm before clip = 3.719405
  Batch 0: Grad norm before clip = 6.210336
  Batch 10: Grad norm before clip = 3.477435
  Batch 20: Grad norm before clip = 3.719405
Train Loss: 0.651602, Cosine Sim: 0.6319
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.210336
  Batch 10: Grad norm before clip = 3.477435
  Batch 20: Grad norm before clip = 3.719405
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Val Loss: 0.904138, Cosine Sim: 0.5474, MSE: 0.9041
Learning Rate: 2.00e-04

Epoch 28/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  23%|██▎       | 7/30 [00:09<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:09<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:09<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:09<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.43it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.43it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.43it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
  Batch 0: Grad norm before clip = 5.606568
  Batch 10: Grad norm before clip = 3.861722
  Batch 20: Grad norm before clip = 2.425552

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.606568
  Batch 10: Grad norm before clip = 3.861722
  Batch 20: Grad norm before clip = 2.425552
  Batch 0: Grad norm before clip = 5.606568
  Batch 10: Grad norm before clip = 3.861722
  Batch 20: Grad norm before clip = 2.425552
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.606568
  Batch 10: Grad norm before clip = 3.861722
  Batch 20: Grad norm before clip = 2.425552
Train Loss: 0.684400, Cosine Sim: 0.6208
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.963911, Cosine Sim: 0.5221, MSE: 0.9639
Learning Rate: 2.00e-04

Epoch 29/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 10.288064
  Batch 10: Grad norm before clip = 10.783871
  Batch 20: Grad norm before clip = 5.376517

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 10.288064
  Batch 10: Grad norm before clip = 10.783871
  Batch 20: Grad norm before clip = 5.376517
Train Loss: 0.645539, Cosine Sim: 0.6461
  Batch 0: Grad norm before clip = 10.288064
  Batch 10: Grad norm before clip = 10.783871
  Batch 20: Grad norm before clip = 5.376517
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.288064
  Batch 10: Grad norm before clip = 10.783871
  Batch 20: Grad norm before clip = 5.376517
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.044323, Cosine Sim: 0.4811, MSE: 1.0443
Learning Rate: 2.00e-04

Epoch 30/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 11.960973
  Batch 10: Grad norm before clip = 4.728994
  Batch 20: Grad norm before clip = 7.525984


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 11.960973
  Batch 10: Grad norm before clip = 4.728994
  Batch 20: Grad norm before clip = 7.525984
  Batch 0: Grad norm before clip = 11.960973
  Batch 10: Grad norm before clip = 4.728994
  Batch 20: Grad norm before clip = 7.525984
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 11.960973
  Batch 10: Grad norm before clip = 4.728994
  Batch 20: Grad norm before clip = 7.525984
Train Loss: 0.658393, Cosine Sim: 0.6337
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.993362, Cosine Sim: 0.4858, MSE: 0.9934
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_30.pt

Epoch 31/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

  Batch 0: Grad norm before clip = 6.715772
  Batch 10: Grad norm before clip = 4.983684
  Batch 20: Grad norm before clip = 4.965698
Train Loss: 0.598156, Cosine Sim: 0.6774
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 6.715772
  Batch 10: Grad norm before clip = 4.983684
  Batch 20: Grad norm before clip = 4.965698
  Batch 0: Grad norm before clip = 6.715772
  Batch 10: Grad norm before clip = 4.983684
  Batch 20: Grad norm before clip = 4.965698
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.715772
  Batch 10: Grad norm before clip = 4.983684
  Batch 20: Grad norm before clip = 4.965698
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.918826, Cosine Sim: 0.5355, MSE: 0.9188
Learning Rate: 1.00e-04

Epoch 32/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.07s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 3.376185
  Batch 10: Grad norm before clip = 4.778257
  Batch 20: Grad norm before clip = 3.863211

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.376185
  Batch 10: Grad norm before clip = 4.778257
  Batch 20: Grad norm before clip = 3.863211
  Batch 0: Grad norm before clip = 3.376185
  Batch 10: Grad norm before clip = 4.778257
  Batch 20: Grad norm before clip = 3.863211
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.376185
  Batch 10: Grad norm before clip = 4.778257
  Batch 20: Grad norm before clip = 3.863211
Train Loss: 0.634926, Cosine Sim: 0.6543
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.945706, Cosine Sim: 0.5095, MSE: 0.9457
Learning Rate: 1.00e-04

Epoch 33/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 6.094560
  Batch 10: Grad norm before clip = 3.786315
  Batch 20: Grad norm before clip = 9.715720
Train Loss: 0.645446, Cosine Sim: 0.6531

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.094560
  Batch 10: Grad norm before clip = 3.786315
  Batch 20: Grad norm before clip = 9.715720
  Batch 0: Grad norm before clip = 6.094560
  Batch 10: Grad norm before clip = 3.786315
  Batch 20: Grad norm before clip = 9.715720
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.094560
  Batch 10: Grad norm before clip = 3.786315
  Batch 20: Grad norm before clip = 9.715720
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.931579, Cosine Sim: 0.5217, MSE: 0.9316
Learning Rate: 1.00e-04

Epoch 34/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  30%|███       | 9/30 [00:12<00:19,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.36it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.36it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.36it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.36it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 6.890442
  Batch 10: Grad norm before clip = 3.752363
  Batch 20: Grad norm before clip = 5.541090

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 6.890442
  Batch 10: Grad norm before clip = 3.752363
  Batch 20: Grad norm before clip = 5.541090
  Batch 0: Grad norm before clip = 6.890442
  Batch 10: Grad norm before clip = 3.752363
  Batch 20: Grad norm before clip = 5.541090
Train Loss: 0.557062, Cosine Sim: 0.6844
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.890442
  Batch 10: Grad norm before clip = 3.752363
  Batch 20: Grad norm before clip = 5.541090
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.07s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.08s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.24it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.64s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.66s/it]
Val Loss: 0.896927, Cosine Sim: 0.5412, MSE: 0.8969
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 35/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   7%|▋         | 2/30 [00:06<01:23,  3.00s/it]Training:   7%|▋         | 2/30 [00:06<01:23,  2.99s/it]Training:   7%|▋         | 2/30 [00:06<01:23,  3.00s/it]Training:   7%|▋         | 2/30 [00:06<01:23,  3.00s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.96s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.849125
  Batch 10: Grad norm before clip = 5.808169
  Batch 20: Grad norm before clip = 4.236069
Train Loss: 0.609654, Cosine Sim: 0.6700

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.849125
  Batch 10: Grad norm before clip = 5.808169
  Batch 20: Grad norm before clip = 4.236069
  Batch 0: Grad norm before clip = 3.849125
  Batch 10: Grad norm before clip = 5.808169
  Batch 20: Grad norm before clip = 4.236069
  Batch 0: Grad norm before clip = 3.849125
  Batch 10: Grad norm before clip = 5.808169
  Batch 20: Grad norm before clip = 4.236069
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.879701, Cosine Sim: 0.5602, MSE: 0.8797
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_35.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 36/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.26it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.25it/s]Training:  37%|███▋      | 11/30 [00:12<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:12<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:12<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:12<00:15,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.30it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.30it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.30it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:17<00:11,  1.18it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 7.732839
  Batch 10: Grad norm before clip = 10.027671
  Batch 20: Grad norm before clip = 4.892240

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.732839
  Batch 10: Grad norm before clip = 10.027671
  Batch 20: Grad norm before clip = 4.892240
  Batch 0: Grad norm before clip = 7.732839
  Batch 10: Grad norm before clip = 10.027671
  Batch 20: Grad norm before clip = 4.892240
  Batch 0: Grad norm before clip = 7.732839
  Batch 10: Grad norm before clip = 10.027671
  Batch 20: Grad norm before clip = 4.892240
Train Loss: 0.571653, Cosine Sim: 0.7001
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.857933, Cosine Sim: 0.5691, MSE: 0.8579
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 37/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.66s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.54s/it]Training:  13%|█▎        | 4/30 [00:08<00:40,  1.54s/it]Training:  13%|█▎        | 4/30 [00:08<00:40,  1.54s/it]Training:  13%|█▎        | 4/30 [00:08<00:40,  1.54s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.15it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.15it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.15it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 3.739142
  Batch 10: Grad norm before clip = 6.474478
  Batch 20: Grad norm before clip = 3.234802

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.739142
  Batch 10: Grad norm before clip = 6.474478
  Batch 20: Grad norm before clip = 3.234802
  Batch 0: Grad norm before clip = 3.739142
  Batch 10: Grad norm before clip = 6.474478
  Batch 20: Grad norm before clip = 3.234802

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.739142
  Batch 10: Grad norm before clip = 6.474478
  Batch 20: Grad norm before clip = 3.234802
Train Loss: 0.656574, Cosine Sim: 0.6504
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.03s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.03s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.14s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]

Val Loss: 0.848191, Cosine Sim: 0.5746, MSE: 0.8482
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 38/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 4.116128
  Batch 10: Grad norm before clip = 5.085768
  Batch 20: Grad norm before clip = 8.119922

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.116128
  Batch 10: Grad norm before clip = 5.085768
  Batch 20: Grad norm before clip = 8.119922
Train Loss: 0.554867, Cosine Sim: 0.7026
  Batch 0: Grad norm before clip = 4.116128
  Batch 10: Grad norm before clip = 5.085768
  Batch 20: Grad norm before clip = 8.119922
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.116128
  Batch 10: Grad norm before clip = 5.085768
  Batch 20: Grad norm before clip = 8.119922
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.840552, Cosine Sim: 0.5739, MSE: 0.8406
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 39/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 4.763677
  Batch 10: Grad norm before clip = 5.465158
  Batch 20: Grad norm before clip = 2.942850

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.763677
  Batch 10: Grad norm before clip = 5.465158
  Batch 20: Grad norm before clip = 2.942850
Train Loss: 0.591911, Cosine Sim: 0.6883
  Batch 0: Grad norm before clip = 4.763677
  Batch 10: Grad norm before clip = 5.465158
  Batch 20: Grad norm before clip = 2.942850
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.763677
  Batch 10: Grad norm before clip = 5.465158
  Batch 20: Grad norm before clip = 2.942850
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  5.00s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.04s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.04s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Val Loss: 0.825403, Cosine Sim: 0.5874, MSE: 0.8254
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 40/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 7.293741
  Batch 10: Grad norm before clip = 3.468652
  Batch 20: Grad norm before clip = 4.831058

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.293741
  Batch 10: Grad norm before clip = 3.468652
  Batch 20: Grad norm before clip = 4.831058

  Batch 0: Grad norm before clip = 7.293741
  Batch 10: Grad norm before clip = 3.468652
  Batch 20: Grad norm before clip = 4.831058
Train Loss: 0.488007, Cosine Sim: 0.7200
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.293741
  Batch 10: Grad norm before clip = 3.468652
  Batch 20: Grad norm before clip = 4.831058
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.03s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.00s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.04s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.32it/s]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Val Loss: 0.879136, Cosine Sim: 0.5499, MSE: 0.8791
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_40.pt

Epoch 41/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 3.186594
  Batch 10: Grad norm before clip = 4.141447
  Batch 20: Grad norm before clip = 2.691104


  Batch 0: Grad norm before clip = 3.186594
  Batch 10: Grad norm before clip = 4.141447
  Batch 20: Grad norm before clip = 2.691104
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.186594
  Batch 10: Grad norm before clip = 4.141447
  Batch 20: Grad norm before clip = 2.691104
Train Loss: 0.548776, Cosine Sim: 0.6896
  Batch 0: Grad norm before clip = 3.186594
  Batch 10: Grad norm before clip = 4.141447
  Batch 20: Grad norm before clip = 2.691104
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.815042, Cosine Sim: 0.6007, MSE: 0.8150
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 42/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.13it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:14,  1.12it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 7.161974
  Batch 10: Grad norm before clip = 4.447345
  Batch 20: Grad norm before clip = 3.841256

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 7.161974
  Batch 10: Grad norm before clip = 4.447345
  Batch 20: Grad norm before clip = 3.841256
Train Loss: 0.530552, Cosine Sim: 0.7061
  Batch 0: Grad norm before clip = 7.161974
  Batch 10: Grad norm before clip = 4.447345
  Batch 20: Grad norm before clip = 3.841256
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.161974
  Batch 10: Grad norm before clip = 4.447345
  Batch 20: Grad norm before clip = 3.841256
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.863202, Cosine Sim: 0.5592, MSE: 0.8632
Learning Rate: 1.00e-04

Epoch 43/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 7.423411
  Batch 10: Grad norm before clip = 4.583516
  Batch 20: Grad norm before clip = 4.593717
Train Loss: 0.565184, Cosine Sim: 0.7024

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.423411
  Batch 10: Grad norm before clip = 4.583516
  Batch 20: Grad norm before clip = 4.593717
  Batch 0: Grad norm before clip = 7.423411
  Batch 10: Grad norm before clip = 4.583516
  Batch 20: Grad norm before clip = 4.593717
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.423411
  Batch 10: Grad norm before clip = 4.583516
  Batch 20: Grad norm before clip = 4.593717
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.857220, Cosine Sim: 0.5623, MSE: 0.8572
Learning Rate: 1.00e-04

Epoch 44/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.773875
  Batch 10: Grad norm before clip = 3.451429
  Batch 20: Grad norm before clip = 5.220006

  Batch 0: Grad norm before clip = 4.773875
  Batch 10: Grad norm before clip = 3.451429
  Batch 20: Grad norm before clip = 5.220006
Train Loss: 0.506406, Cosine Sim: 0.7235
  Batch 0: Grad norm before clip = 4.773875
  Batch 10: Grad norm before clip = 3.451429
  Batch 20: Grad norm before clip = 5.220006
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.773875
  Batch 10: Grad norm before clip = 3.451429
  Batch 20: Grad norm before clip = 5.220006
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.865307, Cosine Sim: 0.5551, MSE: 0.8653
Learning Rate: 1.00e-04

Epoch 45/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.66s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.98s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.98s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.98s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.98s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.39it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.39it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.39it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.39it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 6.583377
  Batch 10: Grad norm before clip = 4.625352
  Batch 20: Grad norm before clip = 6.820943

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.583377
  Batch 10: Grad norm before clip = 4.625352
  Batch 20: Grad norm before clip = 6.820943
  Batch 0: Grad norm before clip = 6.583377
  Batch 10: Grad norm before clip = 4.625352
  Batch 20: Grad norm before clip = 6.820943
Train Loss: 0.538575, Cosine Sim: 0.7017
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.583377
  Batch 10: Grad norm before clip = 4.625352
  Batch 20: Grad norm before clip = 6.820943
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Val Loss: 0.824332, Cosine Sim: 0.5899, MSE: 0.8243
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_45.pt

Epoch 46/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.38s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 4.390522
  Batch 10: Grad norm before clip = 6.759580
  Batch 20: Grad norm before clip = 4.216520
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

  Batch 0: Grad norm before clip = 4.390522
  Batch 10: Grad norm before clip = 6.759580
  Batch 20: Grad norm before clip = 4.216520
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.390522
  Batch 10: Grad norm before clip = 6.759580
  Batch 20: Grad norm before clip = 4.216520
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.390522
  Batch 10: Grad norm before clip = 6.759580
  Batch 20: Grad norm before clip = 4.216520
Train Loss: 0.542588, Cosine Sim: 0.7119
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.71s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.02s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.33it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.855124, Cosine Sim: 0.5668, MSE: 0.8551
Learning Rate: 1.00e-04

Epoch 47/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.10it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.10it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.10it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 2.451414
  Batch 10: Grad norm before clip = 3.706515
  Batch 20: Grad norm before clip = 3.375398
Train Loss: 0.497783, Cosine Sim: 0.7254
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.451414
  Batch 10: Grad norm before clip = 3.706515
  Batch 20: Grad norm before clip = 3.375398
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.451414
  Batch 10: Grad norm before clip = 3.706515
  Batch 20: Grad norm before clip = 3.375398
  Batch 0: Grad norm before clip = 2.451414
  Batch 10: Grad norm before clip = 3.706515
  Batch 20: Grad norm before clip = 3.375398
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.861528, Cosine Sim: 0.5546, MSE: 0.8615
Learning Rate: 5.00e-05

Epoch 48/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

  Batch 0: Grad norm before clip = 7.103945
  Batch 10: Grad norm before clip = 5.167813
  Batch 20: Grad norm before clip = 4.652076
  Batch 0: Grad norm before clip = 7.103945
  Batch 10: Grad norm before clip = 5.167813
  Batch 20: Grad norm before clip = 4.652076
Train Loss: 0.528315, Cosine Sim: 0.7039
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.103945
  Batch 10: Grad norm before clip = 5.167813
  Batch 20: Grad norm before clip = 4.652076
  Batch 0: Grad norm before clip = 7.103945
  Batch 10: Grad norm before clip = 5.167813
  Batch 20: Grad norm before clip = 4.652076
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.823572, Cosine Sim: 0.5811, MSE: 0.8236
Learning Rate: 5.00e-05

Epoch 49/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:33,  5.30s/it]Training:   3%|▎         | 1/30 [00:05<02:33,  5.30s/it]Training:   3%|▎         | 1/30 [00:05<02:33,  5.30s/it]Training:   3%|▎         | 1/30 [00:05<02:33,  5.30s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 3.618528
  Batch 10: Grad norm before clip = 9.183886
  Batch 20: Grad norm before clip = 2.823782

  Batch 0: Grad norm before clip = 3.618528
  Batch 10: Grad norm before clip = 9.183886
  Batch 20: Grad norm before clip = 2.823782
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.618528
  Batch 10: Grad norm before clip = 9.183886
  Batch 20: Grad norm before clip = 2.823782
  Batch 0: Grad norm before clip = 3.618528
  Batch 10: Grad norm before clip = 9.183886
  Batch 20: Grad norm before clip = 2.823782
Train Loss: 0.491576, Cosine Sim: 0.7364
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 0.816479, Cosine Sim: 0.5841, MSE: 0.8165
Learning Rate: 5.00e-05

Epoch 50/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   7%|▋         | 2/30 [00:05<01:12,  2.58s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.59s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.59s/it]Training:   7%|▋         | 2/30 [00:05<01:12,  2.58s/it]Training:  10%|█         | 3/30 [00:06<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:06<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:06<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:06<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.12it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.12it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.12it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.12it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 5.919848
  Batch 10: Grad norm before clip = 3.083287
  Batch 20: Grad norm before clip = 6.174772
Train Loss: 0.508393, Cosine Sim: 0.7081

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.919848
  Batch 10: Grad norm before clip = 3.083287
  Batch 20: Grad norm before clip = 6.174772
  Batch 0: Grad norm before clip = 5.919848
  Batch 10: Grad norm before clip = 3.083287
  Batch 20: Grad norm before clip = 6.174772
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.919848
  Batch 10: Grad norm before clip = 3.083287
  Batch 20: Grad norm before clip = 6.174772
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.834045, Cosine Sim: 0.5730, MSE: 0.8340
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_50.pt

Epoch 51/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 3.849252
  Batch 10: Grad norm before clip = 4.222793
  Batch 20: Grad norm before clip = 5.763338

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.849252
  Batch 10: Grad norm before clip = 4.222793
  Batch 20: Grad norm before clip = 5.763338
  Batch 0: Grad norm before clip = 3.849252
  Batch 10: Grad norm before clip = 4.222793
  Batch 20: Grad norm before clip = 5.763338
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.849252
  Batch 10: Grad norm before clip = 4.222793
  Batch 20: Grad norm before clip = 5.763338
Train Loss: 0.462611, Cosine Sim: 0.7499
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.822937, Cosine Sim: 0.5804, MSE: 0.8229
Learning Rate: 5.00e-05

Epoch 52/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.912153
  Batch 10: Grad norm before clip = 3.876298
  Batch 20: Grad norm before clip = 2.381749

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.912153
  Batch 10: Grad norm before clip = 3.876298
  Batch 20: Grad norm before clip = 2.381749
  Batch 0: Grad norm before clip = 2.912153
  Batch 10: Grad norm before clip = 3.876298
  Batch 20: Grad norm before clip = 2.381749
Train Loss: 0.477908, Cosine Sim: 0.7406
  Batch 0: Grad norm before clip = 2.912153
  Batch 10: Grad norm before clip = 3.876298
  Batch 20: Grad norm before clip = 2.381749
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.784578, Cosine Sim: 0.6029, MSE: 0.7846
Learning Rate: 5.00e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 53/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]  Batch 0: Grad norm before clip = 5.038185
  Batch 10: Grad norm before clip = 4.829104
  Batch 20: Grad norm before clip = 4.739997
Train Loss: 0.448896, Cosine Sim: 0.7390

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.038185
  Batch 10: Grad norm before clip = 4.829104
  Batch 20: Grad norm before clip = 4.739997
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.038185
  Batch 10: Grad norm before clip = 4.829104
  Batch 20: Grad norm before clip = 4.739997
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.038185
  Batch 10: Grad norm before clip = 4.829104
  Batch 20: Grad norm before clip = 4.739997
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.807698, Cosine Sim: 0.5872, MSE: 0.8077
Learning Rate: 5.00e-05

Epoch 54/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.11it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.11it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.11it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.11it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.501183
  Batch 10: Grad norm before clip = 7.388337
  Batch 20: Grad norm before clip = 2.449795

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.501183
  Batch 10: Grad norm before clip = 7.388337
  Batch 20: Grad norm before clip = 2.449795
Train Loss: 0.462866, Cosine Sim: 0.7400
  Batch 0: Grad norm before clip = 2.501183
  Batch 10: Grad norm before clip = 7.388337
  Batch 20: Grad norm before clip = 2.449795
  Batch 0: Grad norm before clip = 2.501183
  Batch 10: Grad norm before clip = 7.388337
  Batch 20: Grad norm before clip = 2.449795
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.806476, Cosine Sim: 0.5888, MSE: 0.8065
Learning Rate: 5.00e-05

Epoch 55/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.204405
  Batch 10: Grad norm before clip = 3.153198
  Batch 20: Grad norm before clip = 3.576279

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.204405
  Batch 10: Grad norm before clip = 3.153198
  Batch 20: Grad norm before clip = 3.576279
Train Loss: 0.425717, Cosine Sim: 0.7725
  Batch 0: Grad norm before clip = 3.204405
  Batch 10: Grad norm before clip = 3.153198
  Batch 20: Grad norm before clip = 3.576279
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.204405
  Batch 10: Grad norm before clip = 3.153198
  Batch 20: Grad norm before clip = 3.576279
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 0.789656, Cosine Sim: 0.6008, MSE: 0.7897
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_55.pt

Epoch 56/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:09<00:37,  1.52s/it]Training:  17%|█▋        | 5/30 [00:09<00:37,  1.52s/it]Training:  17%|█▋        | 5/30 [00:09<00:37,  1.52s/it]Training:  17%|█▋        | 5/30 [00:09<00:37,  1.52s/it]Training:  20%|██        | 6/30 [00:10<00:30,  1.26s/it]Training:  20%|██        | 6/30 [00:10<00:30,  1.26s/it]Training:  20%|██        | 6/30 [00:10<00:30,  1.26s/it]Training:  20%|██        | 6/30 [00:10<00:30,  1.26s/it]Training:  23%|██▎       | 7/30 [00:11<00:24,  1.08s/it]Training:  23%|██▎       | 7/30 [00:11<00:24,  1.08s/it]Training:  23%|██▎       | 7/30 [00:11<00:24,  1.08s/it]Training:  23%|██▎       | 7/30 [00:11<00:24,  1.08s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.07it/s]Training:  43%|████▎     | 13/30 [00:16<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:16<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:16<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:16<00:14,  1.14it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:25<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:25<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:25<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:25<00:05,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:26<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:26<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:26<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:26<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:29<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:29<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:29<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:29<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:31<00:00,  1.03s/it]
Training: 100%|██████████| 30/30 [00:31<00:00,  1.03s/it]  Batch 0: Grad norm before clip = 2.519154
  Batch 10: Grad norm before clip = 3.495765
  Batch 20: Grad norm before clip = 3.042510

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:31<00:00,  1.03s/it]
  Batch 0: Grad norm before clip = 2.519154
  Batch 10: Grad norm before clip = 3.495765
  Batch 20: Grad norm before clip = 3.042510
  Batch 0: Grad norm before clip = 2.519154
  Batch 10: Grad norm before clip = 3.495765
  Batch 20: Grad norm before clip = 3.042510
Train Loss: 0.497728, Cosine Sim: 0.7292
Training: 100%|██████████| 30/30 [00:31<00:00,  1.03s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.519154
  Batch 10: Grad norm before clip = 3.495765
  Batch 20: Grad norm before clip = 3.042510
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.776481, Cosine Sim: 0.6050, MSE: 0.7765
Learning Rate: 5.00e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 57/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.830146
  Batch 10: Grad norm before clip = 1.818962
  Batch 20: Grad norm before clip = 3.554420

  Batch 0: Grad norm before clip = 2.830146
  Batch 10: Grad norm before clip = 1.818962
  Batch 20: Grad norm before clip = 3.554420
  Batch 0: Grad norm before clip = 2.830146
  Batch 10: Grad norm before clip = 1.818962
  Batch 20: Grad norm before clip = 3.554420
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.830146
  Batch 10: Grad norm before clip = 1.818962
  Batch 20: Grad norm before clip = 3.554420
Train Loss: 0.449779, Cosine Sim: 0.7517
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.821343, Cosine Sim: 0.5815, MSE: 0.8213
Learning Rate: 5.00e-05

Epoch 58/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.38it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.38it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.38it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.38it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.16it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 4.069927
  Batch 10: Grad norm before clip = 5.448769
  Batch 20: Grad norm before clip = 4.934888

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.069927
  Batch 10: Grad norm before clip = 5.448769
  Batch 20: Grad norm before clip = 4.934888
  Batch 0: Grad norm before clip = 4.069927
  Batch 10: Grad norm before clip = 5.448769
  Batch 20: Grad norm before clip = 4.934888
Train Loss: 0.443688, Cosine Sim: 0.7618
  Batch 0: Grad norm before clip = 4.069927
  Batch 10: Grad norm before clip = 5.448769
  Batch 20: Grad norm before clip = 4.934888
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.749565, Cosine Sim: 0.6271, MSE: 0.7496
Learning Rate: 5.00e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 59/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 6.568977
  Batch 10: Grad norm before clip = 7.781736
  Batch 20: Grad norm before clip = 5.196693

  Batch 0: Grad norm before clip = 6.568977
  Batch 10: Grad norm before clip = 7.781736
  Batch 20: Grad norm before clip = 5.196693
  Batch 0: Grad norm before clip = 6.568977
  Batch 10: Grad norm before clip = 7.781736
  Batch 20: Grad norm before clip = 5.196693
Train Loss: 0.494691, Cosine Sim: 0.7358
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.568977
  Batch 10: Grad norm before clip = 7.781736
  Batch 20: Grad norm before clip = 5.196693
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.752423, Cosine Sim: 0.6201, MSE: 0.7524
Learning Rate: 5.00e-05

Epoch 60/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.06it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.06it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.06it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.06it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.10it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 1.932081
  Batch 10: Grad norm before clip = 4.917732
  Batch 20: Grad norm before clip = 3.774480
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.932081
  Batch 10: Grad norm before clip = 4.917732
  Batch 20: Grad norm before clip = 3.774480
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 1.932081
  Batch 10: Grad norm before clip = 4.917732
  Batch 20: Grad norm before clip = 3.774480

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.932081
  Batch 10: Grad norm before clip = 4.917732
  Batch 20: Grad norm before clip = 3.774480
Train Loss: 0.453750, Cosine Sim: 0.7523
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  5.00s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.14s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Val Loss: 0.811627, Cosine Sim: 0.5801, MSE: 0.8116
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_60.pt

Epoch 61/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.11it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.12it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.12it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.12it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.12it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.695007
  Batch 10: Grad norm before clip = 5.912165
  Batch 20: Grad norm before clip = 3.801500

  Batch 0: Grad norm before clip = 4.695007
  Batch 10: Grad norm before clip = 5.912165
  Batch 20: Grad norm before clip = 3.801500
  Batch 0: Grad norm before clip = 4.695007
  Batch 10: Grad norm before clip = 5.912165
  Batch 20: Grad norm before clip = 3.801500
Train Loss: 0.405431, Cosine Sim: 0.7727
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.695007
  Batch 10: Grad norm before clip = 5.912165
  Batch 20: Grad norm before clip = 3.801500
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.731055, Cosine Sim: 0.6384, MSE: 0.7311
Learning Rate: 5.00e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 62/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:29,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:29,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:29,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:29,  1.22s/it]Training:  23%|██▎       | 7/30 [00:10<00:25,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:25,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:25,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:25,  1.09s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 6.615924
  Batch 10: Grad norm before clip = 3.888724
  Batch 20: Grad norm before clip = 4.651431

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 6.615924
  Batch 10: Grad norm before clip = 3.888724
  Batch 20: Grad norm before clip = 4.651431
  Batch 0: Grad norm before clip = 6.615924
  Batch 10: Grad norm before clip = 3.888724
  Batch 20: Grad norm before clip = 4.651431
Train Loss: 0.431916, Cosine Sim: 0.7587
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.615924
  Batch 10: Grad norm before clip = 3.888724
  Batch 20: Grad norm before clip = 4.651431
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.776164, Cosine Sim: 0.6070, MSE: 0.7762
Learning Rate: 5.00e-05

Epoch 63/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.044697
  Batch 10: Grad norm before clip = 7.997330
  Batch 20: Grad norm before clip = 3.222019

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.044697
  Batch 10: Grad norm before clip = 7.997330
  Batch 20: Grad norm before clip = 3.222019
  Batch 0: Grad norm before clip = 4.044697
  Batch 10: Grad norm before clip = 7.997330
  Batch 20: Grad norm before clip = 3.222019
Train Loss: 0.472708, Cosine Sim: 0.7422
  Batch 0: Grad norm before clip = 4.044697
  Batch 10: Grad norm before clip = 7.997330
  Batch 20: Grad norm before clip = 3.222019
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.765856, Cosine Sim: 0.6126, MSE: 0.7659
Learning Rate: 5.00e-05

Epoch 64/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 2.202752
  Batch 10: Grad norm before clip = 2.445626
  Batch 20: Grad norm before clip = 4.901414
Train Loss: 0.461364, Cosine Sim: 0.7536

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.202752
  Batch 10: Grad norm before clip = 2.445626
  Batch 20: Grad norm before clip = 4.901414
  Batch 0: Grad norm before clip = 2.202752
  Batch 10: Grad norm before clip = 2.445626
  Batch 20: Grad norm before clip = 4.901414
  Batch 0: Grad norm before clip = 2.202752
  Batch 10: Grad norm before clip = 2.445626
  Batch 20: Grad norm before clip = 4.901414
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.756584, Cosine Sim: 0.6146, MSE: 0.7566
Learning Rate: 5.00e-05

Epoch 65/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.07it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.07it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.10it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.10it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.10it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.10it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.11it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.13it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]  Batch 0: Grad norm before clip = 2.553402
  Batch 10: Grad norm before clip = 3.223362
  Batch 20: Grad norm before clip = 2.198431

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.553402
  Batch 10: Grad norm before clip = 3.223362
  Batch 20: Grad norm before clip = 2.198431
Train Loss: 0.415242, Cosine Sim: 0.7692
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.553402
  Batch 10: Grad norm before clip = 3.223362
  Batch 20: Grad norm before clip = 2.198431
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.553402
  Batch 10: Grad norm before clip = 3.223362
  Batch 20: Grad norm before clip = 2.198431
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.738181, Cosine Sim: 0.6332, MSE: 0.7382
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_65.pt

Epoch 66/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.03s/it]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.06it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.06it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.06it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.06it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 3.539042
  Batch 10: Grad norm before clip = 3.365698
  Batch 20: Grad norm before clip = 6.534075

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.539042
  Batch 10: Grad norm before clip = 3.365698
  Batch 20: Grad norm before clip = 6.534075
Train Loss: 0.487296, Cosine Sim: 0.7239
  Batch 0: Grad norm before clip = 3.539042
  Batch 10: Grad norm before clip = 3.365698
  Batch 20: Grad norm before clip = 6.534075
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.539042
  Batch 10: Grad norm before clip = 3.365698
  Batch 20: Grad norm before clip = 6.534075
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.750894, Cosine Sim: 0.6228, MSE: 0.7509
Learning Rate: 5.00e-05

Epoch 67/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.126239
  Batch 10: Grad norm before clip = 3.143687
  Batch 20: Grad norm before clip = 3.455396
Train Loss: 0.443477, Cosine Sim: 0.7497

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.126239
  Batch 10: Grad norm before clip = 3.143687
  Batch 20: Grad norm before clip = 3.455396
  Batch 0: Grad norm before clip = 2.126239
  Batch 10: Grad norm before clip = 3.143687
  Batch 20: Grad norm before clip = 3.455396
  Batch 0: Grad norm before clip = 2.126239
  Batch 10: Grad norm before clip = 3.143687
  Batch 20: Grad norm before clip = 3.455396
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.732758, Cosine Sim: 0.6291, MSE: 0.7328
Learning Rate: 2.50e-05

Epoch 68/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 4.579011
  Batch 10: Grad norm before clip = 1.756393
  Batch 20: Grad norm before clip = 3.261899

  Batch 0: Grad norm before clip = 4.579011
  Batch 10: Grad norm before clip = 1.756393
  Batch 20: Grad norm before clip = 3.261899
  Batch 0: Grad norm before clip = 4.579011
  Batch 10: Grad norm before clip = 1.756393
  Batch 20: Grad norm before clip = 3.261899
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.579011
  Batch 10: Grad norm before clip = 1.756393
  Batch 20: Grad norm before clip = 3.261899
Train Loss: 0.420350, Cosine Sim: 0.7725
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.729817, Cosine Sim: 0.6298, MSE: 0.7298
Learning Rate: 2.50e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 69/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

  Batch 0: Grad norm before clip = 4.502902
  Batch 10: Grad norm before clip = 5.839854
  Batch 20: Grad norm before clip = 8.086917
Train Loss: 0.426916, Cosine Sim: 0.7570
  Batch 0: Grad norm before clip = 4.502902
  Batch 10: Grad norm before clip = 5.839854
  Batch 20: Grad norm before clip = 8.086917
  Batch 0: Grad norm before clip = 4.502902
  Batch 10: Grad norm before clip = 5.839854
  Batch 20: Grad norm before clip = 8.086917
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.502902
  Batch 10: Grad norm before clip = 5.839854
  Batch 20: Grad norm before clip = 8.086917
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.753803, Cosine Sim: 0.6127, MSE: 0.7538
Learning Rate: 2.50e-05

Epoch 70/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.50s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.259452
  Batch 10: Grad norm before clip = 3.754516
  Batch 20: Grad norm before clip = 5.872680

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.259452
  Batch 10: Grad norm before clip = 3.754516
  Batch 20: Grad norm before clip = 5.872680
  Batch 0: Grad norm before clip = 2.259452
  Batch 10: Grad norm before clip = 3.754516
  Batch 20: Grad norm before clip = 5.872680
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.259452
  Batch 10: Grad norm before clip = 3.754516
  Batch 20: Grad norm before clip = 5.872680
Train Loss: 0.436567, Cosine Sim: 0.7592
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.740213, Cosine Sim: 0.6252, MSE: 0.7402
Learning Rate: 2.50e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_70.pt

Epoch 71/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.36it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.36it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.36it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.36it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.38it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.38it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.38it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.38it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.665318
  Batch 10: Grad norm before clip = 6.171763
  Batch 20: Grad norm before clip = 4.819244

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.665318
  Batch 10: Grad norm before clip = 6.171763
  Batch 20: Grad norm before clip = 4.819244
  Batch 0: Grad norm before clip = 2.665318
  Batch 10: Grad norm before clip = 6.171763
  Batch 20: Grad norm before clip = 4.819244
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.665318
  Batch 10: Grad norm before clip = 6.171763
  Batch 20: Grad norm before clip = 4.819244
Train Loss: 0.424046, Cosine Sim: 0.7645
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.738896, Cosine Sim: 0.6247, MSE: 0.7389
Learning Rate: 2.50e-05

Epoch 72/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:34,  5.34s/it]Training:   3%|▎         | 1/30 [00:05<02:34,  5.33s/it]Training:   3%|▎         | 1/30 [00:05<02:34,  5.33s/it]Training:   3%|▎         | 1/30 [00:05<02:34,  5.32s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.14s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

  Batch 0: Grad norm before clip = 4.650934
  Batch 10: Grad norm before clip = 4.782347
  Batch 20: Grad norm before clip = 3.508913
Train Loss: 0.417413, Cosine Sim: 0.7567
  Batch 0: Grad norm before clip = 4.650934
  Batch 10: Grad norm before clip = 4.782347
  Batch 20: Grad norm before clip = 3.508913
  Batch 0: Grad norm before clip = 4.650934
  Batch 10: Grad norm before clip = 4.782347
  Batch 20: Grad norm before clip = 3.508913
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.650934
  Batch 10: Grad norm before clip = 4.782347
  Batch 20: Grad norm before clip = 3.508913
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.739792, Cosine Sim: 0.6268, MSE: 0.7398
Learning Rate: 2.50e-05

Epoch 73/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.631760
  Batch 10: Grad norm before clip = 2.999597
  Batch 20: Grad norm before clip = 4.927453
Train Loss: 0.429487, Cosine Sim: 0.7528
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.631760
  Batch 10: Grad norm before clip = 2.999597
  Batch 20: Grad norm before clip = 4.927453
  Batch 0: Grad norm before clip = 3.631760
  Batch 10: Grad norm before clip = 2.999597
  Batch 20: Grad norm before clip = 4.927453
  Batch 0: Grad norm before clip = 3.631760
  Batch 10: Grad norm before clip = 2.999597
  Batch 20: Grad norm before clip = 4.927453
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.767608, Cosine Sim: 0.6047, MSE: 0.7676
Learning Rate: 2.50e-05

Epoch 74/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.35it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.441351
  Batch 10: Grad norm before clip = 3.808009
  Batch 20: Grad norm before clip = 3.376743

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.441351
  Batch 10: Grad norm before clip = 3.808009
  Batch 20: Grad norm before clip = 3.376743
  Batch 0: Grad norm before clip = 3.441351
  Batch 10: Grad norm before clip = 3.808009
  Batch 20: Grad norm before clip = 3.376743
  Batch 0: Grad norm before clip = 3.441351
  Batch 10: Grad norm before clip = 3.808009
  Batch 20: Grad norm before clip = 3.376743
Train Loss: 0.386969, Cosine Sim: 0.7720
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.744110, Cosine Sim: 0.6223, MSE: 0.7441
Learning Rate: 1.25e-05

Epoch 75/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 2.369912
  Batch 10: Grad norm before clip = 7.111101
  Batch 20: Grad norm before clip = 2.383220
Train Loss: 0.410000, Cosine Sim: 0.7591

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.369912
  Batch 10: Grad norm before clip = 7.111101
  Batch 20: Grad norm before clip = 2.383220
  Batch 0: Grad norm before clip = 2.369912
  Batch 10: Grad norm before clip = 7.111101
  Batch 20: Grad norm before clip = 2.383220
  Batch 0: Grad norm before clip = 2.369912
  Batch 10: Grad norm before clip = 7.111101
  Batch 20: Grad norm before clip = 2.383220
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.749647, Cosine Sim: 0.6165, MSE: 0.7496
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_75.pt

Epoch 76/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.35it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.35it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.35it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.863470
  Batch 10: Grad norm before clip = 2.740281
  Batch 20: Grad norm before clip = 3.717582
Train Loss: 0.448212, Cosine Sim: 0.7499
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 4.863470
  Batch 10: Grad norm before clip = 2.740281
  Batch 20: Grad norm before clip = 3.717582
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.863470
  Batch 10: Grad norm before clip = 2.740281
  Batch 20: Grad norm before clip = 3.717582
  Batch 0: Grad norm before clip = 4.863470
  Batch 10: Grad norm before clip = 2.740281
  Batch 20: Grad norm before clip = 3.717582
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.724482, Cosine Sim: 0.6345, MSE: 0.7245
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 77/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]

  Batch 0: Grad norm before clip = 1.881200
  Batch 10: Grad norm before clip = 5.573661
  Batch 20: Grad norm before clip = 2.648288
  Batch 0: Grad norm before clip = 1.881200
  Batch 10: Grad norm before clip = 5.573661
  Batch 20: Grad norm before clip = 2.648288
  Batch 0: Grad norm before clip = 1.881200
  Batch 10: Grad norm before clip = 5.573661
  Batch 20: Grad norm before clip = 2.648288
Train Loss: 0.404425, Cosine Sim: 0.7600
  Batch 0: Grad norm before clip = 1.881200
  Batch 10: Grad norm before clip = 5.573661
  Batch 20: Grad norm before clip = 2.648288
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.737232, Cosine Sim: 0.6247, MSE: 0.7372
Learning Rate: 1.25e-05

Epoch 78/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.032903
  Batch 10: Grad norm before clip = 3.290586
  Batch 20: Grad norm before clip = 3.616729

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.032903
  Batch 10: Grad norm before clip = 3.290586
  Batch 20: Grad norm before clip = 3.616729
  Batch 0: Grad norm before clip = 3.032903
  Batch 10: Grad norm before clip = 3.290586
  Batch 20: Grad norm before clip = 3.616729
Train Loss: 0.418002, Cosine Sim: 0.7670
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.032903
  Batch 10: Grad norm before clip = 3.290586
  Batch 20: Grad norm before clip = 3.616729
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Val Loss: 0.716848, Cosine Sim: 0.6395, MSE: 0.7168
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 79/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.623821
  Batch 10: Grad norm before clip = 9.338914
  Batch 20: Grad norm before clip = 2.294957

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.623821
  Batch 10: Grad norm before clip = 9.338914
  Batch 20: Grad norm before clip = 2.294957
Train Loss: 0.414826, Cosine Sim: 0.7691
  Batch 0: Grad norm before clip = 3.623821
  Batch 10: Grad norm before clip = 9.338914
  Batch 20: Grad norm before clip = 2.294957
  Batch 0: Grad norm before clip = 3.623821
  Batch 10: Grad norm before clip = 9.338914
  Batch 20: Grad norm before clip = 2.294957
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.06s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.05s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.05s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.25s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.25s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.24it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.63s/it]

Val Loss: 0.717175, Cosine Sim: 0.6400, MSE: 0.7172
Learning Rate: 1.25e-05

Epoch 80/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.679855
  Batch 10: Grad norm before clip = 2.666795
  Batch 20: Grad norm before clip = 3.498639

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.679855
  Batch 10: Grad norm before clip = 2.666795
  Batch 20: Grad norm before clip = 3.498639
  Batch 0: Grad norm before clip = 4.679855
  Batch 10: Grad norm before clip = 2.666795
  Batch 20: Grad norm before clip = 3.498639
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.679855
  Batch 10: Grad norm before clip = 2.666795
  Batch 20: Grad norm before clip = 3.498639
Train Loss: 0.407413, Cosine Sim: 0.7723
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.718957, Cosine Sim: 0.6378, MSE: 0.7190
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_80.pt

Epoch 81/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 3.719175
  Batch 10: Grad norm before clip = 5.641186
  Batch 20: Grad norm before clip = 3.759302
Train Loss: 0.430769, Cosine Sim: 0.7660

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.719175
  Batch 10: Grad norm before clip = 5.641186
  Batch 20: Grad norm before clip = 3.759302
  Batch 0: Grad norm before clip = 3.719175
  Batch 10: Grad norm before clip = 5.641186
  Batch 20: Grad norm before clip = 3.759302
  Batch 0: Grad norm before clip = 3.719175
  Batch 10: Grad norm before clip = 5.641186
  Batch 20: Grad norm before clip = 3.759302
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.724067, Cosine Sim: 0.6349, MSE: 0.7241
Learning Rate: 1.25e-05

Epoch 82/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 4.793646
  Batch 10: Grad norm before clip = 3.001400
  Batch 20: Grad norm before clip = 3.216225

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.793646
  Batch 10: Grad norm before clip = 3.001400
  Batch 20: Grad norm before clip = 3.216225
Train Loss: 0.440120, Cosine Sim: 0.7427
  Batch 0: Grad norm before clip = 4.793646
  Batch 10: Grad norm before clip = 3.001400
  Batch 20: Grad norm before clip = 3.216225
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.793646
  Batch 10: Grad norm before clip = 3.001400
  Batch 20: Grad norm before clip = 3.216225
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.732740, Cosine Sim: 0.6285, MSE: 0.7327
Learning Rate: 1.25e-05

Epoch 83/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 2.585666
  Batch 10: Grad norm before clip = 4.820535
  Batch 20: Grad norm before clip = 3.583963

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.585666
  Batch 10: Grad norm before clip = 4.820535
  Batch 20: Grad norm before clip = 3.583963
Train Loss: 0.408639, Cosine Sim: 0.7692
  Batch 0: Grad norm before clip = 2.585666
  Batch 10: Grad norm before clip = 4.820535
  Batch 20: Grad norm before clip = 3.583963
  Batch 0: Grad norm before clip = 2.585666
  Batch 10: Grad norm before clip = 4.820535
  Batch 20: Grad norm before clip = 3.583963
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.76s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.713990, Cosine Sim: 0.6414, MSE: 0.7140
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 84/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 5.109375
  Batch 10: Grad norm before clip = 5.386551
  Batch 20: Grad norm before clip = 5.307303

  Batch 0: Grad norm before clip = 5.109375
  Batch 10: Grad norm before clip = 5.386551
  Batch 20: Grad norm before clip = 5.307303
  Batch 0: Grad norm before clip = 5.109375
  Batch 10: Grad norm before clip = 5.386551
  Batch 20: Grad norm before clip = 5.307303
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.109375
  Batch 10: Grad norm before clip = 5.386551
  Batch 20: Grad norm before clip = 5.307303
Train Loss: 0.421346, Cosine Sim: 0.7567
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Val Loss: 0.721395, Cosine Sim: 0.6365, MSE: 0.7214
Learning Rate: 1.25e-05

Epoch 85/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.01s/it]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.00it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 2.047130
  Batch 10: Grad norm before clip = 2.007878
  Batch 20: Grad norm before clip = 1.906374
Train Loss: 0.424625, Cosine Sim: 0.7677

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.047130
  Batch 10: Grad norm before clip = 2.007878
  Batch 20: Grad norm before clip = 1.906374
  Batch 0: Grad norm before clip = 2.047130
  Batch 10: Grad norm before clip = 2.007878
  Batch 20: Grad norm before clip = 1.906374
  Batch 0: Grad norm before clip = 2.047130
  Batch 10: Grad norm before clip = 2.007878
  Batch 20: Grad norm before clip = 1.906374
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.00s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.03s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.03s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.16s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.24s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.25it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.64s/it]
Val Loss: 0.731808, Cosine Sim: 0.6290, MSE: 0.7318
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_85.pt

Epoch 86/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.006297
  Batch 10: Grad norm before clip = 4.659823
  Batch 20: Grad norm before clip = 2.594686
Train Loss: 0.437463, Cosine Sim: 0.7641

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.006297
  Batch 10: Grad norm before clip = 4.659823
  Batch 20: Grad norm before clip = 2.594686
  Batch 0: Grad norm before clip = 3.006297
  Batch 10: Grad norm before clip = 4.659823
  Batch 20: Grad norm before clip = 2.594686
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.006297
  Batch 10: Grad norm before clip = 4.659823
  Batch 20: Grad norm before clip = 2.594686
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.715781, Cosine Sim: 0.6392, MSE: 0.7158
Learning Rate: 1.25e-05

Epoch 87/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.624811
  Batch 10: Grad norm before clip = 2.592545
  Batch 20: Grad norm before clip = 5.549108

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.624811
  Batch 10: Grad norm before clip = 2.592545
  Batch 20: Grad norm before clip = 5.549108
  Batch 0: Grad norm before clip = 3.624811
  Batch 10: Grad norm before clip = 2.592545
  Batch 20: Grad norm before clip = 5.549108
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.624811
  Batch 10: Grad norm before clip = 2.592545
  Batch 20: Grad norm before clip = 5.549108
Train Loss: 0.413779, Cosine Sim: 0.7694
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.708998, Cosine Sim: 0.6428, MSE: 0.7090
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 88/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

  Batch 0: Grad norm before clip = 3.132675
  Batch 10: Grad norm before clip = 2.861197
  Batch 20: Grad norm before clip = 1.982460
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.132675
  Batch 10: Grad norm before clip = 2.861197
  Batch 20: Grad norm before clip = 1.982460
  Batch 0: Grad norm before clip = 3.132675
  Batch 10: Grad norm before clip = 2.861197
  Batch 20: Grad norm before clip = 1.982460
  Batch 0: Grad norm before clip = 3.132675
  Batch 10: Grad norm before clip = 2.861197
  Batch 20: Grad norm before clip = 1.982460
Train Loss: 0.379328, Cosine Sim: 0.7805
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Val Loss: 0.700247, Cosine Sim: 0.6491, MSE: 0.7002
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 89/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.12it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.12it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.12it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.12it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 1.869467
  Batch 10: Grad norm before clip = 4.298962
  Batch 20: Grad norm before clip = 3.876242


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.869467
  Batch 10: Grad norm before clip = 4.298962
  Batch 20: Grad norm before clip = 3.876242
  Batch 0: Grad norm before clip = 1.869467
  Batch 10: Grad norm before clip = 4.298962
  Batch 20: Grad norm before clip = 3.876242
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.869467
  Batch 10: Grad norm before clip = 4.298962
  Batch 20: Grad norm before clip = 3.876242
Train Loss: 0.447816, Cosine Sim: 0.7415
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.705965, Cosine Sim: 0.6455, MSE: 0.7060
Learning Rate: 1.25e-05

Epoch 90/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.12it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.12it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.12it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.12it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.453830
  Batch 10: Grad norm before clip = 5.306739
  Batch 20: Grad norm before clip = 4.619194

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.453830
  Batch 10: Grad norm before clip = 5.306739
  Batch 20: Grad norm before clip = 4.619194
Train Loss: 0.385170, Cosine Sim: 0.7682
  Batch 0: Grad norm before clip = 3.453830
  Batch 10: Grad norm before clip = 5.306739
  Batch 20: Grad norm before clip = 4.619194
  Batch 0: Grad norm before clip = 3.453830
  Batch 10: Grad norm before clip = 5.306739
  Batch 20: Grad norm before clip = 4.619194
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.693184, Cosine Sim: 0.6538, MSE: 0.6932
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_90.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 91/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.09s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 3.399360
  Batch 10: Grad norm before clip = 3.122682
  Batch 20: Grad norm before clip = 8.339849

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.399360
  Batch 10: Grad norm before clip = 3.122682
  Batch 20: Grad norm before clip = 8.339849
  Batch 0: Grad norm before clip = 3.399360
  Batch 10: Grad norm before clip = 3.122682
  Batch 20: Grad norm before clip = 8.339849
Train Loss: 0.459235, Cosine Sim: 0.7640
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.399360
  Batch 10: Grad norm before clip = 3.122682
  Batch 20: Grad norm before clip = 8.339849
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Val Loss: 0.720674, Cosine Sim: 0.6339, MSE: 0.7207
Learning Rate: 1.25e-05

Epoch 92/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 5.378299
  Batch 10: Grad norm before clip = 1.899440
  Batch 20: Grad norm before clip = 4.085826
Train Loss: 0.397177, Cosine Sim: 0.7748
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.378299
  Batch 10: Grad norm before clip = 1.899440
  Batch 20: Grad norm before clip = 4.085826
  Batch 0: Grad norm before clip = 5.378299
  Batch 10: Grad norm before clip = 1.899440
  Batch 20: Grad norm before clip = 4.085826
  Batch 0: Grad norm before clip = 5.378299
  Batch 10: Grad norm before clip = 1.899440
  Batch 20: Grad norm before clip = 4.085826
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.706907, Cosine Sim: 0.6424, MSE: 0.7069
Learning Rate: 1.25e-05

Epoch 93/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.209978
  Batch 10: Grad norm before clip = 3.309016
  Batch 20: Grad norm before clip = 4.563692

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.209978
  Batch 10: Grad norm before clip = 3.309016
  Batch 20: Grad norm before clip = 4.563692
  Batch 0: Grad norm before clip = 4.209978
  Batch 10: Grad norm before clip = 3.309016
  Batch 20: Grad norm before clip = 4.563692
Train Loss: 0.387146, Cosine Sim: 0.7903
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.209978
  Batch 10: Grad norm before clip = 3.309016
  Batch 20: Grad norm before clip = 4.563692
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.691230, Cosine Sim: 0.6521, MSE: 0.6912
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 94/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:28,  1.17s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 3.422455
  Batch 10: Grad norm before clip = 3.640616
  Batch 20: Grad norm before clip = 4.522179

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.422455
  Batch 10: Grad norm before clip = 3.640616
  Batch 20: Grad norm before clip = 4.522179
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.422455
  Batch 10: Grad norm before clip = 3.640616
  Batch 20: Grad norm before clip = 4.522179
Train Loss: 0.397911, Cosine Sim: 0.7828
  Batch 0: Grad norm before clip = 3.422455
  Batch 10: Grad norm before clip = 3.640616
  Batch 20: Grad norm before clip = 4.522179
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.710379, Cosine Sim: 0.6401, MSE: 0.7104
Learning Rate: 1.25e-05

Epoch 95/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.760273
  Batch 10: Grad norm before clip = 4.471557
  Batch 20: Grad norm before clip = 3.449458

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.760273
  Batch 10: Grad norm before clip = 4.471557
  Batch 20: Grad norm before clip = 3.449458
Train Loss: 0.414186, Cosine Sim: 0.7646
  Batch 0: Grad norm before clip = 2.760273
  Batch 10: Grad norm before clip = 4.471557
  Batch 20: Grad norm before clip = 3.449458
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.760273
  Batch 10: Grad norm before clip = 4.471557
  Batch 20: Grad norm before clip = 3.449458
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.693303, Cosine Sim: 0.6528, MSE: 0.6933
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_95.pt

Epoch 96/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.16it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.025524
  Batch 10: Grad norm before clip = 3.073428
  Batch 20: Grad norm before clip = 3.044434

  Batch 0: Grad norm before clip = 4.025524
  Batch 10: Grad norm before clip = 3.073428
  Batch 20: Grad norm before clip = 3.044434
  Batch 0: Grad norm before clip = 4.025524
  Batch 10: Grad norm before clip = 3.073428
  Batch 20: Grad norm before clip = 3.044434
Train Loss: 0.400967, Cosine Sim: 0.7678
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.025524
  Batch 10: Grad norm before clip = 3.073428
  Batch 20: Grad norm before clip = 3.044434
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.705647, Cosine Sim: 0.6428, MSE: 0.7056
Learning Rate: 1.25e-05

Epoch 97/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:34,  5.34s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.11it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.11it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.11it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.11it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 6.184706
  Batch 10: Grad norm before clip = 4.026705
  Batch 20: Grad norm before clip = 3.406615
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 6.184706
  Batch 10: Grad norm before clip = 4.026705
  Batch 20: Grad norm before clip = 3.406615

  Batch 0: Grad norm before clip = 6.184706
  Batch 10: Grad norm before clip = 4.026705
  Batch 20: Grad norm before clip = 3.406615
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.184706
  Batch 10: Grad norm before clip = 4.026705
  Batch 20: Grad norm before clip = 3.406615
Train Loss: 0.395811, Cosine Sim: 0.7843
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 0.690290, Cosine Sim: 0.6551, MSE: 0.6903
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 98/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  10%|█         | 3/30 [00:07<00:53,  1.97s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.30s/it]Training:  20%|██        | 6/30 [00:10<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:10<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:10<00:28,  1.17s/it]Training:  20%|██        | 6/30 [00:10<00:28,  1.17s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.37it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.37it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.37it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.14it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.18it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 2.511454
  Batch 10: Grad norm before clip = 2.997417
  Batch 20: Grad norm before clip = 2.765708
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.511454
  Batch 10: Grad norm before clip = 2.997417
  Batch 20: Grad norm before clip = 2.765708
Train Loss: 0.422740, Cosine Sim: 0.7683
  Batch 0: Grad norm before clip = 2.511454
  Batch 10: Grad norm before clip = 2.997417
  Batch 20: Grad norm before clip = 2.765708
  Batch 0: Grad norm before clip = 2.511454
  Batch 10: Grad norm before clip = 2.997417
  Batch 20: Grad norm before clip = 2.765708
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.686609, Cosine Sim: 0.6570, MSE: 0.6866
Learning Rate: 1.25e-05
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 99/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:15<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:15<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.722343
  Batch 10: Grad norm before clip = 2.916868
  Batch 20: Grad norm before clip = 2.370112

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.722343
  Batch 10: Grad norm before clip = 2.916868
  Batch 20: Grad norm before clip = 2.370112
  Batch 0: Grad norm before clip = 4.722343
  Batch 10: Grad norm before clip = 2.916868
  Batch 20: Grad norm before clip = 2.370112
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.722343
  Batch 10: Grad norm before clip = 2.916868
  Batch 20: Grad norm before clip = 2.370112
Train Loss: 0.396836, Cosine Sim: 0.7893
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.687528, Cosine Sim: 0.6565, MSE: 0.6875
Learning Rate: 1.25e-05

Epoch 100/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.05it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.16it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 2.584866
  Batch 10: Grad norm before clip = 3.005524
  Batch 20: Grad norm before clip = 4.141239

  Batch 0: Grad norm before clip = 2.584866
  Batch 10: Grad norm before clip = 3.005524
  Batch 20: Grad norm before clip = 4.141239
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.584866
  Batch 10: Grad norm before clip = 3.005524
  Batch 20: Grad norm before clip = 4.141239
  Batch 0: Grad norm before clip = 2.584866
  Batch 10: Grad norm before clip = 3.005524
  Batch 20: Grad norm before clip = 4.141239
Train Loss: 0.422940, Cosine Sim: 0.7627
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.680278, Cosine Sim: 0.6614, MSE: 0.6803
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_100.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 101/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.651532
  Batch 10: Grad norm before clip = 3.785129
  Batch 20: Grad norm before clip = 1.870749

  Batch 0: Grad norm before clip = 4.651532
  Batch 10: Grad norm before clip = 3.785129
  Batch 20: Grad norm before clip = 1.870749
  Batch 0: Grad norm before clip = 4.651532
  Batch 10: Grad norm before clip = 3.785129
  Batch 20: Grad norm before clip = 1.870749
Train Loss: 0.371526, Cosine Sim: 0.7899
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.651532
  Batch 10: Grad norm before clip = 3.785129
  Batch 20: Grad norm before clip = 1.870749
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.689722, Cosine Sim: 0.6553, MSE: 0.6897
Learning Rate: 1.25e-05

Epoch 102/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:46,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.75s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.96s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.52s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.52s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.52s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.52s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.28s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.15it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:20<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:22<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:22<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 4.152010
  Batch 10: Grad norm before clip = 3.049839
  Batch 20: Grad norm before clip = 3.619271

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.152010
  Batch 10: Grad norm before clip = 3.049839
  Batch 20: Grad norm before clip = 3.619271
  Batch 0: Grad norm before clip = 4.152010
  Batch 10: Grad norm before clip = 3.049839
  Batch 20: Grad norm before clip = 3.619271
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.152010
  Batch 10: Grad norm before clip = 3.049839
  Batch 20: Grad norm before clip = 3.619271
Train Loss: 0.371782, Cosine Sim: 0.7910
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.690280, Cosine Sim: 0.6555, MSE: 0.6903
Learning Rate: 1.25e-05

Epoch 103/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.37it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.38it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.37it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 5.075023
  Batch 10: Grad norm before clip = 4.360792
  Batch 20: Grad norm before clip = 3.384132
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 5.075023
  Batch 10: Grad norm before clip = 4.360792
  Batch 20: Grad norm before clip = 3.384132

  Batch 0: Grad norm before clip = 5.075023
  Batch 10: Grad norm before clip = 4.360792
  Batch 20: Grad norm before clip = 3.384132
Train Loss: 0.393849, Cosine Sim: 0.7754
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.075023
  Batch 10: Grad norm before clip = 4.360792
  Batch 20: Grad norm before clip = 3.384132
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.14s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.15s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.686172, Cosine Sim: 0.6578, MSE: 0.6862
Learning Rate: 1.25e-05

Epoch 104/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.059125
  Batch 10: Grad norm before clip = 4.800251
  Batch 20: Grad norm before clip = 2.477057
Train Loss: 0.371771, Cosine Sim: 0.7733

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 4.059125
  Batch 10: Grad norm before clip = 4.800251
  Batch 20: Grad norm before clip = 2.477057
  Batch 0: Grad norm before clip = 4.059125
  Batch 10: Grad norm before clip = 4.800251
  Batch 20: Grad norm before clip = 2.477057
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.059125
  Batch 10: Grad norm before clip = 4.800251
  Batch 20: Grad norm before clip = 2.477057
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.704485, Cosine Sim: 0.6443, MSE: 0.7045
Learning Rate: 1.25e-05

Epoch 105/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]

  Batch 0: Grad norm before clip = 3.737539
  Batch 10: Grad norm before clip = 1.811161
  Batch 20: Grad norm before clip = 3.406081
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 3.737539
  Batch 10: Grad norm before clip = 1.811161
  Batch 20: Grad norm before clip = 3.406081

  Batch 0: Grad norm before clip = 3.737539
  Batch 10: Grad norm before clip = 1.811161
  Batch 20: Grad norm before clip = 3.406081
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.737539
  Batch 10: Grad norm before clip = 1.811161
  Batch 20: Grad norm before clip = 3.406081
Train Loss: 0.400567, Cosine Sim: 0.7868
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.726759, Cosine Sim: 0.6285, MSE: 0.7268
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_105.pt

Epoch 106/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 3.509755
  Batch 10: Grad norm before clip = 3.064344
  Batch 20: Grad norm before clip = 4.211357
Train Loss: 0.397341, Cosine Sim: 0.7753

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.509755
  Batch 10: Grad norm before clip = 3.064344
  Batch 20: Grad norm before clip = 4.211357
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

  Batch 0: Grad norm before clip = 3.509755
  Batch 10: Grad norm before clip = 3.064344
  Batch 20: Grad norm before clip = 4.211357
  Batch 0: Grad norm before clip = 3.509755
  Batch 10: Grad norm before clip = 3.064344
  Batch 20: Grad norm before clip = 4.211357
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.99s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.14s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.62s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.694914, Cosine Sim: 0.6516, MSE: 0.6949
Learning Rate: 6.25e-06

Epoch 107/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.33s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.33s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.33s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.33s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:23<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:23<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.445256
  Batch 10: Grad norm before clip = 3.881205
  Batch 20: Grad norm before clip = 6.082236
Train Loss: 0.359880, Cosine Sim: 0.7952
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.445256
  Batch 10: Grad norm before clip = 3.881205
  Batch 20: Grad norm before clip = 6.082236
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.445256
  Batch 10: Grad norm before clip = 3.881205
  Batch 20: Grad norm before clip = 6.082236
  Batch 0: Grad norm before clip = 2.445256
  Batch 10: Grad norm before clip = 3.881205
  Batch 20: Grad norm before clip = 6.082236
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.698273, Cosine Sim: 0.6498, MSE: 0.6983
Learning Rate: 6.25e-06

Epoch 108/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.79s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 3.422193
  Batch 10: Grad norm before clip = 2.787988
  Batch 20: Grad norm before clip = 2.982740

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.422193
  Batch 10: Grad norm before clip = 2.787988
  Batch 20: Grad norm before clip = 2.982740
  Batch 0: Grad norm before clip = 3.422193
  Batch 10: Grad norm before clip = 2.787988
  Batch 20: Grad norm before clip = 2.982740
Train Loss: 0.377380, Cosine Sim: 0.8017
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.422193
  Batch 10: Grad norm before clip = 2.787988
  Batch 20: Grad norm before clip = 2.982740
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.10s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.11s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.11s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.14s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.19s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.18s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.25s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.25s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.24it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.64s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.64s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.64s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.65s/it]
Val Loss: 0.697213, Cosine Sim: 0.6503, MSE: 0.6972
Learning Rate: 6.25e-06

Epoch 109/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.11it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.11it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.11it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.11it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 5.039374
  Batch 10: Grad norm before clip = 2.420333
  Batch 20: Grad norm before clip = 3.210546

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.039374
  Batch 10: Grad norm before clip = 2.420333
  Batch 20: Grad norm before clip = 3.210546
  Batch 0: Grad norm before clip = 5.039374
  Batch 10: Grad norm before clip = 2.420333
  Batch 20: Grad norm before clip = 3.210546
  Batch 0: Grad norm before clip = 5.039374
  Batch 10: Grad norm before clip = 2.420333
  Batch 20: Grad norm before clip = 3.210546
Train Loss: 0.384832, Cosine Sim: 0.7838
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  5.00s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.14s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Val Loss: 0.703410, Cosine Sim: 0.6474, MSE: 0.7034
Learning Rate: 6.25e-06

Epoch 110/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.03it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.06it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.07it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 2.876626
  Batch 10: Grad norm before clip = 3.068298
  Batch 20: Grad norm before clip = 3.145968

  Batch 0: Grad norm before clip = 2.876626
  Batch 10: Grad norm before clip = 3.068298
  Batch 20: Grad norm before clip = 3.145968
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.876626
  Batch 10: Grad norm before clip = 3.068298
  Batch 20: Grad norm before clip = 3.145968
  Batch 0: Grad norm before clip = 2.876626
  Batch 10: Grad norm before clip = 3.068298
  Batch 20: Grad norm before clip = 3.145968
Train Loss: 0.399942, Cosine Sim: 0.7779
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.695080, Cosine Sim: 0.6530, MSE: 0.6951
Learning Rate: 6.25e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_110.pt

Epoch 111/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.18it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]  Batch 0: Grad norm before clip = 3.414949
  Batch 10: Grad norm before clip = 6.001802
  Batch 20: Grad norm before clip = 3.068462
Train Loss: 0.401454, Cosine Sim: 0.7681


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.414949
  Batch 10: Grad norm before clip = 6.001802
  Batch 20: Grad norm before clip = 3.068462
  Batch 0: Grad norm before clip = 3.414949
  Batch 10: Grad norm before clip = 6.001802
  Batch 20: Grad norm before clip = 3.068462
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.414949
  Batch 10: Grad norm before clip = 6.001802
  Batch 20: Grad norm before clip = 3.068462
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.709712, Cosine Sim: 0.6419, MSE: 0.7097
Learning Rate: 6.25e-06

Epoch 112/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.61s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.32s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.07it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.13it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.36it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.36it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.36it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.489302
  Batch 10: Grad norm before clip = 3.047998
  Batch 20: Grad norm before clip = 5.502067

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.489302
  Batch 10: Grad norm before clip = 3.047998
  Batch 20: Grad norm before clip = 5.502067
  Batch 0: Grad norm before clip = 2.489302
  Batch 10: Grad norm before clip = 3.047998
  Batch 20: Grad norm before clip = 5.502067
Train Loss: 0.398373, Cosine Sim: 0.7839
  Batch 0: Grad norm before clip = 2.489302
  Batch 10: Grad norm before clip = 3.047998
  Batch 20: Grad norm before clip = 5.502067
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.707845, Cosine Sim: 0.6425, MSE: 0.7078
Learning Rate: 3.13e-06

Epoch 113/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.93s/it]Training:  10%|█         | 3/30 [00:07<00:54,  2.01s/it]Training:  10%|█         | 3/30 [00:07<00:54,  2.01s/it]Training:  10%|█         | 3/30 [00:07<00:54,  2.01s/it]Training:  10%|█         | 3/30 [00:07<00:54,  2.01s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.31s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:10<00:27,  1.16s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:14<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:14<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:14<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:14<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:15<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:16<00:15,  1.09it/s]Training:  43%|████▎     | 13/30 [00:16<00:15,  1.09it/s]Training:  43%|████▎     | 13/30 [00:16<00:15,  1.09it/s]Training:  43%|████▎     | 13/30 [00:16<00:15,  1.09it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:19<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.14it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:24<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:28<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]  Batch 0: Grad norm before clip = 2.542017
  Batch 10: Grad norm before clip = 4.342822
  Batch 20: Grad norm before clip = 4.096818
Train Loss: 0.435526, Cosine Sim: 0.7616

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.542017
  Batch 10: Grad norm before clip = 4.342822
  Batch 20: Grad norm before clip = 4.096818
  Batch 0: Grad norm before clip = 2.542017
  Batch 10: Grad norm before clip = 4.342822
  Batch 20: Grad norm before clip = 4.096818
  Batch 0: Grad norm before clip = 2.542017
  Batch 10: Grad norm before clip = 4.342822
  Batch 20: Grad norm before clip = 4.096818
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]

Val Loss: 0.710406, Cosine Sim: 0.6401, MSE: 0.7104
Learning Rate: 3.13e-06

Epoch 114/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   7%|▋         | 2/30 [00:06<01:21,  2.93s/it]Training:   7%|▋         | 2/30 [00:06<01:21,  2.92s/it]Training:   7%|▋         | 2/30 [00:06<01:21,  2.92s/it]Training:   7%|▋         | 2/30 [00:06<01:21,  2.92s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.93s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.93s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.93s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.93s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 6.215122
  Batch 10: Grad norm before clip = 3.845317
  Batch 20: Grad norm before clip = 4.721339
Train Loss: 0.447535, Cosine Sim: 0.7601

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.215122
  Batch 10: Grad norm before clip = 3.845317
  Batch 20: Grad norm before clip = 4.721339
  Batch 0: Grad norm before clip = 6.215122
  Batch 10: Grad norm before clip = 3.845317
  Batch 20: Grad norm before clip = 4.721339
  Batch 0: Grad norm before clip = 6.215122
  Batch 10: Grad norm before clip = 3.845317
  Batch 20: Grad norm before clip = 4.721339
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.700270, Cosine Sim: 0.6470, MSE: 0.7003
Learning Rate: 3.13e-06

Epoch 115/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.12it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 6.821787
  Batch 10: Grad norm before clip = 2.495904
  Batch 20: Grad norm before clip = 2.023614
Train Loss: 0.435065, Cosine Sim: 0.7759

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.821787
  Batch 10: Grad norm before clip = 2.495904
  Batch 20: Grad norm before clip = 2.023614
  Batch 0: Grad norm before clip = 6.821787
  Batch 10: Grad norm before clip = 2.495904
  Batch 20: Grad norm before clip = 2.023614
  Batch 0: Grad norm before clip = 6.821787
  Batch 10: Grad norm before clip = 2.495904
  Batch 20: Grad norm before clip = 2.023614
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 0.690006, Cosine Sim: 0.6543, MSE: 0.6900
Learning Rate: 3.13e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_115.pt

Epoch 116/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 2.407007
  Batch 10: Grad norm before clip = 3.208808
  Batch 20: Grad norm before clip = 5.046162


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.407007
  Batch 10: Grad norm before clip = 3.208808
  Batch 20: Grad norm before clip = 5.046162
Train Loss: 0.357254, Cosine Sim: 0.8003
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.407007
  Batch 10: Grad norm before clip = 3.208808
  Batch 20: Grad norm before clip = 5.046162
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.407007
  Batch 10: Grad norm before clip = 3.208808
  Batch 20: Grad norm before clip = 5.046162
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.689277, Cosine Sim: 0.6547, MSE: 0.6893
Learning Rate: 3.13e-06

Epoch 117/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:14<00:13,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 4.857852
  Batch 10: Grad norm before clip = 3.286824
  Batch 20: Grad norm before clip = 4.879418

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 4.857852
  Batch 10: Grad norm before clip = 3.286824
  Batch 20: Grad norm before clip = 4.879418

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.857852
  Batch 10: Grad norm before clip = 3.286824
  Batch 20: Grad norm before clip = 4.879418
  Batch 0: Grad norm before clip = 4.857852
  Batch 10: Grad norm before clip = 3.286824
  Batch 20: Grad norm before clip = 4.879418
Train Loss: 0.351349, Cosine Sim: 0.7938
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Val Loss: 0.696275, Cosine Sim: 0.6499, MSE: 0.6963
Learning Rate: 3.13e-06

Epoch 118/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.820699
  Batch 10: Grad norm before clip = 3.628424
  Batch 20: Grad norm before clip = 2.239563
Train Loss: 0.437037, Cosine Sim: 0.7596

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.820699
  Batch 10: Grad norm before clip = 3.628424
  Batch 20: Grad norm before clip = 2.239563
  Batch 0: Grad norm before clip = 3.820699
  Batch 10: Grad norm before clip = 3.628424
  Batch 20: Grad norm before clip = 2.239563
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.820699
  Batch 10: Grad norm before clip = 3.628424
  Batch 20: Grad norm before clip = 2.239563
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.701875, Cosine Sim: 0.6461, MSE: 0.7019
Learning Rate: 1.56e-06

Epoch 119/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.51s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 6.293542
  Batch 10: Grad norm before clip = 4.513285
  Batch 20: Grad norm before clip = 2.628113
Train Loss: 0.382316, Cosine Sim: 0.7852


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.293542
  Batch 10: Grad norm before clip = 4.513285
  Batch 20: Grad norm before clip = 2.628113
  Batch 0: Grad norm before clip = 6.293542
  Batch 10: Grad norm before clip = 4.513285
  Batch 20: Grad norm before clip = 2.628113
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.293542
  Batch 10: Grad norm before clip = 4.513285
  Batch 20: Grad norm before clip = 2.628113
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.97s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.23s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.26it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.702515, Cosine Sim: 0.6458, MSE: 0.7025
Learning Rate: 1.56e-06

Epoch 120/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.02it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.06it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.06it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.06it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.06it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:15,  1.11it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.13it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.13it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.664730
  Batch 10: Grad norm before clip = 4.127215
  Batch 20: Grad norm before clip = 2.510315
Train Loss: 0.381512, Cosine Sim: 0.7882
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.664730
  Batch 10: Grad norm before clip = 4.127215
  Batch 20: Grad norm before clip = 2.510315
  Batch 0: Grad norm before clip = 4.664730
  Batch 10: Grad norm before clip = 4.127215
  Batch 20: Grad norm before clip = 2.510315
  Batch 0: Grad norm before clip = 4.664730
  Batch 10: Grad norm before clip = 4.127215
  Batch 20: Grad norm before clip = 2.510315
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 0.704884, Cosine Sim: 0.6439, MSE: 0.7049
Learning Rate: 1.56e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_120.pt

Epoch 121/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 4.432132
  Batch 10: Grad norm before clip = 3.432134
  Batch 20: Grad norm before clip = 4.528228

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.432132
  Batch 10: Grad norm before clip = 3.432134
  Batch 20: Grad norm before clip = 4.528228
  Batch 0: Grad norm before clip = 4.432132
  Batch 10: Grad norm before clip = 3.432134
  Batch 20: Grad norm before clip = 4.528228
Train Loss: 0.407674, Cosine Sim: 0.7714
  Batch 0: Grad norm before clip = 4.432132
  Batch 10: Grad norm before clip = 3.432134
  Batch 20: Grad norm before clip = 4.528228
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.705113, Cosine Sim: 0.6436, MSE: 0.7051
Learning Rate: 1.56e-06

Epoch 122/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.10it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.10it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.10it/s]Training:  67%|██████▋   | 20/30 [00:21<00:09,  1.10it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 4.999819
  Batch 10: Grad norm before clip = 2.137373
  Batch 20: Grad norm before clip = 2.981548

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.999819
  Batch 10: Grad norm before clip = 2.137373
  Batch 20: Grad norm before clip = 2.981548
Train Loss: 0.382531, Cosine Sim: 0.7854
  Batch 0: Grad norm before clip = 4.999819
  Batch 10: Grad norm before clip = 2.137373
  Batch 20: Grad norm before clip = 2.981548
  Batch 0: Grad norm before clip = 4.999819
  Batch 10: Grad norm before clip = 2.137373
  Batch 20: Grad norm before clip = 2.981548
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.709429, Cosine Sim: 0.6405, MSE: 0.7094
Learning Rate: 1.56e-06

Epoch 123/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.63s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.15s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

  Batch 0: Grad norm before clip = 4.654921
  Batch 10: Grad norm before clip = 4.821779
  Batch 20: Grad norm before clip = 3.619258

  Batch 0: Grad norm before clip = 4.654921
  Batch 10: Grad norm before clip = 4.821779
  Batch 20: Grad norm before clip = 3.619258
  Batch 0: Grad norm before clip = 4.654921
  Batch 10: Grad norm before clip = 4.821779
  Batch 20: Grad norm before clip = 3.619258
Train Loss: 0.393632, Cosine Sim: 0.7738
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.654921
  Batch 10: Grad norm before clip = 4.821779
  Batch 20: Grad norm before clip = 3.619258
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]

Val Loss: 0.710674, Cosine Sim: 0.6395, MSE: 0.7107
Learning Rate: 1.56e-06

Epoch 124/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:34,  5.34s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.03it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 6.338672
  Batch 10: Grad norm before clip = 5.250727
  Batch 20: Grad norm before clip = 5.887418

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 6.338672
  Batch 10: Grad norm before clip = 5.250727
  Batch 20: Grad norm before clip = 5.887418
  Batch 0: Grad norm before clip = 6.338672
  Batch 10: Grad norm before clip = 5.250727
  Batch 20: Grad norm before clip = 5.887418
Train Loss: 0.349405, Cosine Sim: 0.8107
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.338672
  Batch 10: Grad norm before clip = 5.250727
  Batch 20: Grad norm before clip = 5.887418
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.706106, Cosine Sim: 0.6425, MSE: 0.7061
Learning Rate: 7.81e-07

Epoch 125/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.80s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.14it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.14it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 2.734570
  Batch 10: Grad norm before clip = 3.676564
  Batch 20: Grad norm before clip = 3.522392
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 2.734570
  Batch 10: Grad norm before clip = 3.676564
  Batch 20: Grad norm before clip = 3.522392
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.734570
  Batch 10: Grad norm before clip = 3.676564
  Batch 20: Grad norm before clip = 3.522392
Train Loss: 0.403950, Cosine Sim: 0.7733
  Batch 0: Grad norm before clip = 2.734570
  Batch 10: Grad norm before clip = 3.676564
  Batch 20: Grad norm before clip = 3.522392
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Val Loss: 0.706637, Cosine Sim: 0.6421, MSE: 0.7066
Learning Rate: 7.81e-07
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_125.pt

Epoch 126/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.07it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 3.283694
  Batch 10: Grad norm before clip = 3.651275
  Batch 20: Grad norm before clip = 1.908114

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.283694
  Batch 10: Grad norm before clip = 3.651275
  Batch 20: Grad norm before clip = 1.908114
Train Loss: 0.409544, Cosine Sim: 0.7651
  Batch 0: Grad norm before clip = 3.283694
  Batch 10: Grad norm before clip = 3.651275
  Batch 20: Grad norm before clip = 1.908114
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.283694
  Batch 10: Grad norm before clip = 3.651275
  Batch 20: Grad norm before clip = 1.908114
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.74s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.03s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.704103, Cosine Sim: 0.6440, MSE: 0.7041
Learning Rate: 7.81e-07

Epoch 127/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.05s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 6.120847
  Batch 10: Grad norm before clip = 3.184798
  Batch 20: Grad norm before clip = 3.266304

  Batch 0: Grad norm before clip = 6.120847
  Batch 10: Grad norm before clip = 3.184798
  Batch 20: Grad norm before clip = 3.266304
  Batch 0: Grad norm before clip = 6.120847
  Batch 10: Grad norm before clip = 3.184798
  Batch 20: Grad norm before clip = 3.266304
Train Loss: 0.388405, Cosine Sim: 0.7761
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.120847
  Batch 10: Grad norm before clip = 3.184798
  Batch 20: Grad norm before clip = 3.266304
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.61s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.703874, Cosine Sim: 0.6442, MSE: 0.7039
Learning Rate: 7.81e-07

Epoch 128/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.12it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.111917
  Batch 10: Grad norm before clip = 5.765409
  Batch 20: Grad norm before clip = 7.320394

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.111917
  Batch 10: Grad norm before clip = 5.765409
  Batch 20: Grad norm before clip = 7.320394
  Batch 0: Grad norm before clip = 3.111917
  Batch 10: Grad norm before clip = 5.765409
  Batch 20: Grad norm before clip = 7.320394
  Batch 0: Grad norm before clip = 3.111917
  Batch 10: Grad norm before clip = 5.765409
  Batch 20: Grad norm before clip = 7.320394
Train Loss: 0.400134, Cosine Sim: 0.7851
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.72s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.03s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.33it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.22s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.27it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.703421, Cosine Sim: 0.6444, MSE: 0.7034
Learning Rate: 7.81e-07

Epoch 129/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.25it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.25it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.25it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.25it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.37it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.37it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.37it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.37it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 3.117954
  Batch 10: Grad norm before clip = 2.314264
  Batch 20: Grad norm before clip = 2.301908

  Batch 0: Grad norm before clip = 3.117954
  Batch 10: Grad norm before clip = 2.314264
  Batch 20: Grad norm before clip = 2.301908
Train Loss: 0.365822, Cosine Sim: 0.7864
  Batch 0: Grad norm before clip = 3.117954
  Batch 10: Grad norm before clip = 2.314264
  Batch 20: Grad norm before clip = 2.301908
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.117954
  Batch 10: Grad norm before clip = 2.314264
  Batch 20: Grad norm before clip = 2.301908
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.30it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.29it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.28it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 0.703749, Cosine Sim: 0.6441, MSE: 0.7037
Learning Rate: 7.81e-07

Epoch 130/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.83s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 1.709229
  Batch 10: Grad norm before clip = 2.999136
  Batch 20: Grad norm before clip = 3.057910

  Batch 0: Grad norm before clip = 1.709229
  Batch 10: Grad norm before clip = 2.999136
  Batch 20: Grad norm before clip = 3.057910
  Batch 0: Grad norm before clip = 1.709229
  Batch 10: Grad norm before clip = 2.999136
  Batch 20: Grad norm before clip = 3.057910
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.709229
  Batch 10: Grad norm before clip = 2.999136
  Batch 20: Grad norm before clip = 3.057910
Train Loss: 0.360698, Cosine Sim: 0.7876
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.11s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.14s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.16s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.31it/s]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.20s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.20s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.26s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.27s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.24it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.65s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.65s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.66s/it]
Val Loss: 0.704878, Cosine Sim: 0.6433, MSE: 0.7049
Learning Rate: 3.91e-07
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_130.pt

Early stopping triggered after 130 epochs

Training complete!
Best validation cosine loss: 0.680278
Best validation cosine similarity: 0.6614
Best model saved to models/physics_v3_6_0.1/best_model.pt

Final learnable weights:
  Angle weight: 0.3395 (initial: 0.333)
  Dihedral weight: 0.3315 (initial: 0.333)
  Nonbonded weight: 0.3285 (initial: 0.333)
[rank1]:[E1110 22:20:38.045522288 ProcessGroupNCCL.cpp:616] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600025 milliseconds before timing out.
[rank1]:[E1110 22:20:38.049498290 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 1] Exception (either an error or timeout) detected by watchdog at work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank1]:[E1110 22:20:38.049519274 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 1] Timeout at NCCL work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank1]:[E1110 22:20:38.049527773 ProcessGroupNCCL.cpp:630] [Rank 1] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank1]:[E1110 22:20:38.049533997 ProcessGroupNCCL.cpp:636] [Rank 1] To avoid data inconsistency, we are taking the entire process down.
[rank1]:[E1110 22:20:38.052254951 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600025 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7fef48f6c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7feefe800a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7feefe807ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7feefe80993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7fef493ee5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7ff0efc94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7ff0efd26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600025 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7fef48f6c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7feefe800a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7feefe807ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7feefe80993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7fef493ee5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7ff0efc94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7ff0efd26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7fef48f6c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7feefe47eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7fef493ee5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7ff0efc94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7ff0efd26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[E1110 22:20:38.084126070 ProcessGroupNCCL.cpp:616] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600043 milliseconds before timing out.
[rank3]:[E1110 22:20:38.084391920 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 3] Exception (either an error or timeout) detected by watchdog at work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank3]:[E1110 22:20:38.094148604 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 3] Timeout at NCCL work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank3]:[E1110 22:20:38.094169137 ProcessGroupNCCL.cpp:630] [Rank 3] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank3]:[E1110 22:20:38.094177773 ProcessGroupNCCL.cpp:636] [Rank 3] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E1110 22:20:38.105809633 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600043 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6bd76b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6b8cc00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6b8cc07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6b8cc0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6bd7b005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6d7e094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6d7e126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600043 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6bd76b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6b8cc00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6b8cc07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6b8cc0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6bd7b005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6d7e094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6d7e126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6bd76b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7f6b8c87eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7f6bd7b005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7f6d7e094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7f6d7e126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E1110 22:20:38.138486582 ProcessGroupNCCL.cpp:616] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600058 milliseconds before timing out.
[rank2]:[E1110 22:20:38.143369455 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 2] Exception (either an error or timeout) detected by watchdog at work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank2]:[E1110 22:20:38.153321611 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 2] Timeout at NCCL work: 11836, last enqueued NCCL work: 11836, last completed NCCL work: 11835.
[rank2]:[E1110 22:20:38.153331372 ProcessGroupNCCL.cpp:630] [Rank 2] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E1110 22:20:38.153337477 ProcessGroupNCCL.cpp:636] [Rank 2] To avoid data inconsistency, we are taking the entire process down.
[rank2]:[E1110 22:20:38.164824881 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600058 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6b7076c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6b25c00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6b25c07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6b25c0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6b70c385c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6d17294ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6d17326a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=11836, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600058 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6b7076c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6b25c00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6b25c07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6b25c0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6b70c385c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6d17294ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6d17326a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6b7076c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7f6b2587eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7f6b70c385c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7f6d17294ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7f6d17326a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

W1110 22:20:38.927000 125261 site-packages/torch/multiprocessing/spawn.py:160] Terminating process 125363 via signal SIGTERM
W1110 22:20:38.927000 125261 site-packages/torch/multiprocessing/spawn.py:160] Terminating process 125364 via signal SIGTERM
Traceback (most recent call last):
  File "/personal/RNA-3E-FFI/scripts/04_train_model.py", line 1359, in <module>
    main()
  File "/personal/RNA-3E-FFI/scripts/04_train_model.py", line 1346, in main
    mp.spawn(
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 328, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 284, in start_processes
    while not context.join():
              ^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 184, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 1 terminated with signal SIGABRT
/opt/mamba/envs/RNA/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 3 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '

Training completed!
