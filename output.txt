nohup: ignoring input
==========================================
Training with Memory Optimization
==========================================
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(

Starting distributed training with 4 GPUs...
Spawning processes...

/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
[rank2]:[W1109 19:07:42.432891699 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank3]:[W1109 19:07:42.626043380 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank1]:[W1109 19:07:42.973809244 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank0]:[W1109 19:07:42.040766689 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/personal/RNA-3E-FFI/scripts/04_train_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(graph_path)
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes
Using device: cuda:0
Distributed training with 4 GPUs
Loading splits from data/splits/filtered_splits.json
Dataset splits: Train=954, Val=117, Test=122
Dataset initialized with 954 valid complexes
Dataset initialized with 117 valid complexes

Initializing v3.0 model (with V3 improvements)...
Using RNAPocketEncoderV3 (geometric MP + enhanced invariants + multi-head attention)
  Geometric MP: True
  Enhanced invariants: True (206-dim vs 56-dim)
  Attention heads: 4
Model has 3,329,309 parameters

Model configuration:
  Multi-hop: True
  Non-bonded: True
  Pooling: attention
  Initial angle weight: 0.333
  Initial dihedral weight: 0.333
  Initial nonbonded weight: 0.333

Starting training from scratch...


============================================================
Training Configuration
============================================================
Batch Size per GPU: 8
Number of GPUs: 4
Effective Batch Size: 32

Mixed Precision Training (AMP): Disabled

Loss Function: mse

Gradient Clipping: 1.0 (manual)
Gradient Monitoring: ENABLED (will print every 50 batches)
============================================================

Starting training...

Epoch 1/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:326: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):



  Batch 0: Grad norm before clip = 0.775254

  Batch 0: Grad norm before clip = 0.775254
  Batch 0: Grad norm before clip = 0.775254

Train Loss: 1.718242, Cosine Sim: 0.0717

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:468: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:468: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:468: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):
/personal/RNA-3E-FFI/scripts/04_train_model.py:468: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=use_amp):




Val Loss: 1.972626, Cosine Sim: 0.0539, MSE: 1.9726
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 2/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)







  Batch 0: Grad norm before clip = 1.143496
Train Loss: 1.659412, Cosine Sim: 0.1459

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.946876, Cosine Sim: 0.0714, MSE: 1.9469
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 3/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)



  Batch 0: Grad norm before clip = 0.489511
Train Loss: 1.596771, Cosine Sim: 0.1941

  Batch 0: Grad norm before clip = 0.489511
  Batch 0: Grad norm before clip = 0.489511


  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.924647, Cosine Sim: 0.0797, MSE: 1.9246
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 4/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




  Batch 0: Grad norm before clip = 0.685128


  Batch 0: Grad norm before clip = 0.685128
Train Loss: 1.576767, Cosine Sim: 0.1859

  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.903878, Cosine Sim: 0.0781, MSE: 1.9039
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 5/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)


  Batch 0: Grad norm before clip = 0.414778



Train Loss: 1.536306, Cosine Sim: 0.1953
  Batch 0: Grad norm before clip = 0.414778


  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.865820, Cosine Sim: 0.0865, MSE: 1.8658
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_5.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 6/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)


  Batch 0: Grad norm before clip = 0.468278



  Batch 0: Grad norm before clip = 0.468278
Train Loss: 1.541743, Cosine Sim: 0.1939
  Batch 0: Grad norm before clip = 0.468278

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.685156, Cosine Sim: 0.1480, MSE: 1.6852
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 7/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)





  Batch 0: Grad norm before clip = 4.415441
Train Loss: 1.414543, Cosine Sim: 0.2171



  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.770255, Cosine Sim: 0.1150, MSE: 1.7703
Learning Rate: 2.00e-04

Epoch 8/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)


  Batch 0: Grad norm before clip = 2.530761
Train Loss: 1.404553, Cosine Sim: 0.2411



  Batch 0: Grad norm before clip = 2.530761


  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.648699, Cosine Sim: 0.1669, MSE: 1.6487
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 9/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)



  Batch 0: Grad norm before clip = 8.044865
Train Loss: 1.331746, Cosine Sim: 0.2612


  Batch 0: Grad norm before clip = 8.044865
  Batch 0: Grad norm before clip = 8.044865

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)




Val Loss: 1.452635, Cosine Sim: 0.2543, MSE: 1.4526
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 10/300
------------------------------------------------------------

  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 5.056432

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.056432
  Batch 0: Grad norm before clip = 5.056432
Train Loss: 1.297101, Cosine Sim: 0.2875
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.056432
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.393821, Cosine Sim: 0.2697, MSE: 1.3938
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_10.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 11/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.12it/s]Training:  47%|████▋     | 14/30 [00:15<00:14,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.12it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.16it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.10it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.14it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.12it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.12it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.12it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  70%|███████   | 21/30 [00:22<00:08,  1.11it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 1.969640
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.969640
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 1.969640
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.969640
Train Loss: 1.244334, Cosine Sim: 0.3022
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.443329, Cosine Sim: 0.2468, MSE: 1.4433
Learning Rate: 2.00e-04

Epoch 12/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.64s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.39it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.39it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.39it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.39it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.271082

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.271082
  Batch 0: Grad norm before clip = 2.271082
Train Loss: 1.347272, Cosine Sim: 0.2428
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.271082
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.481997, Cosine Sim: 0.2239, MSE: 1.4820
Learning Rate: 2.00e-04

Epoch 13/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.11it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.13it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 1.162324

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.162324
  Batch 0: Grad norm before clip = 1.162324
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.162324
Train Loss: 1.246023, Cosine Sim: 0.2859
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.404761, Cosine Sim: 0.2676, MSE: 1.4048
Learning Rate: 2.00e-04

Epoch 14/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.51s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.036652

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.036652
  Batch 0: Grad norm before clip = 2.036652
  Batch 0: Grad norm before clip = 2.036652
Train Loss: 1.257266, Cosine Sim: 0.2952
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]

Val Loss: 1.341303, Cosine Sim: 0.2978, MSE: 1.3413
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 15/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  60%|██████    | 18/30 [00:18<00:10,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:02,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:24<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 1.489959

Training: 100%|██████████| 30/30 [00:28<00:00,  1.03it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.489959
  Batch 0: Grad norm before clip = 1.489959
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.489959
Train Loss: 1.223586, Cosine Sim: 0.3163
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.644706, Cosine Sim: 0.1632, MSE: 1.6447
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_15.pt

Epoch 16/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:48,  5.82s/it]Training:   3%|▎         | 1/30 [00:05<02:48,  5.82s/it]Training:   3%|▎         | 1/30 [00:05<02:48,  5.83s/it]Training:   3%|▎         | 1/30 [00:05<02:48,  5.83s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.24it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 10.116881

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.116881
Train Loss: 1.230431, Cosine Sim: 0.2973
  Batch 0: Grad norm before clip = 10.116881
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.116881
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Val Loss: 1.250855, Cosine Sim: 0.3513, MSE: 1.2509
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 17/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 5.346164
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.346164
  Batch 0: Grad norm before clip = 5.346164
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.346164
Train Loss: 1.227415, Cosine Sim: 0.3027
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.275796, Cosine Sim: 0.3242, MSE: 1.2758
Learning Rate: 2.00e-04

Epoch 18/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  80%|████████  | 24/30 [00:23<00:05,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.19it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

  Batch 0: Grad norm before clip = 2.289740
  Batch 0: Grad norm before clip = 2.289740
  Batch 0: Grad norm before clip = 2.289740
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.289740
Train Loss: 1.221214, Cosine Sim: 0.3197
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Val Loss: 1.214174, Cosine Sim: 0.3734, MSE: 1.2142
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 19/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

  Batch 0: Grad norm before clip = 4.972566
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 4.972566

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.972566
Train Loss: 1.289727, Cosine Sim: 0.2902
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.972566
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.288098, Cosine Sim: 0.3213, MSE: 1.2881
Learning Rate: 2.00e-04

Epoch 20/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 4.963557

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.963557
Train Loss: 1.189751, Cosine Sim: 0.3199
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.963557
  Batch 0: Grad norm before clip = 4.963557
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Val Loss: 1.241536, Cosine Sim: 0.3485, MSE: 1.2415
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_20.pt

Epoch 21/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.79s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.334164
Train Loss: 1.162848, Cosine Sim: 0.3116

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.334164
  Batch 0: Grad norm before clip = 2.334164
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.334164
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.278221, Cosine Sim: 0.3362, MSE: 1.2782
Learning Rate: 2.00e-04

Epoch 22/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.22it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 2.113907

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.113907
Train Loss: 1.208039, Cosine Sim: 0.3093
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 2.113907
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.113907
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.03s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.15s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.51s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.201565, Cosine Sim: 0.3707, MSE: 1.2016
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 23/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.39it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 3.096175
  Batch 0: Grad norm before clip = 3.096175
  Batch 0: Grad norm before clip = 3.096175
Train Loss: 1.025146, Cosine Sim: 0.3906
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.096175
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Val Loss: 1.201110, Cosine Sim: 0.3696, MSE: 1.2011
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 24/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   3%|▎         | 1/30 [00:08<04:07,  8.55s/it]Training:   3%|▎         | 1/30 [00:08<04:08,  8.55s/it]Training:   3%|▎         | 1/30 [00:08<04:08,  8.55s/it]Training:   7%|▋         | 2/30 [00:09<01:49,  3.93s/it]Training:   7%|▋         | 2/30 [00:09<01:49,  3.93s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:09<01:49,  3.93s/it]Training:  10%|█         | 3/30 [00:10<01:07,  2.49s/it]Training:  10%|█         | 3/30 [00:10<01:07,  2.49s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:10<01:07,  2.49s/it]Training:  13%|█▎        | 4/30 [00:10<00:47,  1.83s/it]Training:  13%|█▎        | 4/30 [00:10<00:47,  1.83s/it]Training:  13%|█▎        | 4/30 [00:10<00:47,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:11<00:37,  1.49s/it]Training:  17%|█▋        | 5/30 [00:11<00:37,  1.50s/it]Training:  17%|█▋        | 5/30 [00:11<00:37,  1.50s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:12<00:31,  1.29s/it]Training:  20%|██        | 6/30 [00:12<00:31,  1.30s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:12<00:31,  1.30s/it]Training:  23%|██▎       | 7/30 [00:13<00:27,  1.17s/it]Training:  23%|██▎       | 7/30 [00:13<00:27,  1.17s/it]Training:  23%|██▎       | 7/30 [00:10<00:24,  1.06s/it]Training:  23%|██▎       | 7/30 [00:13<00:27,  1.17s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:14<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:14<00:22,  1.01s/it]Training:  27%|██▋       | 8/30 [00:14<00:22,  1.01s/it]Training:  30%|███       | 9/30 [00:14<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:14<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:14<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:15<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:15<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:15<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:16<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:16<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:16<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:17<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:17<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:17<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:18<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:18<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:18<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:18<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:18<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:18<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:19<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:19<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:19<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:20<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:20<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:20<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:21<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:21<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:21<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:22<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:22<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:22<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:22<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:22<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:22<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.34it/s]Training:  67%|██████▋   | 20/30 [00:23<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:23<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:23<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:24<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:24<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:24<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:25<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:25<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.14it/s]Training:  73%|███████▎  | 22/30 [00:25<00:07,  1.14it/s]Training:  77%|███████▋  | 23/30 [00:26<00:06,  1.10it/s]Training:  77%|███████▋  | 23/30 [00:26<00:06,  1.10it/s]Training:  77%|███████▋  | 23/30 [00:26<00:06,  1.10it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.10it/s]Training:  80%|████████  | 24/30 [00:27<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:27<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.14it/s]Training:  80%|████████  | 24/30 [00:27<00:05,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:28<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:28<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:28<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:28<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:28<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:28<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:29<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:29<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:29<00:02,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:30<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:30<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:30<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:31<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:31<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:31<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:32<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:32<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:32<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:33<00:00,  1.11s/it]
Training: 100%|██████████| 30/30 [00:33<00:00,  1.11s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 6.356577

Training: 100%|██████████| 30/30 [00:33<00:00,  1.11s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.356577
  Batch 0: Grad norm before clip = 6.356577
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.356577
Train Loss: 1.019947, Cosine Sim: 0.4012
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.176039, Cosine Sim: 0.3843, MSE: 1.1760
Learning Rate: 2.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 25/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.16s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 18.217217
Train Loss: 1.065508, Cosine Sim: 0.3701

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 18.217217
  Batch 0: Grad norm before clip = 18.217217
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 18.217217
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.263897, Cosine Sim: 0.3462, MSE: 1.2639
Learning Rate: 2.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_25.pt

Epoch 26/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:07<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 10.087660
  Batch 0: Grad norm before clip = 10.087660
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.087660
  Batch 0: Grad norm before clip = 10.087660
Train Loss: 1.080855, Cosine Sim: 0.3838
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.370397, Cosine Sim: 0.2724, MSE: 1.3704
Learning Rate: 2.00e-04

Epoch 27/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.30s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.30s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.609051

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.609051
  Batch 0: Grad norm before clip = 2.609051
Train Loss: 1.061926, Cosine Sim: 0.3498
  Batch 0: Grad norm before clip = 2.609051
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.202622, Cosine Sim: 0.3821, MSE: 1.2026
Learning Rate: 2.00e-04

Epoch 28/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.22it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.44it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.44it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.44it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.44it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.44it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.43it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 3.409770
Train Loss: 1.136693, Cosine Sim: 0.3467
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.409770
  Batch 0: Grad norm before clip = 3.409770
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.409770
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.280117, Cosine Sim: 0.3285, MSE: 1.2801
Learning Rate: 2.00e-04

Epoch 29/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  67%|██████▋   | 20/30 [00:19<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:19<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:19<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:19<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.18it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]

Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]  Batch 0: Grad norm before clip = 1.847350

  Batch 0: Grad norm before clip = 1.847350
  Batch 0: Grad norm before clip = 1.847350
Train Loss: 1.069236, Cosine Sim: 0.3804
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.847350
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.183683, Cosine Sim: 0.3813, MSE: 1.1837
Learning Rate: 2.00e-04

Epoch 30/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.37s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.38s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.31s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.04it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.242390
Train Loss: 1.090198, Cosine Sim: 0.3575
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.242390
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.242390
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.242390
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.75s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.79s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.23it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Val Loss: 1.326782, Cosine Sim: 0.3067, MSE: 1.3268
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_30.pt

Epoch 31/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.16it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 3.710765

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.710765
Train Loss: 1.083703, Cosine Sim: 0.3692
  Batch 0: Grad norm before clip = 3.710765
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.710765
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.02s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.38s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.18it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.219554, Cosine Sim: 0.3645, MSE: 1.2196
Learning Rate: 1.00e-04

Epoch 32/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.03it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.06it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.13it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.19it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.15it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 50.940726

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 50.940726
  Batch 0: Grad norm before clip = 50.940726
Train Loss: 1.037866, Cosine Sim: 0.4017
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 50.940726
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.152851, Cosine Sim: 0.3959, MSE: 1.1529
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 33/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.31s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.31s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.31s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.31s/it]Training:  17%|█▋        | 5/30 [00:08<00:27,  1.11s/it]Training:  17%|█▋        | 5/30 [00:08<00:27,  1.11s/it]Training:  17%|█▋        | 5/30 [00:08<00:27,  1.11s/it]Training:  17%|█▋        | 5/30 [00:08<00:27,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.12it/s]Training:  40%|████      | 12/30 [00:13<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:13<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:13<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:13<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 1.651394

Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 1.651394
Train Loss: 1.126774, Cosine Sim: 0.3687
  Batch 0: Grad norm before clip = 1.651394
  Batch 0: Grad norm before clip = 1.651394
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.164893, Cosine Sim: 0.3853, MSE: 1.1649
Learning Rate: 1.00e-04

Epoch 34/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.00it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.07it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.36it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.38it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.38it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.38it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.38it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.36it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 5.088571
Train Loss: 1.068150, Cosine Sim: 0.3642

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.088571
  Batch 0: Grad norm before clip = 5.088571
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.088571
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  5.00s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.02s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.02s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.12s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.21s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.18it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.172932, Cosine Sim: 0.3811, MSE: 1.1729
Learning Rate: 1.00e-04

Epoch 35/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.96s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.96s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.96s/it]Training:   7%|▋         | 2/30 [00:06<01:22,  2.96s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.94s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.31it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.35it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.33it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.031221
Train Loss: 1.001291, Cosine Sim: 0.4107

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.031221
  Batch 0: Grad norm before clip = 2.031221
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.031221
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Val Loss: 1.147742, Cosine Sim: 0.4023, MSE: 1.1477
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_35.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 36/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.14s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  23%|██▎       | 7/30 [00:09<00:20,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.27it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.27it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.27it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.28it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.29it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.29it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.29it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.29it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.33it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.33it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.33it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:16<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.19it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 6.559167

  Batch 0: Grad norm before clip = 6.559167
  Batch 0: Grad norm before clip = 6.559167
Train Loss: 1.031065, Cosine Sim: 0.4081
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.559167
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.51s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.135972, Cosine Sim: 0.4047, MSE: 1.1360
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 37/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.53s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.08it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.14it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.16it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.16it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.16it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.16it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 5.690914

  Batch 0: Grad norm before clip = 5.690914
  Batch 0: Grad norm before clip = 5.690914
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.690914
Train Loss: 1.054643, Cosine Sim: 0.3898
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.178032, Cosine Sim: 0.3897, MSE: 1.1780
Learning Rate: 1.00e-04

Epoch 38/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.49s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.35it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.35it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.192937

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.192937
  Batch 0: Grad norm before clip = 3.192937
Train Loss: 0.981130, Cosine Sim: 0.4319
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.192937
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Val Loss: 1.119714, Cosine Sim: 0.4093, MSE: 1.1197
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 39/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.23it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.27it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.27it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.27it/s]Training:  37%|███▋      | 11/30 [00:12<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.36it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.31it/s]Training:  70%|███████   | 21/30 [00:20<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
  Batch 0: Grad norm before clip = 3.219313
Train Loss: 1.051949, Cosine Sim: 0.4065

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.219313
  Batch 0: Grad norm before clip = 3.219313
  Batch 0: Grad norm before clip = 3.219313
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.162818, Cosine Sim: 0.3706, MSE: 1.1628
Learning Rate: 1.00e-04

Epoch 40/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.16it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 9.159591

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 9.159591
  Batch 0: Grad norm before clip = 9.159591
Train Loss: 0.968187, Cosine Sim: 0.4014
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.159591
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.093066, Cosine Sim: 0.4188, MSE: 1.0931
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_40.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 41/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.52s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 4.602087

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.602087
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.602087
  Batch 0: Grad norm before clip = 4.602087
Train Loss: 0.986957, Cosine Sim: 0.4056
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.118139, Cosine Sim: 0.4061, MSE: 1.1181
Learning Rate: 1.00e-04

Epoch 42/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:21<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.31it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 1.721669

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.721669
  Batch 0: Grad norm before clip = 1.721669
  Batch 0: Grad norm before clip = 1.721669
Train Loss: 0.990438, Cosine Sim: 0.4035
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.307383, Cosine Sim: 0.2697, MSE: 1.3074
Learning Rate: 1.00e-04

Epoch 43/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.35it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.37it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]  Batch 0: Grad norm before clip = 6.318288

Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.318288
  Batch 0: Grad norm before clip = 6.318288
  Batch 0: Grad norm before clip = 6.318288
Train Loss: 0.991793, Cosine Sim: 0.4241
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.113196, Cosine Sim: 0.4007, MSE: 1.1132
Learning Rate: 1.00e-04

Epoch 44/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.483814

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.483814
  Batch 0: Grad norm before clip = 2.483814
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.483814
Train Loss: 0.838212, Cosine Sim: 0.5109
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.058871, Cosine Sim: 0.4371, MSE: 1.0589
Learning Rate: 1.00e-04
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 45/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.32it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.37it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.37it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.37it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.37it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.40it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.40it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.40it/s]Training:  60%|██████    | 18/30 [00:18<00:08,  1.40it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.039788

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.039788
Train Loss: 0.943900, Cosine Sim: 0.4346
  Batch 0: Grad norm before clip = 2.039788
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.039788
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.055844, Cosine Sim: 0.4363, MSE: 1.0558
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_45.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 46/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.39s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:   7%|▋         | 2/30 [00:06<01:13,  2.64s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 10.747805
Train Loss: 1.003247, Cosine Sim: 0.4150

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 10.747805
  Batch 0: Grad norm before clip = 10.747805
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 10.747805
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.00s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.01s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.02s/it]Evaluating:  25%|██▌       | 1/4 [00:05<00:15,  5.04s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.13s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.38s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.38s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.38s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.18it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.06it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.06it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.60s/it]

Val Loss: 1.102349, Cosine Sim: 0.4042, MSE: 1.1023
Learning Rate: 1.00e-04

Epoch 47/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.11it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.09it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.09it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.18it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.15it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.15it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 3.593867

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.593867
Train Loss: 0.940732, Cosine Sim: 0.4328
  Batch 0: Grad norm before clip = 3.593867
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.593867
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.166082, Cosine Sim: 0.3650, MSE: 1.1661
Learning Rate: 1.00e-04

Epoch 48/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.62s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.78s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.08it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.16it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.19it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 2.085718

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.085718
  Batch 0: Grad norm before clip = 2.085718
  Batch 0: Grad norm before clip = 2.085718
Train Loss: 1.083391, Cosine Sim: 0.3376
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.95s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.305297, Cosine Sim: 0.2885, MSE: 1.3053
Learning Rate: 1.00e-04

Epoch 49/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.35s/it]Training:   3%|▎         | 1/30 [00:05<02:35,  5.36s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 7.359975
Train Loss: 1.019244, Cosine Sim: 0.4091

  Batch 0: Grad norm before clip = 7.359975
  Batch 0: Grad norm before clip = 7.359975
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.359975
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.134778, Cosine Sim: 0.3771, MSE: 1.1348
Learning Rate: 1.00e-04

Epoch 50/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it]Training:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.14it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.14it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.14it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.22it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]  Batch 0: Grad norm before clip = 1.808465

Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 1.808465
Train Loss: 0.920718, Cosine Sim: 0.4352
  Batch 0: Grad norm before clip = 1.808465
  Batch 0: Grad norm before clip = 1.808465
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.115971, Cosine Sim: 0.4000, MSE: 1.1160
Learning Rate: 1.00e-04
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_50.pt

Epoch 51/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  10%|█         | 3/30 [00:07<00:52,  1.95s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.19it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

  Batch 0: Grad norm before clip = 6.544120
  Batch 0: Grad norm before clip = 6.544120
Train Loss: 0.929601, Cosine Sim: 0.4454
  Batch 0: Grad norm before clip = 6.544120
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.544120
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.281780, Cosine Sim: 0.3015, MSE: 1.2818
Learning Rate: 5.00e-05

Epoch 52/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.71s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.78s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  13%|█▎        | 4/30 [00:07<00:34,  1.34s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.11it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.35it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.15it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 3.594572

  Batch 0: Grad norm before clip = 3.594572
  Batch 0: Grad norm before clip = 3.594572
Train Loss: 0.898765, Cosine Sim: 0.4703
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.594572
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.74s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.01s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.15s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.238094, Cosine Sim: 0.3247, MSE: 1.2381
Learning Rate: 5.00e-05

Epoch 53/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.03s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.08it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.19it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]
  Batch 0: Grad norm before clip = 3.240297

Training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 3.240297
  Batch 0: Grad norm before clip = 3.240297
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.240297
Train Loss: 0.826167, Cosine Sim: 0.4653
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.280126, Cosine Sim: 0.2992, MSE: 1.2801
Learning Rate: 5.00e-05

Epoch 54/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.75s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.02s/it]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:09<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.37it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.37it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.37it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.37it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.33it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.16it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.689982
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.689982
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.689982
  Batch 0: Grad norm before clip = 3.689982
Train Loss: 0.928548, Cosine Sim: 0.4222
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.197774, Cosine Sim: 0.3462, MSE: 1.1978
Learning Rate: 5.00e-05

Epoch 55/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

  Batch 0: Grad norm before clip = 15.435419
Train Loss: 0.879703, Cosine Sim: 0.4758
  Batch 0: Grad norm before clip = 15.435419
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 15.435419
  Batch 0: Grad norm before clip = 15.435419
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.055465, Cosine Sim: 0.4241, MSE: 1.0555
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_55.pt
New best model! Saved to models/physics_v3_6_0.1/best_model.pt

Epoch 56/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.28s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:08<00:32,  1.29s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:11<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:11<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:11<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:11<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  80%|████████  | 24/30 [00:24<00:05,  1.18it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.17it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.837107

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.837107
  Batch 0: Grad norm before clip = 2.837107
Train Loss: 0.919594, Cosine Sim: 0.4535
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.837107
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.069074, Cosine Sim: 0.4168, MSE: 1.0691
Learning Rate: 5.00e-05

Epoch 57/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.57s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.76s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.07it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.27it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 9.391937
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.391937
  Batch 0: Grad norm before clip = 9.391937
  Batch 0: Grad norm before clip = 9.391937
Train Loss: 0.847126, Cosine Sim: 0.4721
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.52s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.118389, Cosine Sim: 0.4013, MSE: 1.1184
Learning Rate: 5.00e-05

Epoch 58/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.05it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:13<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.31it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.39it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.39it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.39it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.39it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.30it/s]Training:  53%|█████▎    | 16/30 [00:16<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:20<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.17it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.16it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.023306
Train Loss: 0.868161, Cosine Sim: 0.4780

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.023306
  Batch 0: Grad norm before clip = 3.023306
  Batch 0: Grad norm before clip = 3.023306
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.120184, Cosine Sim: 0.3917, MSE: 1.1202
Learning Rate: 5.00e-05

Epoch 59/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.84s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.23it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.33it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.29it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.11it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 3.203456

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.203456
  Batch 0: Grad norm before clip = 3.203456
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.203456
Train Loss: 0.995308, Cosine Sim: 0.4199
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.181292, Cosine Sim: 0.3658, MSE: 1.1813
Learning Rate: 5.00e-05

Epoch 60/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:   7%|▋         | 2/30 [00:06<01:17,  2.77s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.20it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.07it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.07it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.07it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.06it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.10it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.10it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.18it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 6.519302

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]  Batch 0: Grad norm before clip = 6.519302
Train Loss: 0.911194, Cosine Sim: 0.4490

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 6.519302
  Batch 0: Grad norm before clip = 6.519302
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.77s/it]/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.51s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 1.134964, Cosine Sim: 0.3853, MSE: 1.1350
Learning Rate: 5.00e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_60.pt

Epoch 61/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.06s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.12it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.12it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.12it/s]Training:  70%|███████   | 21/30 [00:21<00:08,  1.12it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  73%|███████▎  | 22/30 [00:22<00:07,  1.13it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.26it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.676254
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.676254
  Batch 0: Grad norm before clip = 3.676254
  Batch 0: Grad norm before clip = 3.676254
Train Loss: 0.851878, Cosine Sim: 0.4897
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Val Loss: 1.137070, Cosine Sim: 0.3867, MSE: 1.1371
Learning Rate: 2.50e-05

Epoch 62/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.15s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.16it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.18it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.232511
Train Loss: 0.871784, Cosine Sim: 0.4678
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.232511
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.232511
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.232511
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Val Loss: 1.133814, Cosine Sim: 0.3863, MSE: 1.1338
Learning Rate: 2.50e-05

Epoch 63/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.24s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.23it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.15it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.358488

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.358488
Train Loss: 0.970864, Cosine Sim: 0.4169
  Batch 0: Grad norm before clip = 2.358488
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.358488
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.122063, Cosine Sim: 0.3884, MSE: 1.1221
Learning Rate: 2.50e-05

Epoch 64/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.86s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.10it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.15it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:11,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
  Batch 0: Grad norm before clip = 7.195181

  Batch 0: Grad norm before clip = 7.195181
Train Loss: 0.919567, Cosine Sim: 0.4538
  Batch 0: Grad norm before clip = 7.195181
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.195181
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.102653, Cosine Sim: 0.4003, MSE: 1.1027
Learning Rate: 2.50e-05

Epoch 65/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:44,  5.67s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   3%|▎         | 1/30 [00:05<02:44,  5.68s/it]Training:   3%|▎         | 1/30 [00:05<02:45,  5.69s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:21,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.05it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.08it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:14<00:16,  1.08it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.17it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:17<00:13,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.11it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.11it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.11it/s]Training:  53%|█████▎    | 16/30 [00:18<00:12,  1.11it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  57%|█████▋    | 17/30 [00:19<00:11,  1.12it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.14it/s]Training:  60%|██████    | 18/30 [00:20<00:10,  1.14it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:23<00:06,  1.20it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.28it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.29it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:27<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.35it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]  Batch 0: Grad norm before clip = 5.729234


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.729234
  Batch 0: Grad norm before clip = 5.729234
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.729234
Train Loss: 0.855701, Cosine Sim: 0.4653
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.81s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Val Loss: 1.101215, Cosine Sim: 0.4018, MSE: 1.1012
Learning Rate: 2.50e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_65.pt

Epoch 66/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.53s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.26s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.04s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:22,  1.02s/it]Training:  30%|███       | 9/30 [00:12<00:20,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.01it/s]Training:  30%|███       | 9/30 [00:12<00:20,  1.01it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  33%|███▎      | 10/30 [00:13<00:19,  1.04it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  37%|███▋      | 11/30 [00:14<00:17,  1.08it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  40%|████      | 12/30 [00:15<00:16,  1.09it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:16<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.30it/s]Training:  50%|█████     | 15/30 [00:17<00:11,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  63%|██████▎   | 19/30 [00:20<00:09,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:26<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.35it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.972946
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 2.972946

  Batch 0: Grad norm before clip = 2.972946
Train Loss: 0.882033, Cosine Sim: 0.4635
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.972946
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.78s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.31s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.51s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.103908, Cosine Sim: 0.3985, MSE: 1.1039
Learning Rate: 2.50e-05

Epoch 67/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.50s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.80s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.00s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.30it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.28it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.508024
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 2.508024
Train Loss: 0.821376, Cosine Sim: 0.4871
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.508024
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.508024
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Val Loss: 1.094795, Cosine Sim: 0.4021, MSE: 1.0948
Learning Rate: 1.25e-05

Epoch 68/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.61s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.73s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.00it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.36it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.36it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.36it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.36it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.981339

Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.981339
  Batch 0: Grad norm before clip = 2.981339
Train Loss: 0.823177, Cosine Sim: 0.5193
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.981339
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.094939, Cosine Sim: 0.4000, MSE: 1.0949
Learning Rate: 1.25e-05

Epoch 69/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.01s/it]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:10<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.10it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.14it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.08it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.16it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.31it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.24it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 4.786892

  Batch 0: Grad norm before clip = 4.786892
  Batch 0: Grad norm before clip = 4.786892
Train Loss: 0.855727, Cosine Sim: 0.4802
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.786892
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.106320, Cosine Sim: 0.3955, MSE: 1.1063
Learning Rate: 1.25e-05

Epoch 70/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.79s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.92s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  13%|█▎        | 4/30 [00:08<00:39,  1.50s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  17%|█▋        | 5/30 [00:09<00:31,  1.28s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.11it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.11it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.34it/s]Training:  60%|██████    | 18/30 [00:19<00:08,  1.34it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.30it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  73%|███████▎  | 22/30 [00:22<00:05,  1.34it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.30it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 9.592797


Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.592797
Train Loss: 0.892810, Cosine Sim: 0.4680
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.592797
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 9.592797
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.128891, Cosine Sim: 0.3886, MSE: 1.1289
Learning Rate: 1.25e-05
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_70.pt

Epoch 71/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.11s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.12s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.27it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.37it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.37it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.37it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.37it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.31it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.39it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.39it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.39it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.39it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.29it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.29it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.26it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.30it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
  Batch 0: Grad norm before clip = 3.754152
Train Loss: 0.861213, Cosine Sim: 0.4738

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.754152
  Batch 0: Grad norm before clip = 3.754152
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 3.754152
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.83s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.34it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.094887, Cosine Sim: 0.3997, MSE: 1.0949
Learning Rate: 1.25e-05

Epoch 72/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.44s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  10%|█         | 3/30 [00:06<00:49,  1.82s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.25s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:27,  1.13s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.12it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.21it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:10,  1.18it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.16it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.29it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.457742
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 2.457742

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.457742
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.457742
Train Loss: 0.908191, Cosine Sim: 0.4277
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.11s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.20s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.59s/it]
Val Loss: 1.102474, Cosine Sim: 0.3983, MSE: 1.1025
Learning Rate: 1.25e-05

Epoch 73/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.41s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.05s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  50%|█████     | 15/30 [00:16<00:13,  1.15it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.13it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.17it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.15it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:25<00:02,  1.35it/s]Training:  87%|████████▋ | 26/30 [00:25<00:02,  1.35it/s]Training:  87%|████████▋ | 26/30 [00:25<00:02,  1.34it/s]Training:  87%|████████▋ | 26/30 [00:25<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.708177
Train Loss: 0.802904, Cosine Sim: 0.5011

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.708177
  Batch 0: Grad norm before clip = 2.708177
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.708177
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.096952, Cosine Sim: 0.4019, MSE: 1.0970
Learning Rate: 6.25e-06

Epoch 74/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.37s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.23s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.10s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.13it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.18it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.16it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.15it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.25it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.24it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  63%|██████▎   | 19/30 [00:19<00:09,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.22it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.37it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.36it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.36it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.36it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.33it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.33it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.35it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 50.112395

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 50.112395
  Batch 0: Grad norm before clip = 50.112395
  Batch 0: Grad norm before clip = 50.112395
Train Loss: 0.789542, Cosine Sim: 0.5007
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.104349, Cosine Sim: 0.3985, MSE: 1.1043
Learning Rate: 6.25e-06

Epoch 75/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.65s/it]Training:   3%|▎         | 1/30 [00:05<02:43,  5.63s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.39s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.40s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.16s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.17s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.09it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.20it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.20it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.20it/s]Training:  27%|██▋       | 8/30 [00:10<00:18,  1.20it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.22it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.15it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.13it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.14it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.16it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  53%|█████▎    | 16/30 [00:17<00:12,  1.14it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.14it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.20it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.22it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.26it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.31it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.00it/s]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
  Batch 0: Grad norm before clip = 2.076439
Train Loss: 0.813514, Cosine Sim: 0.4888

Training: 100%|██████████| 30/30 [00:30<00:00,  1.00s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.076439
  Batch 0: Grad norm before clip = 2.076439
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.076439
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.19it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.101009, Cosine Sim: 0.3989, MSE: 1.1010
Learning Rate: 6.25e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_75.pt

Epoch 76/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.48s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.67s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.76s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.35s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  17%|█▋        | 5/30 [00:08<00:31,  1.27s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.06it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.10it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:18,  1.09it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:18<00:09,  1.34it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.26it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.37it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.29it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.24it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.28it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.21it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]  Batch 0: Grad norm before clip = 4.830779

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 4.830779
  Batch 0: Grad norm before clip = 4.830779
  Batch 0: Grad norm before clip = 4.830779
Train Loss: 0.816673, Cosine Sim: 0.4970
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.102687, Cosine Sim: 0.3986, MSE: 1.1027
Learning Rate: 6.25e-06

Epoch 77/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.43s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.65s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.66s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.80s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:36,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.42s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.02it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.11it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.21it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.26it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.29it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.29it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.29it/s]Training:  40%|████      | 12/30 [00:13<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:17<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.26it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.32it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.34it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.30it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:24<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.25it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.32it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.40it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.40it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.40it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.40it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.38it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
  Batch 0: Grad norm before clip = 8.949574
  Batch 0: Grad norm before clip = 8.949574
Train Loss: 0.792761, Cosine Sim: 0.4940
Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.04it/s]  Batch 0: Grad norm before clip = 8.949574

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 8.949574
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.109757, Cosine Sim: 0.3969, MSE: 1.1098
Learning Rate: 6.25e-06

Epoch 78/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:47,  5.77s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.77s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.89s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.21s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.16it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  30%|███       | 9/30 [00:11<00:16,  1.24it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  33%|███▎      | 10/30 [00:12<00:15,  1.27it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.25it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.26it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  43%|████▎     | 13/30 [00:14<00:13,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  47%|████▋     | 14/30 [00:15<00:13,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.24it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.28it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.24it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.18it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  77%|███████▋  | 23/30 [00:23<00:06,  1.16it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.19it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.20it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.25it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.686316

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.686316
  Batch 0: Grad norm before clip = 2.686316
  Batch 0: Grad norm before clip = 2.686316
Train Loss: 0.871580, Cosine Sim: 0.4623
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.73s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.30s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.50s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.117283, Cosine Sim: 0.3930, MSE: 1.1173
Learning Rate: 6.25e-06

Epoch 79/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.82s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.82s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.84s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.83s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.43s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.18s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.01s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.12it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.24it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.26it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.20it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.19it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.25it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.26it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.17it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.23it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.30it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.21it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 2.782721

Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.782721
Train Loss: 0.846300, Cosine Sim: 0.4673
  Batch 0: Grad norm before clip = 2.782721
  Batch 0: Grad norm before clip = 2.782721
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.125068, Cosine Sim: 0.3869, MSE: 1.1251
Learning Rate: 3.13e-06

Epoch 80/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.54s/it]Training:   3%|▎         | 1/30 [00:05<02:40,  5.55s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.75s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.87s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.46s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.07s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.01it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.09it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  30%|███       | 9/30 [00:11<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.17it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.16it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.24it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.28it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  43%|████▎     | 13/30 [00:14<00:12,  1.33it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  47%|████▋     | 14/30 [00:15<00:11,  1.34it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.28it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.26it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.29it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  67%|██████▋   | 20/30 [00:20<00:07,  1.28it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  70%|███████   | 21/30 [00:21<00:06,  1.30it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.32it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.30it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.33it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.27it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.26it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.24it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]  Batch 0: Grad norm before clip = 7.119646

Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 7.119646
  Batch 0: Grad norm before clip = 7.119646
  Batch 0: Grad norm before clip = 7.119646
Train Loss: 0.861892, Cosine Sim: 0.4573
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.85s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.32s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Val Loss: 1.120248, Cosine Sim: 0.3901, MSE: 1.1202
Learning Rate: 3.13e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_80.pt

Epoch 81/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.47s/it]Training:   3%|▎         | 1/30 [00:05<02:38,  5.46s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:16,  2.72s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.71s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  10%|█         | 3/30 [00:06<00:48,  1.81s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.38s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  20%|██        | 6/30 [00:09<00:25,  1.04s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.15it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.21it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.30it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.31it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.27it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  73%|███████▎  | 22/30 [00:21<00:06,  1.28it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.27it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.32it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.31it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.36it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.36it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.36it/s]Training:  90%|█████████ | 27/30 [00:25<00:02,  1.36it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:27<00:00,  1.34it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 8.081300

  Batch 0: Grad norm before clip = 8.081300
  Batch 0: Grad norm before clip = 8.081300
Train Loss: 0.870350, Cosine Sim: 0.4822
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 8.081300
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.84s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.86s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.06s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.21it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Val Loss: 1.120975, Cosine Sim: 0.3897, MSE: 1.1210
Learning Rate: 3.13e-06

Epoch 82/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.77s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.75s/it]Training:   3%|▎         | 1/30 [00:05<02:47,  5.76s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.86s/it]Training:   7%|▋         | 2/30 [00:06<01:20,  2.86s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.86s/it]Training:   7%|▋         | 2/30 [00:06<01:19,  2.85s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.90s/it]Training:  10%|█         | 3/30 [00:07<00:51,  1.91s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.48s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  13%|█▎        | 4/30 [00:08<00:38,  1.47s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  17%|█▋        | 5/30 [00:09<00:32,  1.29s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  23%|██▎       | 7/30 [00:10<00:23,  1.02s/it]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.11it/s]Training:  27%|██▋       | 8/30 [00:11<00:19,  1.10it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  33%|███▎      | 10/30 [00:13<00:17,  1.13it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  37%|███▋      | 11/30 [00:13<00:16,  1.17it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  43%|████▎     | 13/30 [00:15<00:14,  1.17it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  47%|████▋     | 14/30 [00:16<00:13,  1.18it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  50%|█████     | 15/30 [00:17<00:12,  1.23it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  53%|█████▎    | 16/30 [00:18<00:11,  1.22it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:20<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:07,  1.25it/s]Training:  67%|██████▋   | 20/30 [00:21<00:08,  1.25it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  70%|███████   | 21/30 [00:22<00:07,  1.20it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.31it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.23it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.21it/s]Training:  83%|████████▎ | 25/30 [00:25<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.24it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.28it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training:  97%|█████████▋| 29/30 [00:28<00:00,  1.23it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.20it/s]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
  Batch 0: Grad norm before clip = 2.767701

Training: 100%|██████████| 30/30 [00:30<00:00,  1.01s/it]
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.767701
  Batch 0: Grad norm before clip = 2.767701
Train Loss: 0.858450, Cosine Sim: 0.4568
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.767701
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.89s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.92s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.91s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:04<00:01,  1.32s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.08s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.35s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.20it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Val Loss: 1.121106, Cosine Sim: 0.3895, MSE: 1.1211
Learning Rate: 3.13e-06

Epoch 83/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:46,  5.73s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.73s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.73s/it]Training:   3%|▎         | 1/30 [00:05<02:46,  5.74s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:   7%|▋         | 2/30 [00:06<01:18,  2.81s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.88s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  13%|█▎        | 4/30 [00:08<00:37,  1.44s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.19s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  17%|█▋        | 5/30 [00:08<00:29,  1.20s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  20%|██        | 6/30 [00:09<00:24,  1.03s/it]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  23%|██▎       | 7/30 [00:10<00:21,  1.06it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.15it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.09it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.23it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:14,  1.22it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.25it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.28it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  50%|█████     | 15/30 [00:16<00:12,  1.18it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.17it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.18it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  60%|██████    | 18/30 [00:19<00:09,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.32it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.18it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.21it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  77%|███████▋  | 23/30 [00:23<00:05,  1.21it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  80%|████████  | 24/30 [00:24<00:04,  1.26it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.28it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.32it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  93%|█████████▎| 28/30 [00:27<00:01,  1.29it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.33it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 5.708580
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]

Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.708580
  Batch 0: Grad norm before clip = 5.708580
Train Loss: 0.803094, Cosine Sim: 0.5002
  Batch 0: Grad norm before clip = 5.708580
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.96s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.94s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.93s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.33s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.10s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.36s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.19s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.58s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.120822, Cosine Sim: 0.3906, MSE: 1.1208
Learning Rate: 3.13e-06

Epoch 84/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.56s/it]Training:   3%|▎         | 1/30 [00:05<02:41,  5.58s/it]Training:   3%|▎         | 1/30 [00:05<02:42,  5.59s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.68s/it]Training:   7%|▋         | 2/30 [00:06<01:14,  2.68s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  10%|█         | 3/30 [00:06<00:47,  1.77s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  13%|█▎        | 4/30 [00:07<00:35,  1.36s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  17%|█▋        | 5/30 [00:08<00:28,  1.13s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.08s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.04it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  27%|██▋       | 8/30 [00:10<00:19,  1.14it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  30%|███       | 9/30 [00:11<00:18,  1.16it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.20it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  33%|███▎      | 10/30 [00:12<00:16,  1.19it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  37%|███▋      | 11/30 [00:13<00:17,  1.10it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.18it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.17it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  43%|████▎     | 13/30 [00:14<00:14,  1.20it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.29it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.27it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.26it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  53%|█████▎    | 16/30 [00:17<00:11,  1.21it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  57%|█████▋    | 17/30 [00:18<00:10,  1.20it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.22it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  63%|██████▎   | 19/30 [00:19<00:08,  1.23it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.20it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.24it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.25it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.31it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  83%|████████▎ | 25/30 [00:24<00:04,  1.20it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.21it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.22it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.31it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.37it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.27it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.02it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]
  Batch 0: Grad norm before clip = 5.231762
Training: 100%|██████████| 30/30 [00:29<00:00,  1.01it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 5.231762
Train Loss: 0.816470, Cosine Sim: 0.4880
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.231762
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 5.231762
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.80s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.82s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.04s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.05s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.15s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.16s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating: 100%|██████████| 4/4 [00:05<00:00,  1.22it/s]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.54s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.55s/it]
Training:   0%|          | 0/30 [00:00<?, ?it/s]Val Loss: 1.122497, Cosine Sim: 0.3895, MSE: 1.1225
Learning Rate: 3.13e-06

Epoch 85/300
------------------------------------------------------------
Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]Training:   0%|          | 0/30 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Training:   3%|▎         | 1/30 [00:05<02:37,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.41s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.42s/it]Training:   3%|▎         | 1/30 [00:05<02:37,  5.41s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.70s/it]Training:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it]Training:  10%|█         | 3/30 [00:07<00:50,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  10%|█         | 3/30 [00:07<00:49,  1.85s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  13%|█▎        | 4/30 [00:07<00:37,  1.45s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  17%|█▋        | 5/30 [00:08<00:30,  1.22s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  20%|██        | 6/30 [00:09<00:26,  1.09s/it]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  23%|██▎       | 7/30 [00:10<00:22,  1.03it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  27%|██▋       | 8/30 [00:11<00:20,  1.07it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  30%|███       | 9/30 [00:12<00:19,  1.06it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  33%|███▎      | 10/30 [00:12<00:17,  1.12it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  37%|███▋      | 11/30 [00:13<00:15,  1.22it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  40%|████      | 12/30 [00:14<00:15,  1.19it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  43%|████▎     | 13/30 [00:15<00:13,  1.23it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  47%|████▋     | 14/30 [00:15<00:12,  1.32it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.34it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.34it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  50%|█████     | 15/30 [00:16<00:11,  1.33it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.34it/s]Training:  53%|█████▎    | 16/30 [00:17<00:10,  1.34it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.36it/s]Training:  57%|█████▋    | 17/30 [00:17<00:09,  1.36it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  60%|██████    | 18/30 [00:18<00:09,  1.32it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  63%|██████▎   | 19/30 [00:19<00:07,  1.38it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  67%|██████▋   | 20/30 [00:20<00:08,  1.22it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  70%|███████   | 21/30 [00:21<00:07,  1.19it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  73%|███████▎  | 22/30 [00:22<00:06,  1.27it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  77%|███████▋  | 23/30 [00:22<00:05,  1.29it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  80%|████████  | 24/30 [00:23<00:04,  1.24it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  83%|████████▎ | 25/30 [00:24<00:03,  1.25it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  87%|████████▋ | 26/30 [00:25<00:03,  1.22it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  90%|█████████ | 27/30 [00:26<00:02,  1.27it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  93%|█████████▎| 28/30 [00:26<00:01,  1.34it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training:  97%|█████████▋| 29/30 [00:27<00:00,  1.36it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:28<00:00,  1.32it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]
  Batch 0: Grad norm before clip = 2.779866

Training: 100%|██████████| 30/30 [00:29<00:00,  1.03it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]
  Batch 0: Grad norm before clip = 2.779866
  Batch 0: Grad norm before clip = 2.779866
Train Loss: 0.863392, Cosine Sim: 0.4806
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]  Batch 0: Grad norm before clip = 2.779866
Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]Evaluating:   0%|          | 0/4 [00:00<?, ?it/s]/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/models/e3_gnn_encoder_v2.py:41: UserWarning: Improved layers not found. Using basic implementation. Install missing dependencies or check layers/ directory.
  warnings.warn(
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
/personal/RNA-3E-FFI/scripts/04_train_model.py:187: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  data.y = torch.tensor(ligand_embedding, dtype=torch.float32)
Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.87s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.88s/it]Evaluating:  25%|██▌       | 1/4 [00:04<00:14,  4.90s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.07s/it]Evaluating:  50%|█████     | 2/4 [00:04<00:04,  2.08s/it]Evaluating:  50%|█████     | 2/4 [00:05<00:04,  2.09s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.17s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.34s/it]Evaluating:  75%|███████▌  | 3/4 [00:05<00:01,  1.18s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.57s/it]
Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]Evaluating: 100%|██████████| 4/4 [00:06<00:00,  1.56s/it]

Val Loss: 1.124823, Cosine Sim: 0.3880, MSE: 1.1248
Learning Rate: 1.56e-06
Saved checkpoint to models/physics_v3_6_0.1/checkpoint_epoch_85.pt

Early stopping triggered after 85 epochs

Training complete!
Best validation cosine loss: 1.055465
Best validation cosine similarity: 0.4371
Best model saved to models/physics_v3_6_0.1/best_model.pt

Final learnable weights:
  Angle weight: 0.3271 (initial: 0.333)
  Dihedral weight: 0.3257 (initial: 0.333)
  Nonbonded weight: 0.3191 (initial: 0.333)
[rank1]:[E1109 20:09:58.215418277 ProcessGroupNCCL.cpp:616] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600009 milliseconds before timing out.
[rank1]:[E1109 20:09:58.215670873 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 1] Exception (either an error or timeout) detected by watchdog at work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank1]:[E1109 20:09:58.215686747 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 1] Timeout at NCCL work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank1]:[E1109 20:09:58.215694249 ProcessGroupNCCL.cpp:630] [Rank 1] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank1]:[E1109 20:09:58.215704459 ProcessGroupNCCL.cpp:636] [Rank 1] To avoid data inconsistency, we are taking the entire process down.
[rank1]:[E1109 20:09:58.217920987 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600009 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6a6a36c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6a1f800a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6a1f807ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6a1f80993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6a6a84e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6c10e94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6c10f26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 1] Process group watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600009 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6a6a36c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f6a1f800a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f6a1f807ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f6a1f80993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f6a6a84e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f6c10e94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f6c10f26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f6a6a36c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7f6a1f47eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7f6a6a84e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7f6c10e94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7f6c10f26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E1109 20:09:58.287132345 ProcessGroupNCCL.cpp:616] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600028 milliseconds before timing out.
[rank2]:[E1109 20:09:58.287370924 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 2] Exception (either an error or timeout) detected by watchdog at work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank2]:[E1109 20:09:58.298290528 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 2] Timeout at NCCL work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank2]:[E1109 20:09:58.298301640 ProcessGroupNCCL.cpp:630] [Rank 2] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E1109 20:09:58.298308448 ProcessGroupNCCL.cpp:636] [Rank 2] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E1109 20:09:58.299209174 ProcessGroupNCCL.cpp:616] [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600063 milliseconds before timing out.
[rank2]:[E1109 20:09:58.299886149 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600028 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f509c0b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f5051600a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f5051607ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f505160993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f509c5005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f5242a94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f5242b26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
[rank3]:[E1109 20:09:58.309578972 ProcessGroupNCCL.cpp:1785] [PG ID 0 PG GUID 0(default_pg) Rank 3] Exception (either an error or timeout) detected by watchdog at work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank3]:[E1109 20:09:58.320258124 ProcessGroupNCCL.cpp:1834] [PG ID 0 PG GUID 0(default_pg) Rank 3] Timeout at NCCL work: 7741, last enqueued NCCL work: 7741, last completed NCCL work: 7740.
[rank3]:[E1109 20:09:58.320273184 ProcessGroupNCCL.cpp:630] [Rank 3] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 2] Process group watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600028 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f509c0b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f5051600a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f5051607ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f505160993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f509c5005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f5242a94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f5242b26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f509c0b9446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7f505127eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7f509c5005c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7f5242a94ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7f5242b26a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[E1109 20:09:58.331181038 ProcessGroupNCCL.cpp:636] [Rank 3] To avoid data inconsistency, we are taking the entire process down.
[rank3]:[E1109 20:09:58.332828509 ProcessGroupNCCL.cpp:1595] [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600063 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f1a9d56c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f1a52a00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f1a52a07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f1a52a0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f1a9da4e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f1c44094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f1c44126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [PG ID 0 PG GUID 0(default_pg) Rank 3] Process group watchdog thread terminated with exception: [Rank 3] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=7741, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600063 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:618 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f1a9d56c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x282 (0x7f1a52a00a92 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::watchdogHandler() + 0x233 (0x7f1a52a07ed3 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x7f1a52a0993d in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0x145c0 (0x7f1a9da4e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x94ac3 (0x7f1c44094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #6: <unknown function> + 0x126a40 (0x7f1c44126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1601 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f1a9d56c446 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xe7eb1b (0x7f1a5267eb1b in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0x145c0 (0x7f1a9da4e5c0 in /opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x94ac3 (0x7f1c44094ac3 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #4: <unknown function> + 0x126a40 (0x7f1c44126a40 in /usr/lib/x86_64-linux-gnu/libc.so.6)

W1109 20:09:58.219000 417486 site-packages/torch/multiprocessing/spawn.py:160] Terminating process 417595 via signal SIGTERM
W1109 20:09:58.229000 417486 site-packages/torch/multiprocessing/spawn.py:160] Terminating process 417596 via signal SIGTERM
Traceback (most recent call last):
  File "/personal/RNA-3E-FFI/scripts/04_train_model.py", line 1354, in <module>
    main()
  File "/personal/RNA-3E-FFI/scripts/04_train_model.py", line 1341, in main
    mp.spawn(
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 328, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 284, in start_processes
    while not context.join():
              ^^^^^^^^^^^^^^
  File "/opt/mamba/envs/RNA/lib/python3.11/site-packages/torch/multiprocessing/spawn.py", line 184, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 1 terminated with signal SIGABRT
/opt/mamba/envs/RNA/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 3 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '

Training completed!
